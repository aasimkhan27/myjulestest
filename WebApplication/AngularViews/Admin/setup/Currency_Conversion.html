

<form id="CurrencyConversionFormUpload" name="CurrencyConversionFormUpload" novalidate>
    <div class="card-header">
        <div class="row">
            <div class="col-md-2">
                <div class="form-group">
                    <label>BASE CURRENCY CODE:*</label>
                    <input type="text"
                           class="form-control"
                           maxlength="250"
                           name="BASE_CURRENCY_CODE"
                           ng-model=" CCSearch.BASE_CURRENCY_CODE" ng-disabled="true"
                           ng-class="{'error':CurrencyConversionFormUpload.submitted && CurrencyConversionFormUpload.BASE_CURRENCY_CODE.$error.required}" />
                </div>
            </div>
            <div class="col-md-3">
                <div class="form-group">
                    <label>Entity:</label>
                    <select class="custom-select"
                            name="ENTITY_ID_UPLOAD"
                             
                            ng-model="CCSearch.ENTITY_ID_UPLOAD"
                            ng-options="EL.ENTITY_ID as EL.ENTITY_NAME for EL in ENTITY_LIST"
                            ng-class="{'error':CurrencyConversionFormUpload.submitted && CurrencyConversionFormUpload.ENTITY_ID_UPLOAD.$error.required}">
                        <option value="">- Please Select Entity-</option>
                    </select>
                </div>
            </div>
            <div class="col-md-3">
                <div class="form-group">
                    <label>Upload File:*</label>
                    <div class="input-group d-flex">
                        <input class="form-control text-xs" type="file"
                               ng-class="{'error':CurrencyConversionFormUpload.submitted && CCSearch.UploadedFiles==null  || CurrencyConversionFormUpload.submitted && CCSearch.UploadedFiles.length==0,'':CCSearch.UploadedFiles.length>0}"
                               ng-model="CCSearch.UploadedFiles"
                               id="uploadExcel1" ng-files="getTheFilesToUploadall($files,5,CCSearch,1, 'uploadExcel','CURRENCY_CONVERSION')"
                               ng-click="RESET_BUTTON_SETUP();"
                               name="file" />
                    </div>
                </div>
            </div>

            <div class="col-md-4">
                <div class="form-group">
                    <label class="d-block">&nbsp;</label>
                    <button type="button" value="Validate"
                            ng-click="EXCEL_CURRENCY_ADD()"
                            class="btn btn-wenodo">
                        Validate
                    </button>

                    <button type="button" value="Upload"
                            ng-disabled="CC_INVALID_EXCLE_CELL_FLAG"
                            ng-click="INS_UPD_CURRENCY_CONVERSION_RATES();"
                            class="btn btn-wenodo">
                        Upload
                    </button>
                    <!--<button class="btn btn-w-default" type="button" data-toggle="modal" data-target="#View_Report" ng-if="CC_INVALID_EXCLE_CELL_COUNT !=null && CC_INVALID_EXCLE_CELL_COUNT==0 && CURRENCY_CONVERSION.length>0">
                <i class="far fa-eye"></i> View
            </button>-->
                    <!--<button class="btn btn-danger" ng-if="CC_INVALID_EXCLE_CELL_COUNT>0" data-toggle="modal" data-target="#View_Report">
                <i class="far fa-exclamation-triangle"></i> Validation Failed
            </button>-->
                    <button ng-click="RESET()" class="btn btn-w-default">Reset</button>
                    <button ng-click="DOWNLOAD_OPENXML_UPLOAD()" class="btn btn-transparent text-blue"><i class="far fa-download"></i></button>
                </div>
            </div>
        </div>

    </div>
</form>

<div class="card-body">
    <div class="text-center" ng-show="CURRENCY_CONVERSION.length==0" empty-grid>
    </div>
    <div class="table-responsive custom-scrollbar height-auto" ng-show="CURRENCY_CONVERSION.length>0">
        <div class="col-md-12">
            <div class="notice d-flex " ng-repeat="CD in CC_CODE_ARRY | unique:'CODE' ">
                <span class="help-block errormessageline" style="padding-left:0px;" ng-if="CD.CODE=='CODE0003'"><i class="fa fa-exclamation-triangle text-danger"></i> {{CD.CODE}} {{CD.POSITION}} - Invalid Hyperlink: Malformed URI is embedded as a hyperlink in the document.please remove hyperlink.</span>
                <span class="help-block errormessageline" style="padding-left:0px;" ng-if="CD.CODE=='BLANK'">
                    <i class="fa fa-exclamation-triangle text-danger"></i> {{CD.CODE}}-Please provide the mandatory details.
                    <span ng-repeat="BLN in CC_CODE_ARRY | filter:{CODE:CD.CODE} "> [ {{$index+1}}:- {{BLN.POSITION}} ]</span>
                </span>
                <span class="help-block errormessageline" style="padding-left:0px;" ng-if="CD.CODE=='GBP0019'">
                    <i class="fa fa-exclamation-triangle text-danger"></i> {{CD.CODE}} -Please set base currency code only GBP.
                    <span ng-repeat="BOL in CC_CODE_ARRY | filter:{CODE:CD.CODE} ">[ {{$index+1}}:- {{BOL.POSITION}} ]</span>
                </span>
                <!--<span class="help-block errormessageline" style="padding-left:0px;" ng-if="CD.CODE=='EMAIL0009'">
                    <i class="fa fa-exclamation-triangle text-danger"></i> {{CD.CODE}} - Invalid Email.
                    <span ng-repeat="EM in CC_CODE_ARRY | filter:{CODE:CD.CODE} "><br />{{$index+1}}:- {{EM.POSITION}} </span>
                </span>
                <span class="help-block errormessageline" style="padding-left:0px;" ng-if="CD.CODE=='NUM0010'">
                    <i class="fa fa-exclamation-triangle text-danger"></i> {{CD.CODE}}  - Number Only.
                    <span ng-repeat="NUMO in CC_CODE_ARRY | filter:{CODE:CD.CODE} "><br />{{$index+1}}:- {{NUMO.POSITION}} </span>
                </span>-->
                <span class="help-block errormessageline" style="padding-left:0px;" ng-if="CD.CODE=='NUM0011'">
                    <i class="fa fa-exclamation-triangle text-danger"></i> {{CD.CODE}} - Number/Digit Only.
                    <span ng-repeat="NUM in CC_CODE_ARRY | filter:{CODE:CD.CODE} ">[ {{$index+1}}:- {{NUM.POSITION}} ]</span>
                </span>
                <!--<span class="help-block errormessageline" style="padding-left:0px;" ng-if="CD.CODE=='NUM0012'">
                    <i class="fa fa-exclamation-triangle text-danger"></i> {{CD.CODE}} - Negative value should not allow.
                    <span ng-repeat="NTC in CC_CODE_ARRY | filter:{CODE:CD.CODE} "><br />{{$index+1}}:- {{NTC.POSITION}} </span>
                </span>
                <span class="help-block errormessageline" style="padding-left:0px;" ng-if="CD.CODE=='DDL0004'">
                    <i class="fa fa-exclamation-triangle text-danger"></i> {{CD.CODE}}  {{CD.POSITION}} - Invalid spelling or either wrong input.
                    <span ng-show="CD.Suggestion.slice(2).length>0">Please select one of the suggested values </span>
                    <span ng-repeat="a in CC_CODE_ARRY | unique:'D_COLUMN_NAME'"><br /> {{a.Suggestion.slice(2)}} </span>
                </span>-->
                <span class="help-block errormessageline" style="padding-left:0px;" ng-if="CD.CODE=='DATE0007'">
                    <i class="fa fa-exclamation-triangle text-danger"></i> {{CD.CODE}}- Please provide 'DD/MM/YYYY' format.
                    <span ng-repeat="DAT in CC_CODE_ARRY | filter:{CODE:CD.CODE} ">[ {{$index+1}}:- {{DAT.POSITION}} ]</span>
                </span>
            </div>
            <span class="help-block errormessageline" style="padding-left:0px;" ng-if="DUPLICATES.length>0">
                <i class="fa fa-exclamation-triangle text-danger"></i> -Duplicate record found to excel.
            </span>
        </div>
        <div class="table-responsive custom-scrollbar height-400" ng-show="CURRENCY_CONVERSION.length>0">
            <table class="table table-striped table-head-fixed">
                <thead class="bg-wenodo-dark-blue">
                    <tr>
                        <th>S.No</th>
                        <th>BASE CURRENCY CODE</th>
                        <th>CONVERT TO CURRENCY CODE</th>
                        <th>RATE</th>
                        <th>EFFECTIVE DATE</th>
                    </tr>
                </thead>
                <tbody ng-repeat="DSL in CURRENCY_CONVERSION" on-finish-render="ngRepeatFinished" ng-init="NGINIT_CURRENCY_CONVERSION(DSL)">
                    <tr>
                        <td width="2%">{{$index+1}}</td>
                        <td class="text-nowrap" ng-class="{'error':DSL.BASE_CURRENCY_CODE.split(':;:').length>1}">
                            <span ng-show="DSL.BASE_CURRENCY_CODE.split(':;:')[0]=='BLANK'"><i class="fa fa-exclamation-triangle"></i></span><span ng-show="DSL.BASE_CURRENCY_CODE.split(':;:')[0]!='BLANK'"> {{DSL.BASE_CURRENCY_CODE }} </span>
                        </td>
                        <td class="text-nowrap" ng-class="{'error':DSL.CONVERT_TO_CURRENCY_CODE.split(':;:').length>1}">
                            <span ng-show="DSL.CONVERT_TO_CURRENCY_CODE.split(':;:')[0]=='BLANK'"><i class="fa fa-exclamation-triangle"></i></span><span ng-show="DSL.CONVERT_TO_CURRENCY_CODE.split(':;:')[0]!='BLANK'"> {{(DSL.CONVERT_TO_CURRENCY_CODE)}} </span>
                        </td>
                        <td class="text-nowrap" ng-class="{'error':DSL.RATE.split(':;:').length>1}">
                            <span ng-show="DSL.RATE.split(':;:')[0]=='BLANK'"><i class="fa fa-exclamation-triangle"></i></span><span ng-show="DSL.RATE.split(':;:')[0]!='BLANK'"> {{(DSL.RATE  )}} </span>
                        </td>
                        <td class="text-nowrap" ng-class="{'error':DSL.EFFECTIVE_DATE.split(':;:').length>1}">
                            <span ng-show="DSL.EFFECTIVE_DATE.split(':;:')[0]=='BLANK'"><i class="fa fa-exclamation-triangle"></i></span><span ng-show="DSL.EFFECTIVE_DATE.split(':;:')[0]!='BLANK'"> {{(DSL.EFFECTIVE_DATE | date)}} </span>
                        </td>
                    </tr>
                </tbody>
            </table>

        </div>
    </div>
</div>
