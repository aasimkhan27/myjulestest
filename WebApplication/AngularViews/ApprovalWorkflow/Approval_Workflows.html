<style>
   .select2-container--default .select2-selection--multiple .select2-selection__choice {
        margin: 2px;
    /* overflow: hidden; */
    text-overflow: ellipsis;
    font-size: 10px;
    margin-top: 6px;
        padding: 2px 15px 0px 5px !important;
    }
    .select2-container--default .select2-selection--multiple .select2-selection__choice__remove {
        font-size: 12px;
    }

     .dndDragover {
        padding:0px !important;
    }
    /**
 * For the correct positioning of the placeholder element, the dnd-list and
 * it's children must have position: relative
 */
.typesDemo ul[dnd-list],
.typesDemo ul[dnd-list] > li {
  position: relative;
}

/**
 * The dnd-list should always have a min-height,
 * otherwise you can't drop to it once it's empty
 */
.typesDemo ul[dnd-list] {
  min-height: 42px;
  padding-left: 0px;
}

/**
 * The dndDraggingSource class will be applied to
 * the source element of a drag operation. It makes
 * sense to hide it to give the user the feeling
 * that he's actually moving it.
 */
.typesDemo ul[dnd-list] .dndDraggingSource {
  display: none;
}

/**
 * An element with .dndPlaceholder class will be
 * added to the dnd-list while the user is dragging
 * over it.
 */
.typesDemo ul[dnd-list] .dndPlaceholder {
  display: block;
  background-color: #ddd;
  padding: 10px 15px;
  min-height: 42px;
}

/**
 * The dnd-lists's child elements currently MUST have
 * position: relative. Otherwise we can not determine
 * whether the mouse pointer is in the upper or lower
 * half of the element we are dragging over. In other
 * browsers we can use event.offsetY for this.
 */
.typesDemo ul[dnd-list] li {
  background-color: #fff;
  border-bottom: 1px solid #9FBBBD;
  /*border-top-right-radius: 4px;
  border-top-left-radius: 4px;
  display: block;
  margin-bottom: -1px;*/

  /* Disable text selection if item is not draggable */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.typesDemo ul[dnd-list] li dnd-nodrag {
  display: block;
  padding: 10px 5px;
}

/**
 * Gender-specifc background
 */
.typesDemo ul[dnd-list] li.background-man {
  background-color: #fff;
}

.typesDemo .handle {
  cursor: move;
  position: absolute;
  top: 14px;
}

.typesDemo .name {
  margin-left: 20px;
}

</style>
<div class="custom-scrollbar height-82vh mt-3">
    <div class="d-flex ml-2">    
                      
        <div class="col-md-3" ng-repeat-start="GROUP in APPROVAL_WORKFLOW.GROUPS | filter: {REMOVE_FLAG:0}" >
            <div class="approval-header p-0 m-0">
                <div class="hidden-input-container d-inline">
                    <div class="row">
                        <div class="col-auto px-0 bcg-white">
                            <button data-toggle="dropdown" class="btn btn-transparent text-xs border" style="height: 40px; border-radius: 5px 0px 0px 5px;"> {{GROUP.HIGHER_LOWER_FLAG==null?GROUP.HIGHER_LOWER_FLAG='Select':GROUP.HIGHER_LOWER_FLAG}} <i class="fas fa-chevron-down fa-xs ml-2"></i></button>
                            <ul class="dropdown-menu" x-placement="bottom-end">
                                <li><a class="dropdown-item text-xs" ng-click="GROUP.HIGHER_LOWER_FLAG='Upto'"><i class="fal fa-check text-green" ng-if="GROUP.HIGHER_LOWER_FLAG=='Upto'"></i> Upto</a></li>
                                <li><a class="dropdown-item text-xs" ng-click="GROUP.HIGHER_LOWER_FLAG='More than'"><i class="fal fa-check text-green" ng-if="GROUP.HIGHER_LOWER_FLAG=='More than'"></i> More than</a></li>
                            </ul>
                        </div>
                        <div class="col" ng-class="{'mr-1':APPROVAL_WORKFLOW.GROUPS.length==1}">
                            <input class="transparent-input transparent-input-white text-white mt-2 w-100" maxlength="15" type="text" autocomplete="off" only-numbers placeholder="Enter Approval Limit" ng-model="GROUP.AMOUNT">
                        </div>

                        <div class="col-auto" ng-show="APPROVAL_WORKFLOW.GROUPS.length>1">
                            <a class="float-right text-white mr-2" style="margin-top:12px;"  ng-click="RemoveGroup($index, GROUP)"><i class="fal fa-times-circle"></i></a>
                        </div>
                    </div>
                    
                    <!--<select class="float-left transparent-input transparent-input-white text-white w-50"><option>Less than or equal to </option><option>Greater than or equal to</option></select>-->
                    
                </div>
                
            </div>
            <div class="col-md-12 mt-2 mt-3">
            
                <div class="row">
                    <div class="col-md-8">
                        <button type="button" class="btn btn-default-outline btn-sm" data-toggle="dropdown"><i class="fal fa-user-plus"></i> Add Approver</button>
                        <div class="dropdown-menu DontHideOnClick p-2">
                            <div class="col-md-12">
                                Add User
                                <small class="d-block">Please type in the email of the user that you would like to add</small>
                                <span class="d-block">
                                    <select class="form-control"
                                            style="width: 100%;"
                                            ng-options="UL as UL.USER_NAME for UL in UserList"
                                            ng-model="GROUP.SELECTED_USER"
                                            required></select></span>
                            </div>
                            <div class="col-md-12 mt-3"><button type="button" ng-click="AddApprover(GROUP)" class="btn btn-default-outline btn-sm" data-toggle="dropdown">Add User</button></div>                            
                        </div>
                    </div>

                    <div class="col-auto ml-auto">
                        <button type="button" class="btn btn-transparent p-0 float-right" data-toggle="dropdown"><i class="fal fa-alarm-clock fa-lg text-grey" data-toggle="tooltip" data-html="true" title="Set a decision deadline for approvers"></i></button>
                        <ul class="dropdown-menu dropdown-menu-right DontHideOnClick">
                            <li>
                                <div class="qty">
                                    <label>Days</label>
                                    <span class="minus bg-grey">-</span>
                                    <input type="number" class="count" name="qty" value="0">
                                    <span class="spinner-plus bg-grey">+</span>
                                </div>
                            </li>
                            <li>
                                <div class="qty">
                                    <label>Hours</label>
                                    <span class="minus bg-grey">-</span>
                                    <input type="number" class="count" name="qty" value="0">
                                    <span class="spinner-plus bg-grey">+</span>
                                </div>
                            </li>
                        </ul>
                        <button type="button" class="btn btn-transparent p-0 float-right mr-2" ng-click="ApproverSettings(GROUP)"><i class="fal fa-th fa-lg text-grey" data-toggle="tooltip" data-html="true" title="Define approval conditions for approvers"></i></button>
                    </div>
                </div>
            </div>
            <div class="col-md-12 py-3">
                Approval condition
                <div class="float-right">
                    <button type="button" class="btn btn-transparent p-0" data-toggle="modal" data-target="#Approval_Condition" ng-click="SETGROUP(GROUP);">{{GROUP.APPROVAL_CONDITION==1?'Any':'All'}}</button>
                </div>
            </div>          
            <div class="col-md-12 typesDemo px-0">
                <ul dnd-list="GROUP.GROUP_USERS">
                    <!-- The dnd-draggable directive makes an element draggable and will
            transfer the object that was assigned to it. If an element was
            dragged away, you have to remove it from the original list
            yourself using the dnd-moved attribute -->
                    <li ng-repeat="GRPUSER in GROUP.GROUP_USERS"
                        dnd-draggable="GRPUSER"
                        dnd-moved="GROUP.GROUP_USERS.splice($index, 1)"
                        dnd-effect-allowed="move"
                        dnd-selected="models.selected = GRPUSER"
                        class="background-man">
                        <dnd-nodrag>
                            <div dnd-handle class="handle">:::</div>
                            <label class="name ml-5 mt-1">
                                {{GRPUSER.USER.USER_NAME}}
                                <small class="d-block">{{GRPUSER.USER.EMAIL}}</small>
                            </label>
                            <span class="float-right" ng-click="RemoveApprover($index, GROUP, GRPUSER)"><i class="fal fa-times-circle text-danger cursor-pointer"></i></span>
                        </dnd-nodrag>
                    </li>
                    <li class="dndPlaceholder">
                        Drop here
                    </li>
                </ul>
            </div>
            <div class="col-md-12" ng-if="false" ng-repeat-start="GRPUSER in GROUP.GROUP_USERS | filter:{ACTIVE:1}" ng-show="GRPUSER.USER.ALTERNATIVE_RULE==0">
                <div class="row">
                    <div class="col-auto"><span class="supplier-short-name"><i class="fal fa-user"></i></span></div>
                    <div class="col-auto">
                        <div class="username semibold m-0">
                            {{GRPUSER.USER.USER_NAME}}
                            <small class="d-block">{{GRPUSER.USER.EMAIL}}</small>
                            <a class="d-block" data-toggle="modal" ng-if="false" data-target="#Invite_User">Invite</a>
                        </div>
                    </div>
                    <div class="col-auto ml-auto" ng-click="RemoveApprover($index, GROUP, GRPUSER)"><i class="fal fa-times-circle text-danger cursor-pointer"></i></div>
                </div>
              
            </div>
            <div class="border-bottom" ng-if="false"  ng-repeat-end ng-show="GRPUSER.USER.ALTERNATIVE_RULE==0"></div>  
                 
        </div>

        <div class="col-auto" ng-repeat-end><i class="fal fa-chevron-right mt-3 text-green"></i></div>


        <div class="col-auto"><button type="button" class="btn btn-default mt-1" data-toggle="tooltip" data-html="true" data-title="Add Amount" ng-click="AddGroup()"><i class="fal fa-plus text-green"></i></button></div>

    </div>
</div>
<div class="event-footer animated fadeInUp pl-0 ng-scope">
    <div class="col-md-12">
        <div class="row">
            <div class="col-md-12 m-2 text-right">
                <button type="button" class="btn btn-prex" ng-click="INS_UPD_APP_CHAIN()"><i class="fal fa-plus"></i> Submit</button>
                <a href="#!/WFS" class="btn btn-default-outline" title="Back"><i class="fal fa-arrow-left"></i> Back</a>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="Approval_Popup">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Approval</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body custom-scrollbar height-400">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>                                
                                <th>Approvers</th>                               
                                <th width="15%">Requestor</th>                                
                                <th width="15%">Cost Center</th>
                                <th width="15%">Commodity</th>
                                <th width="15%">GL</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="GUser in GroupUsers">                             
                                <td>
                                    <div class="row">
                                        <div class="col-auto">
                                            <div class="username m-0">
                                               {{GUser.USER.USER_NAME}}
                                                <small class="d-block">{{GUser.USER.EMAIL}}</small>
                                            </div>
                                        </div>
                                        <div class="col-auto ml-auto">
                                            <button type="button" class="btn btn-transparent p-0" data-toggle="dropdown"><i class="fal fa-ellipsis-v fa-lg mt-2"></i></button>
                                            <ul class="dropdown-menu dropdown-menu-right">
                                                <li><a class="dropdown-item" ng-click="AddAlternativeRule(GUser, GroupUsers, $index)">Add an alternative rule</a></li>
                                                <li><a class="dropdown-item">Remove approver from the step</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </td>                              
                                <td>
                                    <select class="filter-dropdown" ng-model="GUser.USER_SETTING.REQUESTOR_FLAG">
                                        <option value="1" selected="selected">Any</option>
                                        <option value="2">Requestor Matches</option>
                                        <option value="3">Requestor does not match</option>
                                    </select>
                                    <span ng-show="GUser.USER_SETTING.REQUESTOR_FLAG!='1'">
                                        <select class="form-control w-100 text-nowrap REQs" multiple="multiple"
                                                data-placeholder="Select Requestor" name="REQs"
                                                ng-options="CT as CT.USER_NAME for CT in RequestorList"
                                                ng-model="GUser.USER_SETTING.REQUESTORS"></select>
                                    </span>
                                </td>                              
                                <td>
                                    <select class="filter-dropdown" ng-model="GUser.USER_SETTING.COSTCENTER_FLAG">
                                        <option value="1" selected="selected">Any</option>
                                        <option value="2">Cost Center Matches</option>
                                        <option value="3">Cost Center does not match</option>
                                    </select>
                                    <span ng-show="GUser.USER_SETTING.COSTCENTER_FLAG!='1'">
                                        <select class="form-control w-100 text-nowrap REQs" multiple="multiple"
                                                data-placeholder="Select Cost Center" name="REQs"
                                                ng-options="CT as CT.CC_CODE+' - '+CT.COSTCENTER_DESC for CT in Cost_Center_PAR_List"
                                                ng-model="GUser.USER_SETTING.COSTCENTER"></select>
                                    </span>
                                </td>
                                <td>
                                    <select class="filter-dropdown" ng-model="GUser.USER_SETTING.CATEGORY_FLAG">
                                        <option value="1" selected="selected">Any</option>
                                        <option value="2">Commodity Matches</option>
                                        <option value="3">Commodity does not match</option>
                                    </select>
                                    <span ng-show="GUser.USER_SETTING.CATEGORY_FLAG!='1'">
                                        <select class="form-control w-100 text-nowrap REQs" multiple="multiple"
                                                data-placeholder="Select Commodity" name="REQs"
                                                ng-options="CT as CT.SUBCATEGORY_NAME for CT in SUB_CATEGORIES"
                                                ng-model="GUser.USER_SETTING.CATEGORY"></select>
                                    </span>
                                </td>
                                <td>
                                    <select class="filter-dropdown" ng-model="GUser.USER_SETTING.GL_FLAG">
                                        <option value="1" selected="selected">Any</option>
                                        <option value="2">GL Matches</option>
                                        <option value="3">GL does not match</option>
                                    </select>
                                    <span ng-show="GUser.USER_SETTING.GL_FLAG!='1'">
                                        <select class="form-control w-100 text-nowrap REQs" multiple="multiple"
                                                data-placeholder="Select Gl Account" name="REQs"
                                                ng-options="CT as CT.CODE+' - '+CT.DESCRIPTION for CT in GL_List"
                                                ng-model="GUser.USER_SETTING.GLACCOUNT"></select>
                                    </span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="col-md-12 mt-2 mt-3">
                    <button type="button" class="btn btn-default-outline btn-sm" data-toggle="dropdown" aria-expanded="false"><i class="fal fa-user-plus"></i> Add Approver</button>
                    <div class="dropdown-menu DontHideOnClick p-3" style="">
                        <div class="col-md-12">
                            Add User
                            <small class="d-block">Please type in the email of the user that you would like to add</small>
                            <span class="d-block"><input type="text" class="form-control" placeholder="user@email.com"></span>
                        </div>
                        <div class="col-md-12 mt-3"><button type="button" class="btn btn-default-outline btn-sm" data-toggle="dropdown">Add User</button></div>
                    </div>
                </div>

            </div>
            <div class="modal-footer text-right">
                <button type="button" class="btn btn-prex"><i class="fal fa-save"></i> Save</button>
                <button type="button" class="btn btn-default-outline" data-dismiss="modal"><i class="fal fa-times"></i> Close</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="Approval_Condition">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Approval Condition</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body custom-scrollbar height-400">
                <p>It can be selected whether all or only one of the assigned Approvers is required to approve the request to complete this Approval step.</p>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group border p-2">
                            <div class="custom-control custom-radio">
                                <input class="custom-control-input" type="radio" ng-model="SELECTEDGROUP.APPROVAL_CONDITION" id="All" name="customRadio" ng-value="0">
                                <label for="All" class="custom-control-label">All</label>
                            </div>
                            <small class="d-block">If this option is chosen, all assigned Approvers will have to approve the request in this step</small>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group border p-2">
                            <div class="custom-control custom-radio">
                                <input class="custom-control-input" type="radio" id="Anyof" ng-model="SELECTEDGROUP.APPROVAL_CONDITION" name="customRadio" ng-value="1">
                                <label for="Anyof" class="custom-control-label"><span class="d-flex">Any <input class="custom-form-control ml-2 w-30" style="height:20px;" maxlength="3" type="text" ng-if="SELECTEDGROUP.APPROVAL_CONDITION==1" ng-model="SELECTEDGROUP.APPROVAL_CONDITION_COUNT" /></span></label>
                            </div>
                            <small class="d-block">Please provide the count of Approvers minimum required to approve the request in this step</small>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer text-right">
                <button type="button" class="btn btn-prex" ng-click="CheckApprovalCondition()"><i class="fal fa-save"></i> Save</button>
                <button type="button" class="btn btn-default-outline" data-dismiss="modal"><i class="fal fa-times"></i> Close</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="Invite_User">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Invite Users</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body custom-scrollbar height-400">
                <p>The following users will be invited by email to join the Organisation.</p>
                <div class="table-responsive custom-scrollbar height-auto">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Email</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <div class="custom-control custom-checkbox">
                                        <input class="custom-control-input" type="checkbox" id="ID_One" value="option1">
                                        <label for="ID_One" class="custom-control-label">aasim@gmail.com</label>
                                    </div>
                                </td>
                                <td>Pending</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="custom-control custom-checkbox">
                                        <input class="custom-control-input" type="checkbox" id="ID_Two" value="option1">
                                        <label for="ID_Two" class="custom-control-label">nauman@gmail.com</label>
                                    </div>
                                </td>
                                <td>Not Invited</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer text-right">
                <button type="button" class="btn btn-prex"  data-dismiss="modal"><i class="fal fa-save"></i> Save</button>
                <button type="button" class="btn btn-default-outline" data-dismiss="modal"><i class="fal fa-times"></i> Close</button>
            </div>
        </div>
    </div>
</div>


<script type="text/javascript">
    $(document).ready(function () {
        $('.count').prop('disabled', true);
        $(document).on('click', '.spinner-plus', function () {
            $('.count').val(parseInt($('.count').val()) + 1);
        });
        $(document).on('click', '.minus', function () {
            $('.count').val(parseInt($('.count').val()) - 1);
            if ($('.count').val() == 0) {
                $('.count').val(1);
            }
        });
    });
</script>

