<div class="card-header">
    <h5 class="card-title">Upload Covers</h5>
    <div class="card-tools">
        <ul class="nav nav-pills ml-auto">
            <li class="nav-item"><a class="btn btn-wenodo text-white" ng-click="REDIRECTION_PAGE('Covers_View');">View Covers</a> &nbsp;</li>
            <li><label><a href="{{DOWNLOAD_FILE_PATH}}" id="btn" class="btn btn-w-default" download="" title="Download Template Excel file" target="_blank"><i class="fa fa-download"></i> Download Template </a></label></li>&nbsp;
            <!--<li class="nav-item"><a class="btn btn-wenodo text-white" ng-click="REDIRECTION_PAGE('Covers_Index');">Back</a></li>-->
        </ul>
    </div>
</div>
<div class="card-body">
    <form id="CoversForm" name="CoversForm" novalidate>
        <div class="row">
            <div class="col">
                <div class="form-group">
                    <label>Branch:*</label>
                    <select class="custom-select"
                            name="BRANCH_ID"
                            ng-required="true"
                            ng-model="CoversSearch.BRANCH_ID"
                            ng-options="CL.BRANCH_ID as CL.BRANCH_NAME for CL in BRANCH_LIST_VIEW"
                            ng-class="{'error':CoversForm.submitted && CoversForm.BRANCH_ID.$error.required}">
                        <option value="">- Please Select Branch-</option>
                    </select>
                </div>
            </div>
            <div class="col" ng-init="$parent.dateinputOpenDate()">
                <div class="form-group">
                    <label>Start Date:*</label>
                    <input type="text"
                           class="form-control dateinputOpenDate bg-white"
                           autocomplete="off"
                           name="START_DATE_FORM"
                           readonly
                           placeholder="Select ..."
                           ng-model="CoversSearch.START_DATE"
                           ng-value="CoversSearch.START_DATE | date"
                           required
                           ng-class="{'error':CoversForm.submitted && CoversForm.START_DATE_FORM.$error.required}" />
                </div>
            </div>
            <div class="col">
                <label class="d-block">End Date:*</label>
                <input type="text"
                       class="form-control dateinputOpenDate bg-white"
                       autocomplete="off"
                       name="END_DATE_FORM"
                       readonly
                       placeholder="Select ..."
                       ng-model="CoversSearch.END_DATE"
                       ng-value="CoversSearch.END_DATE | date"
                       required
                       ng-class="{'error':CoversForm.submitted && CoversForm.END_DATE_FORM.$error.required}" />
            </div>
            <div class="col-md-3">
                <label>Upload File:*</label>
                <div class="input-group">
                    <input class="form-control text-xs" type="file"
                           ng-model="CoversSearch.UploadedFiles"
                           id="uploadExcel1"
                           ng-files="Refreshdata();getTheFilesToUploadall($files,5,CoversSearch,1, 'uploadExcel','CASH_COVERS')"
                           ng-click="FILEUPLOADCLICK()"
                           name="file" />

                    <div class="input-group-append">
                        <span class="input-group-text" ng-if="Uploading">
                            <img src="../../E_Content/images/loading.gif" style="height: 22px" />
                        </span>
                    </div>
                </div>
            </div>
            <!--<div class="col-md-4">
                <div class="form-group">
                    <label class="d-block">&nbsp;</label>
                    <button type="button" value="Validate"
                            ng-click="EXCEL_COVERS_VALIDATE()"
                            class="btn btn-wenodo">
                        Validate
                    </button>
                    <button type="button" value="Upload"
                            ng-disabled="INVALID_EXCLE_CELL_COUNT>0"
                            ng-click="INS_UPD_CU_COVERS()"
                            class="btn btn-wenodo">
                        Submit
                    </button>
                    <button type="button" ng-click="RESET_UPLOAD()" class="btn btn-w-default">Reset</button>
                    <button type="button" ng-show="submitted" class="btn {{INVALID_EXCLE_CELL_COUNT==0?'btn-wenodo':'btn-danger'}} "
                            ng-disabled="INVALID_EXCLE_CELL_COUNT>0"
                            data-toggle="modal"
                            data-target="#View_Report">
                    <i ng-show="INVALID_EXCLE_CELL_COUNT>0" class="far fa-exclamation-triangle"></i> {{INVALID_EXCLE_CELL_COUNT==0?'':'Validation Failed'}} </button>


                </div>
            </div>-->
            <div class="col-auto">
                <div class="form-group">
                    <label class="d-block">&nbsp;</label>
                    <button type="button" value="Validate" ng-click="EXCEL_COVERS_VALIDATE()" class="btn btn-wenodo" data-toggle="tooltip" data-html="true" data-original-title="Validate">
                        <i class="far fa-badge-check"></i>
                    </button>
                    <button type="button" value="Upload" ng-disabled="INVALID_EXCLE_CELL_COUNT>0" ng-click="INS_UPD_CU_COVERS()" class="btn btn-wenodo" data-toggle="tooltip" data-html="true" data-original-title="Submit">
                        <i class="far fa-save"></i>
                    </button>
                    <button type="button" ng-click="RESET_UPLOAD()" class="btn btn-w-default" data-toggle="tooltip" data-html="true" data-original-title="Reset">
                        <i class="far fa-undo"></i>
                    </button>
                    <button type="button" ng-show="submitted" class="btn {{INVALID_EXCLE_CELL_COUNT==0?'btn-wenodo':'btn-danger'}} " data-toggle="modal" data-target="#View_Report">
                        <i ng-show="INVALID_EXCLE_CELL_COUNT>0" class="far fa-exclamation-triangle"></i>  <i class="far fa-eye" data-toggle="tooltip" data-html="true" data-original-title="View"></i>

                        <!--{{INVALID_EXCLE_CELL_COUNT==0?'':'Validation Failed'}}
                             ng-disabled="INVALID_EXCLE_CELL_COUNT>0"
                            -->
                    </button>
                </div>
            </div>

            <div class="col-md-12">
                <div data-ng-show="CoversForm.submitted && CoversForm.$invalid" class="form-group has-error errormessage badge badge-light-red w-100 p-3">
                    <span class="help-block errormessageline"><i class="fa fa-exclamation-triangle"></i> - Please provide the mandatory details to submit(marked in red).</span>
                </div>
                <div id="divInvlidUser" class="hideshowdiv" data-ng-show="CoversForm.$valid">
                    <span class="help-block">{{InvalidUser}}</span>
                </div>
            </div>
        </div>
    </form>
</div>
<div class="card-header">
    <h5 class="card-title">Filter By</h5>
</div>
<div class="card-body">
    <div class="row">
        <div class="col">
            <div class="form-group">
                <label>User Name:</label>
                <input type="text"
                       class="form-control"
                       autocomplete="off"
                       maxlength="250"
                       name="USER_NAME"
                       ng-model="CoversSearch.USER_NAME" />
            </div>
        </div>
        <div class="col">
            <div class="form-group">
                <label>Branch:</label>
                <select class="custom-select"
                        name="BRANCH_ID"
                        ng-model="CoversSearch.BRANCH_ID_FILTER"
                        ng-options="CL.BRANCH_ID as CL.BRANCH_NAME for CL in BRANCH_LIST_VIEW">
                    <option value="">- Please Select Branch-</option>
                </select>
            </div>
        </div>
        <div class="col-md-3" ng-init="$parent.dateinputOpenDate()">
            <div class="form-group">
                <label>Upload Date:</label>
                <!--<input type="text"
                       class="form-control dateinputOpenDate bg-white"
                       name="START_DATE"
                       autocomplete="off"
                       readonly
                       placeholder="Select ..."
                       ng-model="CoversSearch.START_DATE_FILTER"
                       ng-value="CoversSearch.START_DATE_FILTER | date" />-->
                <div id="reportrange" class="custom-select custom-date text-xs">
                    <i class="glyphicon glyphicon-calendar fa fa-calendar"></i> 
                    <span></span><b class="caret"></b>
                </div>
            </div>
        </div>

        <div class="col">
            <div class="form-group">
                <label>File Name:</label>
                <input type="text"
                       class="form-control"
                       maxlength="250"
                       name="FILE_NAME"
                       ng-model="CoversSearch.ORIGINAL_FILE_NAME" />
            </div>
        </div>
        <div class="col-auto">
            <div class="row">
                <div class="form-group">
                    <label class="d-block">&nbsp;</label>
                    <button click-once ng-click="GET_CU_COVER_LOG_HDR()" class="btn btn-wenodo" data-toggle="tooltip" data-html="true" data-original-title="Search"><i class="far fa-search"></i></button>
                    <button ng-click="RESET_FILTER()" class="btn btn-w-default" data-toggle="tooltip" data-html="true" data-original-title="Reset"><i class="far fa-undo"></i></button>
                </div>
            </div>
        </div>
        <!--<div class="col-md-2">
            <label class="d-block">End Date:</label>-->
            <!--<input type="text"
               class="form-control dateinputOpenDate bg-white"
               autocomplete="off"
               name="END_DATE"
               readonly
               placeholder="Select ..."
               ng-model="CoversSearch.END_DATE_FILTER"
               ng-value="CoversSearch.END_DATE_FILTER | date" />
        </div>-->
    </div>
</div>
<div class="text-center" ng-show="CU_COVER_LOG_HDR_DETAILS.length==0" empty-grid>
</div>
<div class="table-responsive custom-scrollbar height-450" ng-show="CU_COVER_LOG_HDR_DETAILS.length>0">
    <table class="table table-striped table-head-fixed">
        <thead class="bg-wenodo-dark-blue">
            <tr>
                <th>User Name</th>
                <th>Entity</th>
                <th class="text-nowrap">Branch Name</th>
                <th>File Name</th>
                <th class="text-nowrap">Total Records</th>
                <th class="text-nowrap">Start Date</th>
                <th class="text-nowrap">End Date</th>
                <th class="text-nowrap">Upload Date</th>
                <!--<th>Is Live</th>
                <th>Status</th>-->
                <th>View</th>
            </tr>
        </thead>
        <tfoot>
            <tr>
                <td colspan="8" align="center" ng-show="GetData">
                    <a class="btn btn-secondary text-white" ng-click="LAZY_CU_COVER_LOG_HDR_DETAILS()">{{VIEWMORERECORD}}</a>
                </td>
            </tr>
        </tfoot>
        <tbody ng-repeat="CL in CU_COVER_LOG_HDR_DETAILS" on-finish-render="ngRepeatFinished">
            <tr>
                <td>
                    {{CL.USER_NAME}}
                    <br />
                    {{CL.USER_EMAIL}}
                </td>
                <td>{{CL.ENTITY_NAME}}</td>
                <td>{{CL.BRANCH_NAME}}</td>
                <td class="file_name_Limit text-nowrap" style="width:300px;"> <a download="{{CL.SERVER_FILE_NAME}}" href="{{CL.SERVER_FILE_NAME}}"> {{CL.ORIGINAL_FILE_NAME}}</a></td>
                <td>{{CL.CU_COVER_COUNT}}</td>
                <td class="text-nowrap">{{CL.START_DATE | date}}</td>
                <td class="text-nowrap">{{CL.END_DATE | date}}</td>
                <td class="text-nowrap">{{CL.CREATED_DATE | date:'MMM dd, yyyy'}}</td>
                <td class="headcol-right">
                    <a ng-click="GET_CU_COVER_LOG_DTL(CL)" data-toggle="modal" data-target="#View_Covers_Log_Detail" data-html="true" data-original-title="View"><i class="fad fa-eye fa-lg text-green"></i></a>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<div class="modal fade" id="View_Report" aria-modal="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title"> Your Uploaded File</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body custom-scrollbar height-500">
                <div class="text-center" ng-show="COVERS_VALIDATE_LIST.length==0" empty-grid></div>
                <div class="col-md-12">
                    <div data-ng-show="INVALID_EXCLE_CELL_FLAG" class="form-group has-error errormessage badge badge-light-red w-100 p-3">
                        <span class="help-block errormessageline"><i class="fa fa-exclamation-triangle"></i> - Please provide the mandatory details to (marked in red).</span>
                    </div>
                    <div id="divInvlidUser" class="hideshowdiv" data-ng-show="INVALID_EXCLE_CELL_FLAG">
                        <span class="help-block">{{InvalidUser}}</span>
                    </div>
                    <div class="form-group has-error errormessage badge badge-light-red w-100 p-3" ng-repeat="CD in CODE_ARRY | unique:'CODE' ">
                        <span class="help-block errormessageline" style="padding-left:0px;" ng-if="CD.CODE=='CODE0003'"><i class="fa fa-exclamation-triangle"></i> {{CD.CODE}} - Invalid Hyperlink: Malformed URI is embedded as a hyperlink in the document.please remove hyperlink.</span>
                        <span class="help-block errormessageline" style="padding-left:0px;" ng-if="CD.CODE=='CHECK0003'">
                            <i class="fa fa-exclamation-triangle"></i> {{CD.CODE}} - Please provide True or False.
                        </span>
                        <span class="help-block errormessageline" style="padding-left:0px;" ng-if="CD.CODE=='EMAIL0009'">
                            <i class="fa fa-exclamation-triangle"></i> {{CD.CODE}} - Invalid Email.
                        </span>
                        <span class="help-block errormessageline" style="padding-left:0px;" ng-if="CD.CODE=='NUM0010'">
                            <i class="fa fa-exclamation-triangle"></i> {{CD.CODE}} - Number Only.
                        </span>
                        <span class="help-block errormessageline" style="padding-left:0px;" ng-if="CD.CODE=='NUM0011'">
                            <i class="fa fa-exclamation-triangle"></i> {{CD.CODE}} - Number/Digit Only.
                        </span>
                        <span class="help-block errormessageline" style="padding-left:0px;" ng-if="CD.CODE=='NUM0012'">
                            <i class="fa fa-exclamation-triangle"></i> {{CD.CODE}} - Negative value should not allow.
                        </span>

                        <span class="help-block errormessageline" style="padding-left:0px;" ng-if="CD.CODE=='DATE0007'">
                            <i class="fa fa-exclamation-triangle"></i> {{CD.CODE}} - Please provide 'MM/DD/YYYY' format,example:'01/01/1999'.
                        </span>
                        <span class="help-block errormessageline" style="padding-left:0px;" ng-if="CD.CODE=='TIME0006'">
                            <i class="fa fa-exclamation-triangle"></i> {{CD.CODE}} -Invalid Time Format.
                        </span>
                    </div>
                </div>
                <div class="table-responsive" ng-show="COVERS_VALIDATE_LIST.length>0">
                    <table class="table table-striped">
                        <tr>
                            <th ng-repeat="(key, value) in COVERS_VALIDATE_LIST[0]">{{key}}</th>
                        </tr>
                        <tbody ng-repeat="ex in COVERS_VALIDATE_LIST" on-finish-render="ngRepeatFinishedRender">
                            <tr>
                                <td ng-repeat="(key, value) in ex" ng-class="{'border-red':obj.IS_DATA_VALID}" ng-init="obj= ngintvalidationvalue(key,value)">
                                    <span ng-show="false">{{value}}</span>
                                    <span ng-class="{'border-red':obj.IS_VALID}">
                                        <span ng-show="obj.IS_VALID"><i class="fa fa-exclamation-triangle text-danger"></i></span>
                                        {{obj.DISPLAY_TEXT}}
                                    </span>
                                    <span ng-show="obj.IS_DATA_VALID">
                                        {{obj.CODE}}
                                    </span>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <!--<table class="table table-striped">
                        <thead class="bg-wenodo-dark-blue">
                            <tr>
                                <th>S.No</th>
                                <th>Shift Name</th>
                                <th>Reservation Date</th>
                                <th>Reservation Time</th>
                                <th>Status</th>
                                <th>Booking Source</th>
                                <th>Cover Count</th>
                                <th>Created Date</th>
                                <th>Revenue Center</th>
                            </tr>
                        </thead>
                        <tbody ng-repeat="CL in COVERS_VALIDATE_LIST" on-finish-render="ngRepeatFinished" ng-init="nginitValidExcel(CL)">
                            <tr>
                                <td>{{$index+1}}</td>
                                <td ><span ><span ng-bind-html="CL.SHIFT_NAME"></span></span>   </td>
                                <td ><span ><span ng-bind-html="CL.RESERVATION_DATE"></span></span>   </td>
                                <td ><span ><span ng-bind-html="CL.RESERVATION_TIME"></span></span>   </td>
                                <td ><span ><span ng-bind-html="CL.STATUS"></span></span>   </td>
                                <td ><span ><span ng-bind-html="CL.BOOKING_SOURCE"></span></span>   </td>
                                <td ><span ><span ng-bind-html="CL.COVER_COUNT"></span></span>   </td>
                                <td ><span ><span ng-bind-html="CL.CREATED_DATE"></span></span>   </td>
                                <td ><span ><span ng-bind-html="CL.REVENUE_CENTRE"></span></span>   </td>
                            </tr>
                        </tbody>
                    </table>-->
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="View_Covers_Log_Detail" aria-modal="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">
                    Your Uploaded File ({{COVERS_LINE.ORIGINAL_FILE_NAME}})
                </h4>
                <h6 class="ml-auto mb-0 semibold text-secondary">Total Records- {{COVERS_LINE.CU_COVER_COUNT}}</h6>
                <button type="button" class="close m-0 py-0" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body height-535">
                <div class="table-responsive custom-scrollbar height-500" ng-show="CU_COVER_LOG_DETAILS.length>0">
                    <table class="table table-striped table-head-fixed">
                        <thead class="bg-wenodo-dark-blue">
                            <tr>
                                <th class="text-nowrap">S. No</th>
                                <th class="text-nowrap">Shift Name</th>
                                <th class="text-nowrap">Reservation Date</th>
                                <th class="text-nowrap">Reservation Time</th>
                                <th>Status</th>
                                <th class="text-nowrap">Booking Source</th>
                                <th class="text-nowrap">Cover Count</th>
                                <th class="text-nowrap">Created Date</th>
                                <th class="text-nowrap">Revenue Center</th>
                                <th class="text-nowrap">Revenue</th>
                            </tr>
                        </thead>
                        <tfoot>
                            <tr>
                                <td colspan="8" align="center" ng-show="GetDataDTL">
                                    <a class="btn btn-secondary text-white" ng-click="LAZY_CU_COVER_LOG_DETAILS(COVERS_LINE)">{{VIEWMORERECORD}}</a>
                                </td>
                            </tr>
                        </tfoot>
                        <tbody ng-repeat="CL in CU_COVER_LOG_DETAILS" on-finish-render="ngRepeatFinished">
                            <tr>
                                <td>{{$index+1}}</td>
                                <td>{{CL.SHIFT_NAME}}</td>
                                <td>{{CL.RESERVATION_DATE | date}}</td>
                                <td>{{CL.RESERVATION_TIME}}</td>
                                <td>{{CL.STATUS}}</td>
                                <td>{{CL.BOOKING_SOURCE}}</td>
                                <td>{{CL.COVER_COUNT}}</td>
                                <td>{{CL.CREATED_DATE | date}}</td>
                                <td>{{CL.REVENUE_CENTRE}}</td>
                                <td>{{CL.REVENUE}}</td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="5"></td>
                                <td>Total </td>
                                <td>{{CU_COVER_LOG_DETAILS |  total : 'COVER_COUNT'}}</td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>