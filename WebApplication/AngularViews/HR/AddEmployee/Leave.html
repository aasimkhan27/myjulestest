<div class="card-body">
    <div class="row">
        <templateurl class="w-100" template-url="../AngularViews/HR/AddEmployee/EmpHeaderDtls.html?v=2136564{{AppVersion}}">
    </div>
    <div class="leave-tab" >

        <form id="EmpDtlsForm_6" name="EmpDtlsForm_6" novalidate>
            <div class="card-header">
                <h5 class="heading-text">Leave Entitlement <a ng-click="AddObjLeaveLine()" ng-show="ABSENCE_TYPE.length>0" class="btn btn-wenodo float-right"> Add </a> </h5>
                <select ng-show="false"  class="custom-select mr-2"
                        name="ABSENCE_TYPE{{$index}}"
                        ng-model="SELECT_START_YEAR"
                        ng-options="PT as PT.START_YEAR  for PT in (SELECTED_YEAR_DDL)"
                        ng-change="ON_ABSENCE_START_YEAR_EDIT_CHANGE()"
                        required
                        ng-class="{'error':EmpDtlsForm_6.submitted && EmpDtlsForm_6.ABSENCE_TYPE{{$index}}.$error.required}">
                    <option value="">- Select Year</option>
                </select>

            </div>
            <div class="card-body">
                <div class="text-center" ng-show="ABSENCE_TYPE.length==0"> Not  Enough Entitlement </div>
                <div class="row" ng-repeat="LL in SELECT_START_YEAR.LeaveList" ng-init="NG_INIT_LEAVE(LL)" ng-if="LL.DELETE_FLAG==0" on-finish-render="ngRepeatFinished">
                    <div class="col-md-2">
                        <div class="form-group">
                            <label>Absence type:*</label>
                            <select class="custom-select"
                                    name="ABSENCE_TYPE{{$index}}"
                                    ng-model="LL.HOLIDAY_ENTITLEMENT_ID"
                                    ng-options="PT.HOLIDAY_ENTITLEMENT_ID as PT.DISPLAY_TEXT for PT in (ABSENCE_TYPE)"
                                    ng-change="ON_ABSENCETYPECHANGE(LL,$index)"
                                    required
                                    ng-class="{'error':EmpDtlsForm_6.submitted && EmpDtlsForm_6.ABSENCE_TYPE{{$index}}.$error.required}">
                                <option value="">- Select Absence Type</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group">
                            <label>Entitlement:*</label>
                            <input type="text"
                                   class="form-control"
                                   placeholder="Enter ..."
                                   name="ALLOCATION{{$index}}"
                                   ng-change="ON_VALUE_CHANGE(LL)"
                                   maxlength="9"
                                   required
                                   only-digits
                                   ng-class="{'error':EmpDtlsForm_6.submitted && EmpDtlsForm_6.ALLOCATION{{$index}}.$error.required}"
                                   ng-model="LL.ALLOCATION_DAYS_CAL">
                        </div>
                    </div>
                    <div class="col-md-1">
                        <div class="form-group">
                            <label>Units:</label>
                            <span class="d-block">
                                {{LL.UNIT_NAME}}
                            </span>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group" >
                            <label>Year Start:</label>
                           <span  ng-show="false" class="d-block">
                                {{LL.YEAR_START_DATE | date}}
                            </span> 
                            <input type="text"
                                   class="form-control Leavedateinput"
                                   name="YEAR_START_DATE_RANGE{{$index}}"
                                   autocomplete="off"
                                   required
                                   readonly
                                   ng-change="ON_VALUE_CHANGE(LL,$index)"
                                   ng-class="{'error':EmpDtlsForm_6.submitted && EmpDtlsForm_6.YEAR_START_DATE_RANGE{{$index}}.$error.required}"
                                   ng-model="LL.YEAR_START_DATE"
                                   ng-value="LL.YEAR_START_DATE | date">
                        </div>
                    </div>
                    <div class="col-md-2" ng-init="DateLeaveInputLoad(LL,$index,1)">
                        <div class="form-group"  >
                            <label>Year End:*</label>
                            <input type="text"
                            class="form-control Leavedateinput"
                            name="ALLOCYEAR_END_DATEATION{{$index}}"
                            autocomplete="off"
                            required
                            readonly
                            ng-change="ON_VALUE_CHANGE(LL,$index)"
                            ng-class="{'error':EmpDtlsForm_6.submitted && EmpDtlsForm_6.ALLOCYEAR_END_DATEATION{{$index}}.$error.required}"
                            ng-model="LL.YEAR_END_DATE" 
                            ng-value="LL.YEAR_END_DATE | date"
                                   >
                        </div>
                    </div>
                    <div class="col" ng-init="DateLeaveInputLoad(LL,$index,2)">
                        <div class="form-group">
                            <label class="d-block">&nbsp;</label>
                            <a ng-click="RemoveLeaveLine(LL,$index,$last)" class="btn btn-danger" data-toggle="tooltip" data-html="true" data-original-title="Delete"><i class="far fa-trash"></i></a>
                            <!--<a ng-click="AddObjLeaveLine()"  ng-show="SELECT_START_YEAR.LeaveList.length-1==$index" class="btn btn-wenodo" data-toggle="tooltip" data-html="true" data-original-title="Add"><i class="far fa-plus"></i></a>-->
                            <button type="button" ng-click="RESET_LEAVE(LL)" ng-show="LL.RESET_FLAG==1" class="btn btn-w-default" data-toggle="tooltip" data-html="true" data-original-title="Reset"><i class="far fa-undo"></i></button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div data-ng-show="EmpDtlsForm_6.submitted && EmpDtlsForm_6.$invalid" class="form-group has-error errormessage badge badge-light-red w-100 p-3">
                    <span class="help-block errormessageline"><i class="fa fa-exclamation-triangle"></i> - Please provide the mandatory details to submit(marked in red).</span>
                </div>
                <div id="divInvlidUser" class="hideshowdiv" data-ng-show="EmpDtlsForm_6.$valid">
                    <span class="help-block">{{InvalidUser}}</span>
                </div>
            </div>
            <div class="card-body pt-0">
                <div class="form-group">
                    <button ng-click="GO_BACK(5)" class="btn btn-w-default">Go Back</button>
                    <button ng-disabled="LeaveListDelete.length==0 && (SELECT_START_YEAR.LeaveList==null || SELECT_START_YEAR.LeaveList=='' || SELECT_START_YEAR.LeaveList.length==0)" ng-click="HR_INS_UPD_EMPLOYEE_STEP_6()" click-once  class="btn btn-wenodo">Save & continue</button>
                    <button ng-disabled="LeaveListDelete.length==0 && (SELECT_START_YEAR.LeaveList==null || SELECT_START_YEAR.LeaveList=='' || SELECT_START_YEAR.LeaveList.length==0)" ng-click="HR_INS_UPD_EMPLOYEE_STEP_6(1)" click-once  class="btn btn-w-default">Save changes for later</button>
                    <button type="button" ng-click="GO_FORWARD_LEAVE(7)" class="btn btn-wenodo">Skip</button>
                    <button type="button" ng-click="GO_BACK_TO_LIST()" class="btn btn-w-default">Cancel</button>
                </div>
            </div>
            
        </form>
    </div>
</div>