<div class="row">
    <div class="col-md-12">
        <templateurl class="w-100" template-url="../AngularViews/HR/ViewEmployee/HeaderDtlsNew.html?v=2136564{{AppVersion}}">
    </div>
    <div class="col-auto mn-w-250">
        <templateurl class="w-100" template-url="../AngularViews/HR/ViewEmployee/Employee_Tabs.html?v={{AppVersion}}">
    </div>
    <div class="col">
        <div ng-show="IS_LEAVE_TAB==0" class="mt-2">
                <h5 class="heading-text-2 mt-2">Leave Entitlement</h5>
                <div class="float-right">
                    <button type="button" ng-show="EmpSearch_HEADER.ACTIVE && IS_EDITABLE_FLAG" class="btn btn-sm btn-wenodo" ng-if="EDIT_PROFILE_CHECK_MODULE_ACCESS" ng-click="ADD_LEAVE()">Edit</button>
                </div>
            <div class="col-md-12">
                <ul class="nav nav-tabs w-100 font-16 text-bold bg-wenodo-tabs-blue pt-2" id="custom-content-above-tab" role="tablist">
                    <li class="nav-item" ng-repeat="Ab in ABSENCE_TYPE_EMP" ng-click="LEAVE_TAB_CLICK(Ab)">
                        <a class="nav-link " ng-class="{'active':ViewEmpSearch_6.HOLIDAY_ENTITLEMENT_ID == Ab.HOLIDAY_ENTITLEMENT_ID}"
                           id="custom-content-above-home-tab"
                           data-toggle="pill"
                           role="tab"
                           aria-controls="custom-content-above-annual"
                           aria-selected="true">{{Ab.DISPLAY_TEXT}}</a>
                    </li>
                    <li class="ml-auto">
                        <div class="form-inline">
                            <label class="mr-2">Start Year</label>
                            <select class="custom-select mw-200"
                                    name="ABSENCE_TYPE{{$index}}"
                                    ng-model="SELECT_START_YEAR"
                                    ng-options="PT as PT.START_YEAR  for PT in (SELECTED_YEAR_DDL)"
                                    ng-change="ON_ABSENCE_START_YEAR_CHANGE()"
                                    required
                                    ng-class="{'error':EmpDtlsForm_6.submitted && EmpDtlsForm_6.ABSENCE_TYPE{{$index}}.$error.required}"></select>
                        </div>
                    </li>
                </ul>
                <div class="text-center" ng-show="ABSENCE_TYPE_EMP.length==0" empty-grid></div>
                <div class="tab-content bg-white" id="custom-content-above-tabContent" ng-show="ABSENCE_TYPE_EMP.length>0">
                    <div class="tab-pane fade show active" id="custom-content-above-annual" role="tabpanel" aria-labelledby="custom-content-above-home-tab">
                        <div class="col-md-12">
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="mb-0">Validity</label>
                                        <span class="form-content">{{ViewEmpSearch_6.START_DATE | date}}-{{ViewEmpSearch_6.END_DATE | date}}</span>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="mb-0">Leave allocation <i data-toggle="tooltip" data-html="true" data-original-title="Assigned leave for current year" class="fa fa-info-circle"></i></label>
                                        <span class="form-content">{{ViewEmpSearch_6.ALLOCATION | number:2}} {{ViewEmpSearch_6.UNIT_NAME}}</span>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="mb-0">Accrued <i data-toggle="tooltip" data-html="true" data-original-title="Leaves accrued in current year" class="fa fa-info-circle"></i></label>
                                        <span class="form-content">{{ViewEmpSearch_6.ACCURED_LEAVE==null?0:ViewEmpSearch_6.ACCURED_LEAVE | number:2}} {{ViewEmpSearch_6.UNIT_NAME}}</span>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="mb-0">Rejected</label>
                                        <span class="form-content">{{ViewEmpSearch_6.REJECTED | number:2}} {{ViewEmpSearch_6.UNIT_NAME}}</span>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="mb-0">Pending</label>
                                        <span class="form-content">{{ViewEmpSearch_6.PENDING | number:2}} {{ViewEmpSearch_6.UNIT_NAME}}</span>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="mb-0">Approved</label>
                                        <span class="form-content">{{ViewEmpSearch_6.APPROVED | number:2}} {{ViewEmpSearch_6.UNIT_NAME}}</span>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="mb-0">
                                            Remaining
                                            <i data-toggle="tooltip" data-html="true"
                                               data-original-title="Assigned leave for current year- Leaves taken" class="fa fa-info-circle"></i>
                                        </label>
                                        <span class="form-content">{{ViewEmpSearch_6.REMAINING_DAY_ASS_CAL | number:2}} {{ViewEmpSearch_6.UNIT_NAME}}</span>
                                    </div>
                                </div>

                                <div class="col-md-4">
                                    <div class="form-group">
                                        <label class="mb-0">
                                            Remaining Accrued
                                            <i data-toggle="tooltip" data-html="true"
                                               data-original-title="Accrued leave for current year- Leaves taken" class="fa fa-info-circle"></i>
                                        </label>
                                        <span class="form-content">{{ViewEmpSearch_6.REMAINING_ACCRUED | number:2}} {{ViewEmpSearch_6.UNIT_NAME}}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card-header bg-transparent mt-2">
            <h5 class="heading-text-2 mt-2">
                Requested Leave
            </h5>
            <div class="float-right" ng-show="CheckSubModuleAccess(6)">
                <button type="button" ng-show="EmpSearch_HEADER.ACTIVE" class="btn btn-sm btn-wenodo" ng-click="POP_LEAVE_MASTER_JS('VIEW_LEAVE')">Record Leave </button>
            </div>
        </div>
        <div class="card-body">
            <div class="text-center" ng-show="REQUESTED_LEAVE.length==0" empty-grid></div>
            <div class="table-responsive" ng-show="REQUESTED_LEAVE.length>0">
                <table class="table table-hover table-striped compact_table">
                    <thead class="bg-wenodo-border">
                        <tr>
                            <th>Absence type</th>
                            <th>Start date</th>
                            <th>End date</th>
                            <th>Duration</th>
                            <th></th>
                        </tr>
                    </thead>

                    <tbody ng-repeat="RL in REQUESTED_LEAVE" ng-init="NG_INIT_REQUESTED_LEAVE(RL)" on-finish-render="ngRepeatFinished">
                        <tr>
                            <td>
                                <span class="event-dots event-leave" style="background-color:#{{RL.ABSENCE_COLOR_CODE}}"></span>
                                {{RL.ABSENCE_TYPE_NAME}}
                            </td>
                            <td>{{RL.START_DATE | date}}</td>
                            <td>{{RL.END_DATE | date}}</td>
                            <td>{{RL.CAL_LEAVE_DAYS | number :2 }}</td>
                            <td>
                                <i data-toggle="tooltip" data-html="true" data-original-title="Auto Approved" ng-show="RL.STATUS_ID==15" ng-click="POP_DELETE_LEAVE(RL)" class="fad fa-shield-check fa-lg text-green cursor-pointer"></i>
                                <i data-toggle="tooltip" data-html="true" data-original-title="Pending" ng-show="RL.STATUS_ID==11" ng-click="POP_DELETE_LEAVE(RL,2)" class="fad fa-alarm-exclamation fa-lg text-secondary cursor-pointer"></i>
                                <i data-toggle="tooltip" data-html="true" data-original-title="Approved" ng-show="RL.STATUS_ID==12" ng-click="POP_DELETE_LEAVE(RL)" class="fad fa-check-double fa-lg text-success cursor-pointer"></i>
                                <i data-toggle="tooltip" data-html="true" data-original-title="Rejected" ng-show="RL.STATUS_ID==13" ng-click="POP_DELETE_LEAVE(RL,2)" class="fad fa-times-circle fa-lg text-danger cursor-pointer"></i>
                                <i data-toggle="tooltip" data-html="true" data-original-title="Cancel Applied Leave" ng-show="RL.STATUS_ID==11 ||  (RL.STATUS_ID==15 ||  RL.STATUS_ID==12) && EMPLOYEE_ID!=EmpID" ng-click="POP_DELETE_LEAVE(RL,1)" class="fad fa-calendar-times fa-lg text-danger cursor-pointer"></i>
                                <a ng-show="RL.STATUS_ID==14" ng-click="POP_DELETE_LEAVE(RL,2)" data-toggle="tooltip" data-html="true" data-original-title="Cancelled"><i class="fad fa-ban fa-lg text-danger"></i></a>
                            </td>
                        </tr>

                    </tbody>
                    <tfoot ng-show="GetDataR">
                        <tr>
                            <td colspan="11" align="center">
                                <a class="btn btn-secondary text-white ng-binding" ng-click="LAZY_LOAD()">Click here to see more..</a>
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
        <div class="col-md-12">
            <div class="w-100" ng-include="'../AngularViews/CommonView/UpcomingUpdates.html?v=1121{{AppVersion}}'"></div>
        </div>
    </div>
</div>

<div class="modal fade" id="MY_REQUEST_LEAVE_DETAILS_C">
    <form id="AbsenceLeave" name="AbsenceLeave" novalidate>
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title"> Absence request</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body custom-scrollbar height-450">
                    <div class="col-md-12 mb-3">
                        <img ng-show="EMP_DTDS.IMAGE_PATH==null || EMP_DTDS.IMAGE_PATH==''" src="../dist/img/user1-128x128.jpg" class="img-size-32 mr-1 img-circle">
                        <img ng-show="EMP_DTDS.IMAGE_PATH!=null && EMP_DTDS.IMAGE_PATH!=''" src="{{EMP_DTDS.IMAGE_PATH}}" class="img-size-32 mr-1 img-circle">
                        {{EMP_DTDS.EMPLOYEE_NAME}}
                    </div>
                    <div class="row mt-2 ml-1">
                        <div class="col-md-6 border">
                            <div class="form-group">
                                <label>Department</label>
                                <div class="input-group">
                                    {{EMP_DTDS.DEPARTMENT_NAME}}
                                </div>
                            </div>
                        </div>

                        <div class="col-md-3 border">
                            <div class="form-group">
                                <label>Absence Type</label>
                                <div class="input-group">
                                    {{EMP_DTDS.ABSENCE_TYPE_NAME}}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 border">
                            <div class="form-group">
                                <label>Duration</label>
                                <div class="input-group">
                                    {{EMP_DTDS.CAL_LEAVE_DAYS | number :2}}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 border">
                            <div class="form-group">
                                <label>Start Date</label>
                                <div class="input-group">
                                    {{EMP_DTDS.START_DATE | date:'d/M/yyyy'}}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 border">
                            <div class="form-group">
                                <label>Start Time</label>
                                <div class="input-group">
                                    {{EMP_DTDS.START_DATE | date:'HH:mm:ss'}}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 border">
                            <div class="form-group">
                                <label>End Date</label>
                                <div class="input-group">
                                    {{EMP_DTDS.END_DATE | date:'d/M/yyyy' }}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 border">
                            <div class="form-group">
                                <label>End Time</label>
                                <div class="input-group">
                                    {{EMP_DTDS.END_DATE | date: 'HH:mm:ss'}}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 border">
                            <div class="form-group">
                                <label>Leave Comments</label>
                                <div class="input-group">
                                    {{EMP_DTDS.COMMENTS==null?'-':EMP_DTDS.COMMENTS}}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 border">
                            <div class="form-group">
                                <label>Attachments</label>
                                <span ng-show="EMP_DTDS.UploadedFiles.length==0"></span>
                                <span class="d-block" ng-repeat="File in EMP_DTDS.UploadedFiles">
                                    <a href="../{{File.FILE_PATH}}{{File.SERVER_FILE_NAME}}" download="{{File.ORIGINAL_FILE_NAME}}"><i class="fa fa-download"></i> {{File.ORIGINAL_FILE_NAME}}</a>
                                </span>
                            </div>
                        </div>
                        <div class="row">
                            <!--<div ng-repeat="LIST in [{'DATA':EMP_DTDS}]" ng-include="'../AngularViews/CommonView/FormLabelView.html?v=2136564{{AppVersion}}'"></div>-->
                        </div>
                        <div class="col-md-12" ng-show="EMP_DTDS.STATUS_ID==11 && EMP_DTDS.DIS_PLAY_FLAG==2">
                            <label>Approve / Reject Comments :<span ng-show="REJECT_APPROVE_FLAG==1">*</span> </label>
                            <textarea class="form-control"
                                      rows="5"
                                      name="COMMENTS"
                                      ng-required="REJECT_APPROVE_FLAG==1"
                                      placeholder="Enter."
                                      ng-model="LEAVE_CANCEL"
                                      ng-change="CHANGE_LEAVE_COMMTS()"
                                      ng-class="{'error':AbsenceSubmit.submitted && REJECT_APPROVE_FLAG==1 && AbsenceLeave.COMMENTS.$error.required || AbsenceSubmit.submitted && REJECT_APPROVE_FLAG==1}"></textarea>

                            <div class="col-md-12 px-0 mt-2">
                                <div data-ng-show="AbsenceSubmit.submitted && AbsenceLeave.$invalid || REJECT_APPROVE_FLAG==1 && AbsenceSubmit.submitted" class="form-group has-error errormessage form-group has-error errormessage badge badge-light-red w-100 p-3">
                                    <span class="help-block errormessageline"><i class="fa fa-exclamation-triangle"></i> - Please provide the mandatory details to submit(marked in red).</span>
                                </div>
                                <div id="divInvlidUser" class="hideshowdiv" data-ng-show="AbsenceLeave.$valid">
                                    <span class="help-block">{{InvalidUser}}</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12" ng-show="EMP_DTDS.DIS_PLAY_FLAG==1">
                            <label>Cancel Comments</label>
                            <textarea class="form-control"
                                      rows="5"
                                      name="LEAVE_CANCEL_MY"
                                      placeholder="Enter."
                                      ng-required="EMP_DTDS.DIS_PLAY_FLAG==1"
                                      ng-model="LEAVE_CANCEL"
                                      ng-class="{'error':AbsenceSubmit.submitted && AbsenceLeave.LEAVE_CANCEL_MY.$error.required}"></textarea>
                        </div>

                    </div>
                </div>
                <div class="modal-footer justify-content-left" ng-show="EMP_DTDS.STATUS_ID==11 && EMP_DTDS.DIS_PLAY_FLAG!=1 && EMPLOYEE_ID!=EmpID">
                    <button type="button" ng-click="APP_REJ_HR_LEAVE_REQUESTS(12,EMP_DTDS,'PROFILE_VIEW_PAGE')" class="btn btn-sm btn-wenodo">Approve </button>
                    <button type="button" ng-click="REJECT_APPROVE_FLAG=1;APP_REJ_HR_LEAVE_REQUESTS(13,EMP_DTDS,'PROFILE_VIEW_PAGE')" class="btn btn-sm btn-danger">Reject </button>
                </div>
                <div class="modal-footer justify-content-left" ng-show="EMP_DTDS.STATUS_ID==11 && EMP_DTDS.DIS_PLAY_FLAG==1 || (EMP_DTDS.STATUS_ID==15 ||  EMP_DTDS.STATUS_ID==12) && EMP_DTDS.DIS_PLAY_FLAG==1">
                    <button type="button" ng-click="REJECT_APPROVE_FLAG=1;APP_REJ_HR_LEAVE_REQUESTS(14,EMP_DTDS,'PROFILE_VIEW_PAGE')" class="btn btn-sm btn-wenodo">Cancel Leave </button>
                </div>
            </div>
        </div>
        </form>
</div>




