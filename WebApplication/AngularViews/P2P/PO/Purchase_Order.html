<div class="row">
    <div class="col-md-2 custom-scrollbar height-84vh stick-top">
        <div class="col-md-12 px-0 pb-1 sticky-top bg-white">
            <form id="SearchForm" name="SearchForm" novalidate autocomplete="off">
                <div class="search-form-group mb-2">
                    <input type="text" ng-model="PO_Search.SEARCH_PARAMETER" class="form-control" placeholder="Search by PO#/Supplier" />
                    <button type="submit" class="btn btn-wenodo" click-once ng-click="GET_PURCHASE_ORDERS(1)">Search</button>
                </div>
                <span class="bigcheck mb-2">
                    <label class="bigcheck" for="CANCELLED_PO">
                        <input type="checkbox"
                               class="bigcheck"
                               ng-change="GET_PURCHASE_ORDERS(1)"
                               ng-model="PO_Search.SHOW_CANCELLED_PO"
                               id="CANCELLED_PO">
                        <span class="bigcheck-target"></span>
                        <span class="font-14" style="margin-top:2px;">Show All</span>
                    </label>

                </span>
            </form>
        </div>
        <div class="detailed-card " ng-class="{'active':POL.PAGING==PO_Search.PO_DETAILS.PAGING}"
             ng-repeat="POL in PURCHASE_ORDERS_LIST" ng-click="PO_CLICK(POL)" on-finish-render="ngRepeatFinishedRender">
            <div class="card-body">
                <div class="row">
                    <div class="col">
                        <div class="row">
                            <div class="col">
                                <span class="po-details text-limit-1 font-12">{{POL.CONTACT_NAME}}</span>
                                <span class="po-supplier font-12">
                                    {{POL.PO_NUMBER}}
                                    <i class="fas fa-check-circle"
                                       ng-class="{'light-grey':POL.GRN_STATUS_ID==75,'text-blue':POL.GRN_STATUS_ID==76,'text-success':POL.GRN_STATUS_ID==77}"
                                       data-toggle="tooltip"
                                       data-html="true"
                                       data-original-title="{{POL.GRN_STATUS_ID==75?'Not Received':POL.GRN_STATUS_ID==76? 'Partially Received':POL.GRN_STATUS_ID==77?'Fully Received':''}}">
                                    </i>
                                </span>
                            </div>
                            <div class="col-auto">
                                <span ng-class="{'badge-light-blue':POL.STATUS_ID==72
                                                        ,'badge-danger':POL.STATUS_ID==73 || POL.STATUS_ID==73}"
                                      class="badge ">{{POL.PO_STATUS_NAME}}</span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-7">
                                <span class="po-supplier font-10">{{POL.REQUESTOR_NAME}}</span>
                                <span class="po-supplier font-10">{{POL.BRANCH_NAME}}</span>
                            </div>
                            <div class="col-md-5 text-right">
                                <span class="po-supplier font-12 text-dark text-nowrap">
                                    {{POL.TOTAL_AMOUNT | number :2}}
                                    <span ng-bind-html="POL.PO_CURRENCY_CODE"></span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-12" ng-show="GetData">
            <button type="button" ng-click="GET_PURCHASE_ORDERS_LAZY_LOAG()" class="btn btn-block btn-w-default">
                {{VIEWMORERECORD}}
            </button>
        </div>
    </div>
    <div class="col-md-10">
        <div class="row align-content-center mn-height-66vh" ng-show="PURCHASE_ORDERS_LIST.length==0">
            <div class="col-md-12 text-center">
                <h5 class="text-muted">
                    <span class="d-block mb-3">
                        <img src="../../../E_Content/images/sorted.png" />
                    </span>
                    Everything's sorted!
                </h5>
            </div>
        </div>
        <div class="card-body" ng-show="PURCHASE_ORDERS_LIST.length>0">
            <div class="row">
                <div class="col">
                    <h6 class="po-details  font-14 ">
                        Purchase Order
                        <span ng-show="PO_Search.PO_DETAILS.STATUS_ID==72">({{PO_Search.PO_DETAILS.PO_NUMBER}})</span>  to {{PO_Search.PO_DETAILS.CONTACT_NAME}}.
                    </h6>
                </div>
            </div>
            <div class="row align-items-center mt-1">
                <div class="col-auto"><div class="name-badge">{{PO_Search.PO_DETAILS.SHORT_NAME}}</div></div>
                <div class="col-md-5">
                    <span class="po-details">By {{PO_Search.PO_DETAILS.REQUESTOR_NAME}}</span>
                    <span class="po-supplier">{{PO_Search.PO_DETAILS.REQUESTOR_EMAIL}}</span>
                    <span class="po-supplier"><span class="text-normal">Raised For {{PO_Search.PO_DETAILS.BRANCH_NAME}} </span></span>
                </div>
                <div class="col-md-3"><span class="po-supplier">REQ#: {{PO_Search.PO_DETAILS.REQ_NUMBER}}</span></div>
                <div class="col" >
                    <span class="po-supplier text-right">
                        <button type="button"
                                data-toggle="tooltip"
                                data-html="true"
                                data-original-title="View PO PDF"
                                class="btn btn-w-default cursor-pointer"
                                ng-click="PDF_DOWNLOAD_FY(1,PO_Search.PO_DETAILS)">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button type="button"
                                data-toggle="tooltip"
                                data-html="true"
                                data-original-title="Download PO PDF"
                                class="btn btn-w-default cursor-pointer"
                                ng-click="PDF_DOWNLOAD_FY(2,PO_Search.PO_DETAILS)">
                            <i class="fas fa-download"></i>
                        </button>
                        <button type="button"
                                data-toggle="tooltip"
                                data-html="true"
                                data-original-title="Download Audit PDF"
                                class="btn btn-w-default cursor-pointer"
                                ng-click="AUDIT_PDF_DOWNLOAD_FY(2,PO_Search.PO_DETAILS)">
                            <i class="fas fa-file-alt"></i>
                        </button>

                        <button type="button"
                                class="btn btn-transparent-danger mr-2 border"
                                ng-click="POP_DISCARD_PO_FY(1)"
                                ng-show="PO_Search.PO_DETAILS.GRN_STATUS_ID==75 && PO_Search.PO_DETAILS.STATUS_ID!=73 && CheckSubModuleAccess(132) || CheckSubModuleAccess(134) &&  PO_Search.PO_DETAILS.STATUS_ID!=73 && PO_Search.PO_DETAILS.GRN_STATUS_ID==75"
                                data-toggle="tooltip"
                                data-html="true"
                                data-placement="top"
                                data-original-title="Cancel PO">
                            <i class="fal fa-align-slash"></i>
                        </button>
                    </span>
                </div>
            </div>
            <div class="row mt-3" id="div_PurchaseOrder">
                <div class="col">
                    <div class="form-group">
                        <label>Contact</label>
                        <span class="d-block text-bold font-14"> {{PO_Search.PO_DETAILS.CONTACT_NAME}}</span>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <label>Date</label>
                        <span class="d-block text-bold font-14">{{PO_Search.PO_DETAILS.PO_DATE | date}}</span>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <label>Delivery Date</label>
                        <span class="d-block text-bold font-14">{{PO_Search.PO_DETAILS.DELIVERY_DATE  | date}}</span>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <label>Reference</label>
                        <span class="d-block text-bold font-14">{{PO_Search.PO_DETAILS.REFERENCE==null || PO_Search.PO_DETAILS.REFERENCE==''?'-':PO_Search.PO_DETAILS.REFERENCE}}</span>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <label>Project Name</label>
                        <span class="d-block text-bold font-14">{{PO_Search.PO_DETAILS.PROJECT_NAME==null || PO_Search.PO_DETAILS.PROJECT_NAME==''?'-':PO_Search.PO_DETAILS.PROJECT_NAME}}</span>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <label>Theme</label>
                        <span class="d-block text-bold font-14">{{PO_Search.PO_DETAILS.BRANDING_THEME==null || PO_Search.PO_DETAILS.BRANDING_THEME==''?'-':PO_Search.PO_DETAILS.BRANDING_THEME}}</span>
                    </div>
                </div>
            </div>
            <div class="col-md-12 border py-3">
                <div class="row">
                    <div class="col font-14 cursor-pointer">Receipt Notes (GRN/SRN)</div>
                    <div class="col-auto">
                        <span class="badge" style="padding:7px 20px"
                              ng-class="{'badge-light-grey':PO_Search.PO_DETAILS.GRN_STATUS_ID==75,'badge-light-blue':PO_Search.PO_DETAILS.GRN_STATUS_ID==76,'badge-success':PO_Search.PO_DETAILS.GRN_STATUS_ID==77}">{{PO_Search.PO_DETAILS.GRN_STATUS_NAME}}</span>
                        <button type="button" ng-click="GRN_POP(37)"
                                ng-show="PO_Search.PO_DETAILS.STATUS_ID!=73 && CheckSubModuleAccess(135)
                                || PO_Search.PO_DETAILS.STATUS_ID!=73 && CheckSubModuleAccess(134)
                                || PO_Search.PO_DETAILS.STATUS_ID!=73 && CheckSubModuleAccess(144)
                                || PO_Search.PO_DETAILS.STATUS_ID!=73 && PO_Search.PO_DETAILS.BUYER_ID==USER_ID"
                                class="btn btn-w-default">
                            Update
                        </button>
                    </div>
                </div>
                <div ng-show="GRN_LIST.length==0 && HIDE_SHOW">
                    <div class="col-md-12 text-center">
                        <h5 class="text-muted">
                            <span class="d-block mb-3">
                                <img src="../../../E_Content/images/sorted.png" />
                            </span>
                            Everything's sorted!
                        </h5>
                    </div>
                </div>
                <div class="row" ng-repeat="GL in GRN_LIST" ng-init="InitiateFilteList(GL);" ng-show="HIDE_SHOW">
                    <div class="col-md-12 border-bottom mt-3" ng-class="$fast"></div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label>Date</label>
                            <span class="d-block text-bold font-12">{{GL.CREATED_DATE | date}}</span>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label>Author</label>
                            <span class="d-block text-bold font-12">{{GL.USER_NAME}}</span>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label>Comment</label>
                            <span class="d-block text-bold font-12">{{GL.COMMENTS}}</span>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <label>Status</label>
                            <span class="d-block text-bold font-12">{{GL.STATUS_NAME}}</span>
                        </div>
                    </div>
                    <div class="col-md-12 mb-2">
                        <label>Attachments</label>
                        <div class="font-12" ng-show="GL.UploadedFiles.length==0">No Attachment</div>
                        <div class="row">
                            <div class=" col-md-3 " ng-repeat="FILE in GL.UploadedFiles">
                                <div class="file-block ">
                                    <div class="file-info">
                                        <i class="far fa-paperclip file-icon"></i>
                                        <span class="text-limit-1">
                                            <a href="../P2PFiles/{{FILE.FILE_PATH}}{{FILE.SERVER_FILE_NAME}}"
                                               download="{{FILE.ORIGINAL_FILE_NAME}}">{{FILE.ORIGINAL_FILE_NAME}}</a>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <div class="col-md-12 mt-3">
                <h5 class="card-title mt-2">Line Items</h5>
                <div class="row">
                    <div class="col-auto " ng-show="false">
                        <div class=" mb-2">
                            1  &nbsp;
                            {{PO_Search.PO_DETAILS.BASE_CURRENCY_CODE}}
                            =  {{PO_Search.PO_DETAILS.BASE_TO_PO_CONVERSION_RATE}}
                            {{PO_Search.PO_DETAILS.PO_CURRENCY_CODE}}
                        </div>
                    </div>
                    <div class="col-auto  ml-auto ">
                        <div class="form-inline mb-2">
                            <label class="mr-2">PO Currency:</label>
                            <span class="text-bold font-13">    {{PO_Search.PO_DETAILS.PO_CURRENCY_CODE}}</span>
                        </div>
                    </div>
                    <div class="col-auto">
                        <div class="form-inline mb-2">
                            <label class="mr-2">Amounts are</label>
                            <span class="text-bold font-13">{{PO_Search.PO_DETAILS.TAX_NAME}}</span>
                        </div>
                    </div>
                </div>
                <div class="table-responsive custom-scrollbar height-auto">
                    <table class="table table-head-fixed table-hover table-bordered">
                        <thead class="bg-wenodo-border">
                            <tr>
                                <th width="15%">Item </th>
                                <th width="25%">Description </th>
                                <th>Quantity </th>
                                <th>Unit Price </th>
                                <th>UOM </th>
                                <th>Disc %</th>
                                <th>GL Account </th>
                                <th>Tax Rate </th>
                                <th>Tax Amount</th>
                                <th class="text-right">Amount</th>
                                <th ng-repeat="TrackingCat in SELECTED_OPTION_LIST_MASTER  track by $index">{{TrackingCat.FIELD_NAME}}</th>
                            </tr>
                        </thead>
                        <tbody ng-repeat="PRL in PO_ITEM_LIST"
                               ng-init="InitiatePOItemList(PRL);"
                               on-finish-render="ngRepeatFinishedRender">
                            <tr>
                                <td>{{PRL.ITEM_NAME}} <span ng-show="false">{{PRL.LINE_NO=($index+1)}} {{PRL.ITEM_INDEX=($index)}}</span></td>
                                <td>
                                    {{PRL.DESCRIPTION==null || PRL.DESCRIPTION==''?'-': PRL.DESCRIPTION | limitTo:PRL.DESCRIPTION_LIMIT_TO}}
                                    <span ng-show="PRL.DESCRIPTION.length>PRL.DESCRIPTION_LIMIT_TO">...</span>
                                    <span class="btn btn-xs btn-transparent-wenodo" ng-show="PRL.DESCRIPTION.length>PRL.DESCRIPTION_LIMIT_TO" ng-click="READ_MORE_FY(PRL,1)" data-toggle="tooltip" data-html="true" data-original-title="Read More"><i class="far fa-plus"></i></span>
                                    <span class="btn btn-xs btn-transparent-wenodo" ng-show="PRL.DESCRIPTION_LIMIT_TO>DESCRIPTION_LIMIT_TO" ng-click="READ_MORE_FY(PRL,2)" data-toggle="tooltip" data-html="true" data-original-title="Hide"><i class="far fa-minus"></i></span>
                                </td>
                                <td>{{PRL.QUANTITY | number:2}}</td>
                                <td>{{PRL.UNIT_PRICE | number:2}}</td>
                                <td>{{PRL.UOM_NAME}}</td>
                                <td>{{PRL.DISCOUNT_PERCENT=="" || PRL.DISCOUNT_PERCENT==null?'-':PRL.DISCOUNT_PERCENT }}</td>
                                <td>{{PRL.ACCOUNT_DETAILS}}</td>
                                <td>{{PRL.TAX_RATE_DETAILS}}</td>
                                <td class="text-right">
                                    {{PRL.TAX_AMOUNT=PO_Search.PO_DETAILS.TAX_TYPE==3?0:(PO_Search.PO_DETAILS.TAX_TYPE==2?((((PRL.UNIT_PRICE*PRL.QUANTITY) / (1 + (PRL.TAX_RATE/100)))-(((PRL.UNIT_PRICE*PRL.QUANTITY) / (1 + (PRL.TAX_RATE/100)))*(PRL.DISCOUNT_PERCENT/100))) * (PRL.TAX_RATE/100)):(((PRL.UNIT_PRICE*PRL.QUANTITY)-((PRL.UNIT_PRICE*PRL.QUANTITY)*(PRL.DISCOUNT_PERCENT/100))) * (PRL.TAX_RATE/100))) | number:2}}
                                </td>
                                <td class="text-right text-nowrap pr-2">
                                    {{PRL.AMOUNT= ((PRL.QUANTITY * PRL.UNIT_PRICE) - (PRL.QUANTITY*1 * PRL.UNIT_PRICE*1 * (PRL.DISCOUNT_PERCENT)/100)) | number:2}}
                                    <span ng-show="false">{{PRL.TOTAL_SPLIT_AMOUNT= SETTING_USE_GROSS==1?(PRL.AMOUNT + (PO_Search.PO_DETAILS.TAX_TYPE==2?0:PRL.TAX_AMOUNT)):PO_Search.PO_DETAILS.TAX_TYPE==2? ((PRL.AMOUNT-PRL.TAX_AMOUNT)) :PRL.AMOUNT}}</span>

                                </td>
                                <td ng-repeat="TrackingCat in PRL.SELECTED_OPTION_LIST_MASTER track by $index"
                                    ng-init="InitiateXeroTrackingPOCategories(TrackingCat, $index,PRL,3);">
                                    {{TrackingCat.OPTION_NAME}}
                                </td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr class="text-bold table-footer-fixed">
                                <td colspan="9" class="text-right font-13">Sub Total</td>
                                <td class="text-right text-nowrap pr-2 font-13">
                                    {{(PO_ITEM_LIST | total: 'AMOUNT') | number:2}}
                                </td>
                                <td colspan="{{SELECTED_OPTION_LIST_MASTER.length}}" ng-if="SELECTED_OPTION_LIST_MASTER.length>0" class="text-right font-13"></td>
                            </tr>
                            <tr class="text-bold table-footer-fixed" ng-repeat="TAX in PO_ITEM_LIST | unique:'TAX_RATE_ID'" ng-if="TAX.TAX_RATE_ID!=null">
                                <td colspan="9" class="text-right font-13">
                                    {{TAX.TAX_RATE_DETAILS}}
                                </td>
                                <td class="text-right text-nowrap pr-2 font-13">
                                    {{PO_ITEM_LIST | filter:{TAX_RATE_ID:TAX.TAX_RATE_ID} | total:'TAX_AMOUNT' | number:2}}
                                </td>
                                <td colspan="{{SELECTED_OPTION_LIST_MASTER.length}}" ng-if="SELECTED_OPTION_LIST_MASTER.length>0" class="text-right font-13"></td>
                            </tr>
                            <tr class="text-bold table-footer-fixed">
                                <td colspan="9" class="text-right font-13">Total</td>
                                <td class="text-right text-nowrap pr-2 font-13">
                                    <span ng-show="false">
                                        {{(PO_ITEM_LIST | total:'TAX_AMOUNT') | number:2}}
                                    </span>
                                    <span ng-if="PO_Search.PO_DETAILS.TAX_TYPE==1">
                                        {{((PO_ITEM_LIST | total: 'AMOUNT') + (PO_ITEM_LIST | total: 'TAX_AMOUNT')) | number:2}}
                                    </span>
                                    <span ng-if="PO_Search.PO_DETAILS.TAX_TYPE==2">
                                        {{(PO_ITEM_LIST | total: 'AMOUNT')  | number:2}}
                                    </span>
                                    <span ng-if="PO_Search.PO_DETAILS.TAX_TYPE==3">
                                        {{(PO_ITEM_LIST | total: 'AMOUNT') | number:2}}
                                    </span>
                                    {{PO_Search.PO_DETAILS.PO_CURRENCY_CODE}}
                                </td>
                                <td colspan="{{SELECTED_OPTION_LIST_MASTER.length}}" ng-if="SELECTED_OPTION_LIST_MASTER.length>0" class="text-right font-13"></td>
                            </tr>
                        </tfoot>

                    </table>
                </div>
            </div>
            <div class="col-md-12">
                <div class="card-header w-100">
                    <h5 class="card-title mt-1 font-15"> Advance Amount</h5>
                </div>
                <div class="row mt-3">
                    <div class="col-md-3">
                        <div class="form-group">
                            <span class="d-block text-bold font-14"> {{PO_Search.PO_DETAILS.ADVANCE | number:2}}</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="card-header w-100">
                    <h5 class="card-title mt-1"> Actual Budget (This shows the current status of Budget) <span ng-show="P2P_PO_MASTER_LIST.length>0"> ({{PO_Search.BUDGET_NAME}})</span> </h5>
                    <button type="button"
                            ng-click="GET_P2P_BUDGET_SNAPSHOT(PO_Search.PO_DETAILS);PO_Search.PO_DETAILS.SHOW_REQ_BUDGET=!PO_Search.PO_DETAILS.SHOW_REQ_BUDGET;"
                            data-toggle="tooltip"
                            data-html="true"
                            data-original-title="View Requisition Budget"
                            class="btn btn-transparent-wenodo ml-2 border float-right">
                        View Requisition Budget
                    </button>
                </div>
                <div class="row">
                    <div class="col-auto">
                        <div class="table-responsive custom-scrollbar mt-2" style="max-height:100%">
                            <table class="table table-head-fixed table-hover table-form table-bordered "  ng-show="MONTH_LIST.length>0">
                                <thead>
                                    <tr>
                                        <th width="10%">GL Account</th>
                                        <th ng-repeat="PRL in CONDITIONAL_ITEM_LIST | unique:'ACCOUNT_ID' | orderBy:['ACCOUNT_ID']"
                                            colspan="{{(CONDITIONAL_ITEM_LIST |  filter:{ACCOUNT_ID:PRL.ACCOUNT_ID}:true).length}}">
                                            {{PRL.ACCOUNT_DETAILS}}
                                        </th>
                                    </tr>
                                    <tr class="bg-wenodo-border">
                                        <th width="10%">Item Name</th>
                                        <th data-toggle="tooltip" data-html="true" data-original-title="{{PRL.DESCRIPTION | limitTo:250}}"
                                            ng-repeat="PRL in CONDITIONAL_ITEM_LIST | orderBy: ['ACCOUNT_ID'] ">
                                            {{PRL.ITEM_NAME | limitTo:30}}
                                        </th>
                                    </tr>
                                    <tr class="bg-wenodo-border">
                                        <th width="10%">Line Amount</th>
                                        <th ng-repeat="PRL in CONDITIONAL_ITEM_LIST | orderBy: ['ACCOUNT_ID'] ">
                                            {{PRL.TOTAL_SPLIT_AMOUNT | number:2}}
                                        </th>
                                    </tr>
                                </thead>
                                <tbody ng-repeat="_m in MONTH_LIST">
                                    <tr>
                                        <td width="10%">{{_m.START_DATE | date}} <span ng-show="false"> {{_m.FLAG=($last?1:0)}}</span></td>
                                        <td ng-repeat="_prl in _m.ITEM_LIST | orderBy: ['ACCOUNT_ID']" ng-init="_m.FLAG==1?Inittotalreq(_prl,_m,$index):''">
                                            <span ng-show="false">{{_prl.START_DATE=_m.START_DATE}}</span>
                                            {{_prl.BUDGET}}
                                        </td>
                                    </tr>
                                    <tr ng-show="$last">
                                        <td class="text-bold">
                                            Allocated Amount
                                        </td>
                                        <td class="text-bold" ng-repeat="line in _m.ITEM_LIST | orderBy: ['ACCOUNT_ID']">
                                            {{line.TOTAL_BUDGET}}
                                        </td>
                                    </tr>
                                    <tr ng-show="$last">
                                        <td class="text-bold">Remaining Amount</td>
                                        <td ng-repeat="_prl in _m.ITEM_LIST | orderBy: ['ACCOUNT_ID']" class="text-bold" ng-class="{'text-red':(_prl.REMAINING_AMOUNT | number:2)!=0,'':(_prl.REMAINING_AMOUNT | number:2)==0}">
                                            {{(_prl.REMAINING_AMOUNT=(CONDITIONAL_ITEM_LIST | filter:{LINE_NO:_prl.LINE_NO}:true | total:'TOTAL_SPLIT_AMOUNT') -_prl.TOTAL_BUDGET) | number:2}}
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                        <div class="col-md-12 mt-2" ng-show="P2P_PO_MASTER_LIST.length>0">
                            <span class="po-amount">The following budgets would be affected by the approval of the request.</span>
                        </div>
                        <div class="col-md-12 text-center mt-2" ng-show="P2P_PO_MASTER_LIST.length==0" empty-grid> </div>
                        <div class="card-body p-0 mt-2" ng-show="P2P_PO_MASTER_LIST.length>0">
                            <div class="table-responsive custom-scrollbar">
                                <table class="table table-head-fixed table-hover">
                                    <thead class="bg-wenodo-border">
                                        <tr>
                                            <th>GL Account </th>
                                            <th>Period</th>
                                            <th class="text-right">Total</th>
                                            <th class="text-right">Remaining</th>
                                            <th class="text-right">Consumed</th>
                                            <th class="text-right">Booked</th>
                                            <th class="text-right">Credit Notes</th>

                                            <th class="text-right" ng-show="false">Current Amt.</th>
                                        </tr>
                                    </thead>
                                    <tbody ng-repeat="BD in P2P_PO_MASTER_LIST">
                                        <tr>
                                            <td rowspan="3">{{BD.GLACCOUNT_NAME}}</td>
                                            <td colspan="7" ng-if="BD.DB_ACCOUNT_ID==0" class="text-align-center text-bold">There is no budget allocated in this GL Account</td>
                                        </tr>
                                        <tr ng-if="BD.DB_ACCOUNT_ID!=0" ng-repeat="BL in BD.BUDGET_DETAILS_LIST"
                                            ng-init="BL.CURRENT_PO_CUSTOM=0;PO_Search.PO_DETAILS.SPLIT_TYPE>0?Fn_RETURN_CURRENT_AMT(BD,PO_Search.PO_DETAILS):''"
                                            ng-click="VIEW_BUDGET_fn(BD,PO_Search.PO_DETAILS.PO_DATE,PO_Search.PO_DETAILS.PROJECT_MASTER_ID,PO_Search,PO_Search,'PO_ACTION')">
                                            <td>{{BL.PERIOD}}</td>
                                            <td class="text-right">{{BL.TOTAL | number:2}}</td>
                                            <td class="text-right">
                                                <span ng-show="false">
                                                    {{BD.IS_OVER_BUDGET=(BL.REMAINING_AMOUNT<0 && BD.BUDGET_DETAILS_LIST.length==BL.LINE_ID?true:BD.IS_OVER_BUDGET?true:false)}}
                                                </span>
                                                <span ng-class="{'text-red text-bold':BL.REMAINING_AMOUNT<0}">
                                                    {{(BL.REMAINING_AMOUNT=((BL.TOTAL*1)-((BL.BOOKED*1) +(BL.CURRENT_PO_CUSTOM*1)+(BL.CONSUMED*1)+(BL.MEMO*1)))) | number:2}}
                                                </span>
                                            </td>
                                            <td class="text-right">{{BL.CONSUMED | number :2}}</td>
                                            <td class="text-right">{{BL.BOOKED   | number :2}}</td>
                                            <td class="text-right">
                                                <span ng-show="BL.MEMO==0">{{BL.MEMO*-1 | number :2}}</span><span ng-show="BL.MEMO!=0">({{BL.MEMO*-1 | number :2}})</span>
                                            </td>
                                            <td class="text-right" ng-show="false">
                                                <span ng-show="false">
                                                    {{BL.ITEM_TAX_AMOUNT=(PO_ITEM_LIST | filter:{ACCOUNT_ID:BD.ACCOUNT_ID} | total:'TAX_AMOUNT')}}
                                                    {{BL.ITEM_AMOUNT= (PO_ITEM_LIST | filter:{ACCOUNT_ID:BD.ACCOUNT_ID} | total:'AMOUNT') }}
                                                    {{BL.TAX_AMT_TOTAL= ((NAN_Fn(BL.ITEM_TAX_AMOUNT)?0:BL.ITEM_TAX_AMOUNT) + BL.ITEM_AMOUNT*1)}}
                                                </span>
                                                <span> {{PO_Search.PO_DETAILS.STATUS_ID==73 || true?BL.CURRENT_PO_CUSTOM=0:(PO_Search.PO_DETAILS.SPLIT_TYPE>0?BL.CURRENT_PO_CUSTOM=(( ACCOUNT_ITEMDETAIL | filter:{ACCOUNT_ID:BD.ACCOUNT_ID}) | total : 'BUDGET')/PO_Search.PO_DETAILS.BASE_TO_PO_CONVERSION_RATE:(SETTING_USE_GROSS==1?(BL.CURRENT_PO_CUSTOM=PO_Search.PO_DETAILS.TAX_TYPE==1 ?(BL.TAX_AMT_TOTAL/PO_Search.PO_DETAILS.BASE_TO_PO_CONVERSION_RATE):(BL.ITEM_AMOUNT/PO_Search.PO_DETAILS.BASE_TO_PO_CONVERSION_RATE)):BL.CURRENT_PO_CUSTOM=(BL.ITEM_AMOUNT-(PO_Search.PO_DETAILS.TAX_TYPE==1?0:BL.ITEM_TAX_AMOUNT))/PO_Search.PO_DETAILS.BASE_TO_PO_CONVERSION_RATE)) | number:2}}</span>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="alert alert-warning-red" ng-show="(P2P_PO_MASTER_LIST | filter:{IS_OVER_BUDGET:true}).length">
                        <strong>Warning!</strong> This requisition is going over budget.
                    </div>
                    <div class="col-md-12" ng-show="PO_Search.PO_DETAILS.SHOW_REQ_BUDGET">
                        <div class="card-header w-100">
                            <h5 class="card-title mt-1">
                                Requisition Budget (This shows the budget when the requisition was posted) <span ng-show="PO_Search.PO_DETAILS.P2P_SNAP_SHOT_MASTER_LIST.length>0"></span>
                            </h5>
                            <div class="card-tools">
                                <button type="button" class="btn btn-transparent-wenodo border" data-toggle="tooltip" data-html="true" data-original-title="Hide" ng-click="PO_Search.PO_DETAILS.SHOW_REQ_BUDGET=!PO_Search.PO_DETAILS.SHOW_REQ_BUDGET">
                                    <i class="fa fa-close"></i>
                                </button>
                            </div>
                        </div>
                        <div class="col-md-12 text-center mt-2" ng-show="PO_Search.PO_DETAILS.P2P_SNAP_SHOT_MASTER_LIST.length==0" empty-grid> </div>
                        <div class="card-body p-0 mt-2" ng-show="PO_Search.PO_DETAILS.P2P_SNAP_SHOT_MASTER_LIST.length>0">
                            <div class="table-responsive custom-scrollbar">
                                <table class="table table-head-fixed table-hover">
                                    <thead class="bg-wenodo-border">
                                        <tr>
                                            <th>GL Account </th>
                                            <th>Period</th>
                                            <th class="text-right">Total</th>
                                            <th class="text-right">Remaining</th>
                                            <th class="text-right">Consumed</th>
                                            <th class="text-right">Booked</th>
                                            <th class="text-right">Credit Notes</th>

                                            <th class="text-right">Amount</th>
                                        </tr>
                                    </thead>
                                    <tbody ng-repeat="BD in PO_Search.PO_DETAILS.P2P_SNAP_SHOT_MASTER_LIST | unique:'ACCOUNT_ID'">
                                        <tr><td rowspan="3">{{BD.ACCOUNT_DETAILS}}</td></tr>
                                        <tr ng-repeat="BL in PO_Search.PO_DETAILS.P2P_SNAP_SHOT_MASTER_LIST | filter:{ACCOUNT_ID:BD.ACCOUNT_ID}">
                                            <td>{{BL.PERIOD}}</td>
                                            <td class="text-right">{{BL.TOTAL | number:2}}</td>
                                            <td class="text-right">

                                                <span ng-class="{'text-red text-bold':BL.REMAINING_AMOUNT<0}">
                                                    {{(BL.REMAINING_AMOUNT=((BL.TOTAL*1)-((BL.BOOKED*1) +(BL.CURRENT*1)+(BL.CONSUMED*1)+(BL.MEMO*1)))) | number:2 }}
                                                </span>
                                            </td>
                                            <td class="text-right">{{BL.CONSUMED | number :2}}</td>
                                            <td class="text-right">{{BL.BOOKED  | number :2}}</td>

                                            <td class="text-right">
                                                <span ng-show="BL.MEMO==0">{{BL.MEMO*-1 | number :2}}</span><span ng-show="BL.MEMO!=0">({{BL.MEMO*-1 | number :2}})</span>
                                            </td>
                                            <td class="text-right">
                                                {{BL.CURRENT | number:2}}
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>



                    <div class="col-md-12 mt-3">
                        <h5 class="card-title w-100">Attachments</h5>
                        <div ng-show="PO_Search.PO_DETAILS.UploadedFiles.length==0">No attachment</div>
                        <div class="row" ng-show="PO_Search.PO_DETAILS.UploadedFiles!=null && PO_Search.PO_DETAILS.UploadedFiles.length>0">
                            <div class="col-md-3">
                                <div class="file-block" ng-repeat="FILE in PO_Search.PO_DETAILS.UploadedFiles">
                                    <div class="file-info">
                                        <i class="far fa-paperclip file-icon"></i>
                                        <span class="text-limit-1"> <a href="../P2PFiles/{{FILE.FILE_PATH}}{{FILE.SERVER_FILE_NAME}}" download="../{{FILE.FILE_PATH}}{{FILE.SERVER_FILE_NAME}}">  {{FILE.ORIGINAL_FILE_NAME}} </a></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 mt-3">
                        <h5 class="card-title w-100">Delivery Details</h5>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label>Address</label>
                                    <span class="d-block font-12">{{PO_Search.PO_DETAILS.DELIVERY_ADDRESS}}</span>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label>Attention To</label>
                                        <span class="d-block font-12">
                                            {{PO_Search.PO_DETAILS.ATTENTION == null || PO_Search.PO_DETAILS.ATTENTION==''?'-':PO_Search.PO_DETAILS.ATTENTION}}
                                        </span>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label>Phone</label>
                                        <span class="d-block font-12">{{PO_Search.PO_DETAILS.PHONE}}</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label>Delivery Instructions</label>
                                    <span class="d-block font-12">
                                        {{PO_Search.PO_DETAILS.DELIVERY_INSTRUCTIONS == null || PO_Search.PO_DETAILS.DELIVERY_INSTRUCTIONS==''?'-':PO_Search.PO_DETAILS.DELIVERY_INSTRUCTIONS | limitTo:REQ_PROC_Search.DELIVERY_INSTRUCTIONS_LIMIT_TO}}
                                    </span>
                                    <span ng-show="PO_Search.PO_DETAILS.DELIVERY_INSTRUCTIONS.length>REQ_PROC_Search.DELIVERY_INSTRUCTIONS_LIMIT_TO">...</span>
                                    <span class="btn btn-xs btn-transparent-wenodo"
                                          ng-show="PO_Search.PO_DETAILS.DELIVERY_INSTRUCTIONS.length>REQ_PROC_Search.DELIVERY_INSTRUCTIONS_LIMIT_TO"
                                          ng-click="READ_MORE_FY(PO_Search.PO_DETAILS,1,'DELIVERY_INSTRUCTIONS')"
                                          data-toggle="tooltip" data-html="true"
                                          data-original-title="Read More"><i class="far fa-plus"></i></span>
                                    <span class="btn btn-xs btn-transparent-wenodo"
                                          ng-show="PO_Search.PO_DETAILS.DELIVERY_INSTRUCTIONS.length==REQ_PROC_Search.DELIVERY_INSTRUCTIONS_LIMIT_TO"
                                          ng-click="READ_MORE_FY(PO_Search.PO_DETAILS,2,'DELIVERY_INSTRUCTIONS')"
                                          data-toggle="tooltip" data-html="true"
                                          data-original-title="Hide"><i class="far fa-minus"></i></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <h5 class="text-dark-blue text-bold font-13 mb-0">Note for Approvers</h5>
                        <span class="font-12">
                            {{PO_Search.PO_DETAILS.NOTE_FOR_APPROVERS == null || PO_Search.PO_DETAILS.NOTE_FOR_APPROVERS==''?'-':PO_Search.PO_DETAILS.NOTE_FOR_APPROVERS | limitTo:PO_Search.NOTE_FOR_APPROVERS_LIMIT_TO}}
                            <span ng-show="PO_Search.PO_DETAILS.NOTE_FOR_APPROVERS.length>PO_Search.NOTE_FOR_APPROVERS_LIMIT_TO">...</span>
                            <span class="btn btn-xs btn-wenodo d-inline-flex"
                                  ng-show="PO_Search.PO_DETAILS.NOTE_FOR_APPROVERS.length>PO_Search.NOTE_FOR_APPROVERS_LIMIT_TO"
                                  ng-click="READ_MORE_ACTION_FY(PO_Search.PO_DETAILS,1,'NOT_FOR_APPROVER','ACTION')"
                                  data-toggle="tooltip" data-html="true"
                                  data-original-title="Read More">
                                <i class="far fa-plus"></i>
                            </span>
                            <span class="btn btn-xs btn-wenodo d-inline-flex"
                                  ng-show="PO_Search.PO_DETAILS.NOTE_FOR_APPROVERS.length==PO_Search.NOTE_FOR_APPROVERS_LIMIT_TO"
                                  ng-click="READ_MORE_ACTION_FY(PO_Search.PO_DETAILS,2,'NOT_FOR_APPROVER','ACTION')"
                                  data-toggle="tooltip" data-html="true"
                                  data-original-title="Hide"><i class="far fa-minus"></i></span>
                        </span>
                    </div>
                    <div class="col-md-12 mt-3" ng-show="PO_TERMS_AND_CONDITIONS_MASTER_LIST.length>0">
                        <h5 class="text-dark-blue text-bold font-13 mb-0">Terms & Conditions</h5>
                        <ul class="products-list product-list-in-card pl-2 pr-2">
                            <li class="item" ng-repeat="PRL in PO_TERMS_AND_CONDITIONS_MASTER_LIST">
                                <span class="terms"><span class="text-bold">{{$index+1}}.</span> {{PRL.TEXT}}</span>
                            </li>
                        </ul>
                    </div>

                    <div class="col-md-12 mt-3">
                        <div class="card-header w-100">
                            <h5 class="card-title mt-1">
                                Linked Invoice(s)
                            </h5>
                        </div>
                        <div class="col-md-12 text-center mt-2" ng-show="INVOICE_PO_MAPPING.length==0" empty-grid> </div>
                        <div class="card-body p-0 mt-2" ng-show="INVOICE_PO_MAPPING.length>0">
                            <div class="table-responsive custom-scrollbar">
                                <table class="table table-head-fixed table-hover">
                                    <thead class="bg-wenodo-border">
                                        <tr>
                                            <td colspan="2" class="text-center text-bold bg-light-green">Invoice</td>
                                            <td colspan="4" class="text-center text-bold bg-light-blue">PO Mapped Details</td>
                                        </tr>
                                        <tr>
                                            <th>Invoice Number </th>
                                            <th>Due Date </th>
                                            <th>Amount + Tax </th>

                                        </tr>
                                    </thead>
                                    <tbody ng-repeat="IN in INVOICE_PO_MAPPING | unique: 'INVOICE_HEADER_ID'">
                                        <tr>
                                            <td><a href="#!/Bill_View?INV={{IN.INVOICE_HEADER_ID}}">{{IN.INVOICE_NUMBER}}</a></td>
                                            <td>{{IN.DUE_DATE | date}}</td>
                                            <td>
                                                {{(INVOICE_PO_MAPPING | filter:{INVOICE_HEADER_ID:IN.INVOICE_HEADER_ID} | total:'MAPPED_AMOUNT') | number: 2}}
                                            </td>
                                        </tr>
                                    </tbody>
                                    <tfoot>
                                        <tr>
                                            <td></td>
                                            <td>Total</td>
                                            <td>{{(INVOICE_PO_MAPPING  | total:'MAPPED_AMOUNT') | number: 2}}</td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>

                    </div>

                </div>

            </div>
</div>
<div class="modal fade show" id="RECEIVING">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Update {{PO_Search.PO_DETAILS.PO_NUMBER}}</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body custom-scrollbar">
                <ul class="nav nav-tabs mt-0" id="custom-content-below-tab" role="tablist">
                    <li class="nav-item" ng-click="TAB_CLICK_RECEIVING_FY(1)">
                        <a class="nav-link " ng-class="{'active':TAB_REC_FLAG==1}" data-toggle="pill" role="tab" aria-controls="custom-content-below-home" aria-selected="true">Receiving</a>
                    </li>
                    <li class="nav-item" ng-click="TAB_CLICK_RECEIVING_FY(2)">
                        <a class="nav-link " ng-class="{'active':TAB_REC_FLAG==2}" data-toggle="pill" role="tab" aria-controls="custom-content-below-home" aria-selected="true">Unreceiving</a>
                    </li>
                    <li class="nav-item" ng-click="TAB_CLICK_RECEIVING_FY(3)">
                        <a class="nav-link " ng-class="{'active':TAB_REC_FLAG==3}" data-toggle="pill" role="tab" aria-controls="custom-content-below-home" aria-selected="true">History</a>
                    </li>
                </ul>
                <div class="tab-content" id="custom-content-below-tabContent">
                    <div class="tab-pane fade " ng-class="{'show active':TAB_REC_FLAG==1}" id="custom-content-below-home" role="tabpanel" aria-labelledby="custom-content-below-home-tab">
                        <div class="table-responsive custom-scrollbar height-auto">
                            <div class="text-center" ng-show="PO_LINES_FOR_RECEIVING.length==0" empty-grid> </div>
                            <form id="RECEIVING_FORM" name="RECEIVING_FORM" novalidate>
                                <table class="table table-head-fixed table-hover table-bordered v-align-top" ng-show="PO_LINES_FOR_RECEIVING.length>0">
                                    <thead class="bg-wenodo-border">
                                        <tr>
                                            <th>Line# </th>
                                            <th width="10%">Item </th>
                                            <th width="10%">Quantity </th>
                                            <th width="10%">Amount + Tax</th>
                                            <th>Receiving</th>
                                            <th>Receiving Date</th>
                                            <th>Reference No</th>
                                            <th width="10%">Attachment</th>
                                            <th>Comments</th>
                                        </tr>
                                    </thead>
                                    <tbody ng-repeat="PRL in PO_LINES_FOR_RECEIVING" ng-init="InitiateReceivingList(PRL);">
                                        <tr>
                                            <td>{{PRL.LINE_NO}}</td>
                                            <td> <span ng-show="false">{{PRL.LINE_NO=($index+1)}}</span>{{PRL.ITEM_NAME}}</td>

                                            <td lass="text-right">
                                                <span ng-show="PRL.RECEIVING_TYPE_ID==1">
                                                    {{PRL.QUANTITY | number :2}}
                                                    <br />
                                                    <span ng-show="PRL.RECEIVED_QTY>0">Received:- {{PRL.RECEIVED_QTY | number :2}}</span>
                                                </span>
                                                <span ng-show="PRL.RECEIVING_TYPE_ID==2">-</span>
                                            </td>
                                            <td>
                                                <span ng-show="PRL.RECEIVING_TYPE_ID==2">
                                                    {{PRL.AMOUNT | number :2}}
                                                    <br />
                                                    <span ng-show="PRL.RECEIVED_AMOUNT>0">Received:- {{PRL.RECEIVED_AMOUNT | number :2}}</span>
                                                </span>
                                                <span ng-show="PRL.RECEIVING_TYPE_ID==1">-</span>
                                            </td>
                                            <td>
                                                <span ng-show="PRL.RECEIVING_TYPE_ID==1">
                                                    <input type="text"
                                                           maxlength="13"
                                                           ng-required="PRL.RECEIVING_TYPE_ID==1"
                                                           name="CUSTOM_OPEN_QTY{{$index}}"
                                                           only-digits
                                                           ng-model="PRL.CUSTOM_OPEN_QTY"
                                                           class="form-control"
                                                           ng-class="{'error':RECEIVING_FORM.submitted && RECEIVING_FORM.CUSTOM_OPEN_QTY{{$index}}.$error.required}" />
                                                    <span ng-show="PRL.REMA_QTY>=0"> Remaining Qty.= {{PRL.REMA_QTY =(PRL.OPEN_QTY - PRL.CUSTOM_OPEN_QTY) | number :2 }}</span>
                                                    <span ng-show="PRL.REMA_QTY<0">Exceed you limit {{PRL.REMA_QTY*-1}} </span>

                                                </span>
                                                <span ng-show="PRL.RECEIVING_TYPE_ID==2">
                                                    <input type="text"
                                                           ng-required="PRL.RECEIVING_TYPE_ID==2"
                                                           maxlength="13"
                                                           name="CUSTOM_OPEN_AMOUNT{{$index}}"
                                                           ng-model="PRL.CUSTOM_OPEN_AMOUNT"
                                                           only-digits
                                                           class="form-control"
                                                           ng-class="{'error':RECEIVING_FORM.submitted && RECEIVING_FORM.CUSTOM_OPEN_AMOUNT{{$index}}.$error.required}" />
                                                    <span ng-show="PRL.REMA_AMOUNT>=0"> Remaining Amt.= {{PRL.REMA_AMOUNT =(PRL.OPEN_AMOUNT - PRL.CUSTOM_OPEN_AMOUNT) | number :2 }}</span>
                                                    <span ng-show="PRL.REMA_AMOUNT<0">Exceed you limit {{PRL.REMA_AMOUNT*-1}} </span>
                                                </span>
                                            </td>
                                            <td ng-init="$parent.DateInputLoad()">
                                                <input type="text"
                                                       name="RECEIVING_DATE{{$index}}"
                                                       readonly
                                                       required
                                                       ng-model="PRL.RECEIVING_DATE"
                                                       class="form-control dateinput date-icon"
                                                       ng-class="{'error':RECEIVING_FORM.submitted && RECEIVING_FORM.RECEIVING_DATE{{$index}}.$error.required}" />
                                            </td>
                                            <td>
                                                <input type="text"
                                                       name="RECEIPT_NO"
                                                       ng-model="PRL.RECEIPT_NO"
                                                       class="form-control" />
                                            </td>
                                            <td>
                                                <div class="input-group-prepend">
                                                    <label for="Rec{{$index}}" class="btn btn-wenodo text-nowrap">
                                                        <i class="fal fa-upload"></i>
                                                    </label>
                                                    <span class="hidden-input">
                                                        <input id="Rec{{$index}}"
                                                               name="file"
                                                               type="file"
                                                               ng-model="PRL.UploadedFiles"
                                                               ng-files="getTheFilesToUpload($files,'Rec'+{{$index}},5,PRL,34,1,'RECEIVING' ,3,'P2P_Upload_Path','P2P',PRL.PO_LINE_ID)">
                                                    </span>
                                                </div>
                                                <div class="col-md-12" ng-repeat="file in PRL.UploadedFiles" style="max-width:250px">
                                                    <div class="file-block">
                                                        <div class="file-info">
                                                            <i class="far fa-file-alt file-icon"></i>
                                                            <span class="text-limit-1">
                                                                <a href="/P2PFiles/{{file.FILE_PATH}}{{file.SERVER_FILE_NAME}}" download="{{file.SERVER_FILE_NAME}}">
                                                                    <span class="text-limit-1">{{file.ORIGINAL_FILE_NAME}} </span>
                                                                </a>
                                                            </span>
                                                        </div>
                                                        <span class="remove-file-icon c-pointer" ng-click="REMOVE_FILTE_REC(PRL,file,$index)"><i class="fa fa-times"></i></span>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <textarea rows="5"
                                                          maxlength="500"
                                                          ng-model="PRL.COMMENTS"
                                                          class="form-control" />
                                            </td>
                                        </tr>
                                    </tbody>

                                </table>
                            </form>
                        </div>
                    </div>
                    <div class="tab-pane fade " ng-class="{'show active':TAB_REC_FLAG==2}" id="custom-content-below-home" role="tabpanel" aria-labelledby="custom-content-below-home-tab">
                        <div class="table-responsive custom-scrollbar height-auto">
                            <div class="text-center" ng-show="PO_LINES_FOR_UNRECEIVING.length==0" empty-grid> </div>
                            <form id="UNRECEIVING_FORM" name="UNRECEIVING_FORM" novalidate>
                                <table class="table table-head-fixed table-hover table-bordered v-align-top" ng-show="PO_LINES_FOR_UNRECEIVING.length>0">
                                    <thead class="bg-wenodo-border">
                                        <tr>
                                            <th>Line# </th>
                                            <th width="10%">Item </th>
                                            <th width="15%">Quantity</th>
                                            <th width="15%">Amount + Tax</th>
                                            <th>Unreceiving</th>
                                            <th>Receiving Date</th>
                                            <th>Reference No</th>
                                            <th>Attachment</th>
                                            <th>Comments</th>
                                        </tr>
                                    </thead>
                                    <tbody ng-repeat="PRL in PO_LINES_FOR_UNRECEIVING" ng-init="InitiateUNReceivingList(PRL);">
                                        <tr>
                                            <td>{{PRL.LINE_NO}}</td>
                                            <td> <span ng-show="false">{{PRL.LINE_NO=($index+1)}}</span>{{PRL.ITEM_NAME}}</td>

                                            <td>
                                                <span ng-show="PRL.RECEIVING_TYPE_ID==1">{{PRL.QUANTITY | number :2}}</span>
                                                <span ng-show="PRL.RECEIVING_TYPE_ID==2">-</span>
                                                <br />
                                                <span ng-show="PRL.RECEIVED_QTY>0 || PRL.RECEIVED_QTY<0"> Received Qty:-{{PRL.RECEIVED_QTY | number :2}} </span>
                                                <br />
                                                <span ng-show="PRL.UNRECEIVED_QTY<0 || PRL.UNRECEIVED_QTY>0">Unreceived Qty:-</span> {{PRL.UNRECEIVED_QTY | number :2}}
                                            </td>
                                            <td>
                                                <span ng-show="PRL.RECEIVING_TYPE_ID==2">{{PRL.AMOUNT | number :2}}<br /></span>
                                                <span ng-show="PRL.RECEIVING_TYPE_ID==1">-</span><br />
                                                <span ng-show="PRL.RECEIVED_AMOUNT<0 || PRL.RECEIVED_AMOUNT>0"> Received Amt:-{{PRL.RECEIVED_AMOUNT | number :2}} </span>
                                                <br />
                                                <span ng-show="PRL.UNRECEIVED_AMOUNT<0  || PRL.UNRECEIVED_AMOUNT>0">Unreceived Amt:-{{PRL.UNRECEIVED_AMOUNT | number :2}}</span>
                                            </td>
                                            <td>
                                                <span ng-show="PRL.RECEIVING_TYPE_ID==1">
                                                    <input type="text"
                                                           maxlength="13"
                                                           ng-required="PRL.RECEIVING_TYPE_ID==1"
                                                           name="CUSTOM_OPEN_AMOUNT_1{{$index}}"
                                                           ng-change="CHANGE_FLAG_FY(PRL)"
                                                           ng-model="PRL.CUSTOM_UR_OPEN_QTY"
                                                           only-plus-minus
                                                           class="form-control"
                                                           ng-class="{'error':UNRECEIVING_FORM.submitted && UNRECEIVING_FORM.CUSTOM_OPEN_AMOUNT_1{{$index}}.$error.required}" />
                                                </span>
                                                <span ng-show="PRL.RECEIVING_TYPE_ID==2">
                                                    <input type="text"
                                                           maxlength="13"
                                                           ng-required="PRL.RECEIVING_TYPE_ID==2"
                                                           name="CUSTOM_OPEN_AMOUNT{{$index}}"
                                                           ng-model="PRL.CUSTOM_UR_OPEN_AMOUNT"
                                                           only-plus-minus
                                                           ng-change="CHANGE_FLAG_FY(PRL)"
                                                           class="form-control"
                                                           ng-class="{'error':UNRECEIVING_FORM.submitted && UNRECEIVING_FORM.CUSTOM_OPEN_AMOUNT{{$index}}.$error.required}" />
                                                </span>
                                            </td>
                                            <td>{{PRL.RECEIVING_DATE | date}}</td>
                                            <td>{{PRL.RECEIPT_NO==null?'-':PRL.RECEIPT_NO}}</td>
                                            <td>
                                                <div class="input-group-prepend">
                                                    <label for="UnRec{{$index}}" class="btn btn-wenodo text-nowrap">
                                                        <i class="fal fa-upload"></i>
                                                    </label>
                                                    <span class="hidden-input">
                                                        <input id="UnRec{{$index}}"
                                                               name="file"
                                                               type="file"
                                                               ng-model="PRL.UploadedFiles"
                                                               ng-files="getTheFilesToUpload($files,'UnRec'+{{$index}},5,PRL,34,1,'RECEIVING' ,3,'P2P_Upload_Path','P2P',PRL.RECEIPT_ID)">
                                                    </span>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-12" ng-repeat="file in PRL.UploadedFiles" style="max-width:250px">
                                                        <div class="file-block">
                                                            <div class="file-info">
                                                                <i class="far fa-file-alt file-icon"></i>
                                                                <span class="text-limit-1">
                                                                    <a href="/P2PFiles/{{file.FILE_PATH}}{{file.SERVER_FILE_NAME}}" download="{{file.SERVER_FILE_NAME}}">
                                                                        <span class="text-limit-1">{{file.ORIGINAL_FILE_NAME}} </span>
                                                                    </a>
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12" ng-repeat="file in PRL.UploadedFiles1" style="max-width:250px">
                                                        <div class="file-block">
                                                            <div class="file-info">
                                                                <i class="far fa-file-alt file-icon"></i>
                                                                <span class="text-limit-1">
                                                                    <a href="/P2PFiles/{{file.FILE_PATH}}{{file.SERVER_FILE_NAME}}" download="{{file.SERVER_FILE_NAME}}">
                                                                        <span class="text-limit-1">{{file.ORIGINAL_FILE_NAME}} </span>
                                                                    </a>
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <textarea rows="5"
                                                          maxlength="500"
                                                          ng-model="PRL.COMMENTS"
                                                          class="form-control" />
                                            </td>
                                        </tr>
                                    </tbody>

                                </table>
                            </form>
                        </div>
                    </div>
                    <div class="tab-pane fade " ng-class="{'show active':TAB_REC_FLAG==3}" id="custom-content-below-home" role="tabpanel" aria-labelledby="custom-content-below-home-tab">
                        <div class="table-responsive custom-scrollbar height-auto">
                            <div class="text-center" ng-show="RECEIVING_LIST.length==0" empty-grid> </div>
                            <table class="table table-head-fixed table-hover table-bordered" ng-show="RECEIVING_LIST.length>0">
                                <thead class="bg-wenodo-border">
                                    <tr>
                                        <th>Line# </th>
                                        <th width="10%">Receiver Name </th>
                                        <th>Qty </th>
                                        <th>Amt.</th>
                                        <th>Status</th>
                                        <th>Date</th>
                                        <th>Reference No</th>
                                        <th>Attachment</th>
                                        <th>Comments</th>
                                    </tr>
                                </thead>
                                <tbody ng-repeat="PRL in RECEIVING_LIST" ng-init="InitiateHistoryReceivingList(PRL);">
                                    <tr>
                                        <td>{{PRL.LINE_NO}}</td>
                                        <td>{{PRL.RECEIVER_NAME}}</td>
                                        <td>{{PRL.RECEIVED_QTY | number :2}}</td>
                                        <td>{{PRL.RECEIVED_AMOUNT | number :2}}</td>
                                        <td>
                                            <span ng-if="PRL.RECEIVING_TYPE_ID==1"> {{PRL.RECEIVED_QTY<0?'Un-Received':''}}</span>
                                            <span ng-if="PRL.RECEIVING_TYPE_ID==1"> {{PRL.RECEIVED_QTY>=0?'Received':''}}</span>
                                            <span ng-if="PRL.RECEIVING_TYPE_ID==2"> {{PRL.RECEIVED_AMOUNT<0 && PRL.RECEIVED_AMOUNT<0 ?'Un-Received':''}}</span>
                                            <span ng-if="PRL.RECEIVING_TYPE_ID==2"> {{PRL.RECEIVED_AMOUNT>=0?'Received':''}}</span>
                                        </td>
                                        <td>{{PRL.RECEIVING_DATE | date}} {{PRL.RECEIVING_DATE | date:'HH:MM'}} </td>
                                        <td>{{PRL.RECEIPT_NO}}</td>
                                        <td>
                                            <span ng-show="PRL.UploadedFiles==null && PRL.UploadedFiles.length==0"> No Attachment</span>
                                            <div class="col-md-12" ng-repeat="file in PRL.UploadedFiles" style="max-width:250px">
                                                <div class="file-block">
                                                    <div class="file-info">
                                                        <i class="far fa-file-alt file-icon"></i>
                                                        <span class="text-limit-1">
                                                            <a href="/P2PFiles/{{file.FILE_PATH}}{{file.SERVER_FILE_NAME}}" download="{{file.SERVER_FILE_NAME}}">
                                                                <span class="text-limit-1">{{file.ORIGINAL_FILE_NAME}} </span>
                                                            </a>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                        <td>{{PRL.COMMENTS}}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" ng-show="TAB_REC_FLAG!=3">
                <button type="button" ng-show="CheckSubModuleAccess(134) || CheckSubModuleAccess(135)" ng-click="INS_GRN()" class="btn btn-wenodo">Update</button>
                <button type="button" ng-click="RESET_GRN()" ng-show="TAB_REC_FLAG==1" class="btn btn-w-default">Reset</button>
                <button type="button" class="btn btn-w-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade show" id="GRN">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Good Received Notes</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body custom-scrollbar">
                <form id="GRN_FORM" name="GRN_FORM" novalidate>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Status <span class="text-danger">*</span> </label>
                                <select class="custom-select"
                                        name="STATUS_ID"
                                        ng-model="PO_Search.STATUS_ID"
                                        ng-options="T.ID as T.NAME for T in STATUS_NAME"
                                        required
                                        ng-class="{'error':GRN_FORM.submitted && GRN_FORM.STATUS_ID.$error.required}">
                                    <option value="">Select Status</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Comment</label>
                                <textarea class="form-control" rows="3"
                                          maxlength="500"
                                          ng-model="PO_Search.COMMENTS" />
                                <span class="d-block text-grey text-xs semibold mb-2">{{500 - PO_Search.COMMENTS.length}} Character Remaining </span>

                            </div>
                        </div>
                        <div class="col-md-12 mt-3">
                            <!--<h5 class="card-title text-center w-100 mb-2">Attachments</h5>-->
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="upload-files-container">
                                        <div class="drag-file-area mx-100 w-100">
                                            <label class="label align-center">
                                                <span class="browse-files">
                                                    <input type="file"
                                                           class="default-file-input pos-absolute"
                                                           id="PO_GRN"
                                                           name="PO_GRN"
                                                           ng-model="PO_Search.UploadedFiles"
                                                           ng-files="getTheFilesToUpload($files,'PO_GRN',5,PO_Search,34,'1','PO_GRN',3,'P2P_Upload_Path','P2P')" />
                                                    <span class="browse-files-text"><i class="far fa-upload"></i> Add an Attachment</span>
                                                </span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="file-block" ng-repeat="file in PO_Search.UploadedFiles">
                                        <div class="file-info">
                                            <i class="far fa-file-alt file-icon"></i>
                                            <span class="text-limit-1">
                                                <a href="/P2PFiles/{{file.FILE_PATH}}{{file.SERVER_FILE_NAME}}" download="{{file.SERVER_FILE_NAME}}">
                                                    <span class="text-limit-1">{{file.ORIGINAL_FILE_NAME}} </span>
                                                </a>
                                            </span>
                                        </div>
                                        <span class="remove-file-icon cursor-pointer" ng-click="REMOVE_FILTE_GRN($index)"><i class="fa fa-times"></i></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 mt-1">
                            <div data-ng-show="GRN_FORM.submitted && GRN_FORM.$invalid" class="form-group has-error errormessage badge badge-light-red w-100 p-3">
                                <span class="help-block errormessageline" style="padding-left:0px;"><i class="fa fa-exclamation-triangle"></i> - Please provide the mandatory details to submit(marked in red).</span>
                            </div>
                            <div id="divInvlidUser" class="hideshowdiv" data-ng-show="GRN_FORM.$valid"><span class="help-block">{{InvalidUser}}</span></div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" ng-show="CheckSubModuleAccess(134) || CheckSubModuleAccess(135)" ng-click="INS_GRN()" class="btn btn-wenodo">Update</button>
                <button type="button" ng-click="RESET_GRN()" class="btn btn-w-default">Reset</button>
                <button type="button" class="btn btn-w-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade show" id="POP_DISCARD_PO">
    <form id="DISCARD_PO_FORM" name="DISCARD_PO_FORM" novalidate>
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">{{REQ_PROC_Search.REQ_DETAILS.PR_NUMBER}} Comments</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body custom-scrollbar">
                    <textarea ng-model="PO_Search.PO_DETAILS.DISCARD_PO_COMMENTS"
                              class="form-control"
                              maxlength="2000"
                              name="DISCARD_PO_COMMENTS"
                              required
                              ng-class="{'error':DISCARD_PO_FORM.submitted && DISCARD_PO_FORM.DISCARD_PO_COMMENTS.$error.required}"
                              rows="5" />
                    <span class="d-block text-grey text-xs semibold mb-2">{{2000 - PO_Search.PO_DETAILS.DISCARD_PO_COMMENTS.length}} Character Remaining </span>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-wenodo" ng-click="DISCARD_PO()">Submit</button>
                    <button type="button" class="btn btn-w-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </form>
</div>
<div id="PO_PDF"  class="filter-panel sidenav"  style="width:0px;z-index:1500">
    <div class="card-header">
        <h5 class="card-title mt-1">Filters</h5>
        <div class="card-tools ml-auto">
            <button class="btn btn-tool py-0" ng-click="CLOSE_PDF()">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>
    <div class="card-body">
        <div class="row">
            <pdf-viewer delegate-handle="my-pdf-container"
                        url="pdfUrl"
                        scale="1"
                        show-toolbar="true"
                        headers="{ 'x-you-know-whats-awesome': 'EVERYTHING' }" class="pdf_layout"></pdf-viewer>

        </div>
    </div>
    <div class="modal-footer sidenav-footer-fixed">
        <button type="button" class="btn btn-wenodo" ng-click="CLOSE_PDF()">Close</button>
    </div>
</div>
