<form name="EDIT_REQ_FORM" id="EDIT_REQ_FORM" novalidate>
    <div class="row">
        <div class="col-md-12 my-4">
            <div class="card-header w-100">
                <h5 class="card-title w-100 mt-3 font-15">Quotation(s)</h5>
                <div class="float-right">
                    <button ng-click="POP_EDIT_SUPPLIER_Fn('EDIT_REQ')"
                            class="btn btn-transparent-wenodo border py-0 ml-2 "
                            data-toggle="tooltip"
                            data-html="true"
                            data-original-title="Add new contact">
                        Add new contact  <i class="far fa-plus"></i>
                    </button>
                    <button ng-show="!IntegrationDetails.PageLoad && IntegrationDetails.ShowSyncBtn"
                            ng-click="CLICK_SUPPLIER_XERO_SYNC_Fn('EDIT_REQ')"
                            class="btn btn-transparent-wenodo border py-0" data-toggle="tooltip"
                            data-html="true"
                            data-original-title="Sync Xero Contact">
                        Sync Xero Contact <i class="far fa-sync-alt"></i>
                    </button>
                    <a ng-show="!IntegrationDetails.PageLoad && !IntegrationDetails.ShowSyncBtn"><i class="fas fa-sync fa-spin"></i> Syncing Xero Contact</a>
                </div>

            </div>
            <div class="table-responsive" style="overflow-x:visible">
                <table class="table table-hover table-form table-bordered">
                    <thead class="bg-wenodo-border">
                        <tr>
                            <th>


                            </th>
                            <th>Contact Name <span class="text-danger">*</span></th>
                            <th width="15%">Amount <span class="text-danger">*</span></th>
                            <th width="5%">Rank</th>
                            <th width="25%">Comments</th>
                            <th width="10%" class="text-center">Attachment <span class="text-danger">*</span></th>
                            <th width="3%" class="text-center">Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="QL in EDIT_QUOTATION_LIST track by $index"
                            ng-init="InitiateEditQuotation(QL,$last,1,$index)">
                            <td class="text-center">
                              
                                <div class="custom-control custom-radio">
                                    <input class="custom-control-input"
                                           type="radio"
                                           name="QuotationEditRadio"
                                           ng-model="$parent.selectedEditsupplier"
                                           ng-value="{{QL.INDEX_VALUE}}"
                                           ng-change="CHANGE_CONTACT_NAME_EDIT_Fn(QL,'',1,$index)"
                                           id="QuotationEditRadio{{$index}}">
                                    <label for="QuotationEditRadio{{$index}}" class="custom-control-label"></label>
                                </div>

                            </td>
                            <td>

                                <div class="AddCustomScroll_Contact">
                                    <input type="text" name="SUPPLIER_NAME_BOX{{$index}}"
                                           ng-model="QL.CONTACT_NAME"
                                           ng-blur="SetQuotationValues(QL,$index)"
                                           typeahead-on-select="SetQuotationValues(QL,$index)"
                                           ng-change="SetQValues(QL,$index)"
                                           uib-typeahead="Supplier.SUPPLIER_NAME for Supplier in EDIT_SUPPLIER_LIST | filter:$viewValue"
                                           typeahead-loading="loading" typeahead-no-results="noResults"
                                           class="hidden-input" autocomplete="off"
                                           placeholder="Type to select Supplier Name..."
                                           required
                                           ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.SUPPLIER_NAME_BOX{{$index}}.$error.required || QL.INVALID}" />
                                </div>
                                <div ng-show="QL.INVALID">Please select valid contact Name</div>
                            </td>
                            <td>
                                <input type="text"
                                       class="hidden-input"
                                       name="AMOUNT{{$index}}"
                                       only-digits
                                       ng-change="ChangeQAmt(QL,1)"
                                       ng-required="QL.CONTACT_NAME.length>0"
                                       ng-disabled="QL.CONTACT_NAME.length==0 || QL.CONTACT_NAME==null"
                                       placeholder="Enter Amount"
                                       maxlength="13"
                                       ng-model="QL.TOTAL_AMOUNT"
                                       ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.AMOUNT{{$index}}.$error.required}" />
                            </td>
                            <td> {{QL.RANK==null?'-':QL.RANK}} </td>
                            <td>
                                <textarea class="hidden-input"
                                          name="COMMENTS{{$index}}"
                                          ng-disabled="QL.CONTACT_NAME.length==0 || QL.CONTACT_NAME==null"
                                          maxlength="500"
                                          onInput="this.parentNode.dataset.replicatedValue = this.value"
                                          placeholder="Enter comment"
                                          ng-model="QL.COMMENTS"></textarea>

                                <span class="d-block text-grey text-xs semibold mb-2">{{500 - QL.COMMENTS.length}} Character Remaining </span>
                            </td>
                            <td class="text-center" ng-class="{'error':EDIT_REQ_FORM.submitted && QL.IS_QUOTATION_REQUIRED && (QL.UploadedFiles==null || QL.UploadedFiles.length==0)}">
                                <div class="col-md-12" ng-repeat="file in QL.UploadedFiles">
                                    <div class="file-block">
                                        <div class="file-info">
                                            <i class="far fa-file-alt file-icon"></i>
                                            <a href="/P2PFiles/{{file.FILE_PATH}}{{file.SERVER_FILE_NAME}}"
                                               download="{{file.ORIGINAL_FILE_NAME}}">
                                                <span class="text-limit-1 font-10">{{file.ORIGINAL_FILE_NAME}} </span>
                                            </a>
                                            <span  class="remove-file-icon" ng-click="REMOVE_FILE_QUOTATION_EDIT($index,file,QL.UploadedFiles,'QUOTAT_EDIT')"><i class="fa fa-times"></i></span>
                                        </div>
                                    </div>
                                </div>
                                <div ng-show="QL.IS_QUOTATION_REQUIRED && (QL.UploadedFiles==null || QL.UploadedFiles.length==0)">Please provide attachment</div>
                            </td>
                            <td class="text-center">
                                <label for="QUOTAT_EDIT{{$index}}" class="cursor-pointer"
                                       data-toggle="tooltip"
                                       data-html="true"
                                       data-original-title="Add Attachment">
                                    <i class="fas fa-file-upload text-blue"></i>
                                </label>
                                <span class="hidden-input">
                                    <input id="QUOTAT_EDIT{{$index}}"
                                           name="file"
                                           type="file"
                                           ng-model="QL.UploadedFiles"
                                           ng-files="getTheFilesToUpload($files,'QUOTAT_EDIT'+{{$index}},5,QL,35,1,'QUOTATION' ,3,'P2P_Upload_Path','P2P')">
                                </span>
                                <i ng-show="!$first" class="far fa-times-circle cursor-pointer text-danger"
                                   ng-click="REMOVE_FILTE_QUOTATION_EDIT($index,QL)"
                                   data-toggle="tooltip" data-html="true" data-original-title="Remove">
                                </i>
                            </td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="7" ng-click="ADD_MORE_QUOTATION_EDIT()" class="text-center cursor-pointer">
                                <a class="text-blue cursor-pointer text-sm">
                                    <i class="far fa-plus"></i> {{ADD_MORE_QUOTATION_NAME}}
                                </a>
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </div>
            <div class="alert alert-warning-red" ng-show="(EDIT_QUOTATION_LIST.length==1) || (EDIT_QUOTATION_LIST.length>1 && (EDIT_QUOTATION_LIST | filter: emptyFilter).length<2)">
                <strong>Warning!</strong> This is a single quote requisition.
            </div>
        </div>
    </div>
    <div class="row mt-3">
        <div class="col-md-4">
            <div class="form-group AddCustomScroll_SHD" id="AddCustomScroll_SHD">
                <label>Contact <span class="text-danger">*</span></label>
                <label class="d-block text-bold">
                    {{EDIT_REQ_Search.SUPPLIER_NAME}}
                </label>
                <input type="text" name="SUPPLIER_NAME_BOX"
                        ng-show="false"
                       ng-model="EDIT_REQ_Search.SUPPLIER_NAME"
                       ng-change="SetValues(Supplier,$index)"
                       uib-typeahead="Supplier.SUPPLIER_NAME for Supplier in EDIT_SUPPLIER_LIST | filter:$viewValue"
                       typeahead-loading="loading" typeahead-no-results="noResults"
                       class="form-control form-control-sm" autocomplete="off"
                       required
                       placeholder="Type to select Supplier Name..."
                       ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.SUPPLIER_NAME_BOX.$error.required}" />

                <small class="d-block" ng-show="EDIT_REQ_Search.REQUEST_LINE.SUGGESTED_SUPPLIER!=null">
                    <span class="">Suggested: {{EDIT_REQ_Search.REQUEST_LINE.SUGGESTED_SUPPLIER}}</span>
                </small>
            </div>
        </div>
        <div class="col">
            <div class="form-group">
                <label>Date <span class="text-danger">*</span></label>
                <input type="text" class="form-control dateinput"
                       name="DATE"
                       placeholder="Select date"
                       ng-model="EDIT_REQ_Search.PO_DATE"
                       ng-value="EDIT_REQ_Search.PO_DATE | date"
                       ng-change="ChangeEditBudget()"
                       required
                       readonly
                       ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.DATE.$error.required}" />
            </div>
        </div>
        <div class="col">
            <div class="form-group">
                <label>Delivery Date <span class="text-danger">*</span></label>
                <input type="text" class="form-control dateinput"
                       name="DELIVERY_DATE"
                       placeholder="Select delivery date"
                       ng-model="EDIT_REQ_Search.DELIVERY_DATE"
                       ng-value="EDIT_REQ_Search.DELIVERY_DATE | date"
                       required
                       readonly
                       ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.DELIVERY_DATE.$error.required}" />

                <small class="d-block" ng-show="EDIT_REQ_Search.REQUEST_LINE.REQUIRED_DATE!=null">
                    <span class="">Required by: {{EDIT_REQ_Search.REQUEST_LINE.REQUIRED_DATE | date}}</span>
                </small>
            </div>
        </div>
        <div class="col">
            <div class="form-group">
                <label>Reference</label>
                <input type="text" class="form-control"
                       name="REFERENCE"
                       placeholder="Enter reference"
                       ng-model="EDIT_REQ_Search.REFERENCE"
                       ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.REFERENCE.$error.required}" />
            </div>
        </div>
        <div class="col">
            <div class="form-group">
                <label>Project</label>
                <select class="custom-select mw-150"
                        name="PROJECT_MASTER_ID"
                        ng-change="Changeproject('PROJECT')"
                        ng-model="EDIT_REQ_Search.PROJECT_MASTER_ID"
                        ng-options="T.PROJECT_MASTER_ID as T.PROJECT_NAME for T in EDIT_PROJECT_MASTER_LIST">
                    <option value="">-Select Project-</option>

                </select>
            </div>
        </div>
        <div class="col">
            <div class="form-group">
                <label>Themes</label>
                <select class="custom-select mw-150"
                        name="XERO_BRANDING_THEMES_ID"
                        ng-model="EDIT_REQ_Search.XERO_BRANDING_THEME_ID"
                        ng-options="T.XERO_BRANDING_THEME_ID as T.NAME for T in EDIT_XERO_BRANDING_THEMES_LIST"
                        ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.XERO_BRANDING_THEMES_ID.$error.required}">
                    <option value="">-Select Theme-</option>
                </select>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12 my-4">
            <h5 class="card-title mt-4 font-15">Line Items</h5>
            <div class="row">
                <div class="col-auto font-11 mt-2 ml-auto">
                    <span ng-show="EDIT_REQ_Search.BASE_CURRENCY_ID!=EDIT_REQ_Search.PO_CURRENCY_ID"></span>
                </div>
                <div class="col-auto">
                    <label class=""> </label>
                    <div class="form-inline mb-2" ng-show="EDIT_REQ_Search.BASE_CURRENCY_ID!=EDIT_REQ_Search.PO_CURRENCY_ID">
                        <label class="mr-2">1  &nbsp;{{EDIT_REQ_Search.BASE_CURRENCY_NAME }} = </label>
                        <input type="text"
                               class="form-control"
                               name="CURRENCY_CONVER"
                               placeholder="Enter value"
                               maxlength="10"
                               ng-model="EDIT_REQ_Search.BASE_TO_PO_CONVERSION_RATE"
                               ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.CURRENCY_CONVER.$error.required}" />
                    </div>
                </div>
                <div class="col-auto">
                    <div class=" mb-2">
                        <label class="">PO Currency </label>
                        <select class="custom-select mw-150"
                                name="CURRENCY_ID"
                                ng-change="CHANGE_CURRENCY_EDIT()"
                                ng-model="EDIT_REQ_Search.PO_CURRENCY_ID"
                                ng-options="T.CURRENCY_ID as T.DISPLAY_TEXT +'-' + T.CURRENCY_NAME for T in EDIT_CURRENCY_LIST"
                                ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.CURRENCY_ID.$error.required}"></select>
                    </div>
                </div>

                <div class="col-auto">
                    <div class=" mb-2">
                        <label class="">Amounts are </label>
                        <select class="custom-select mw-150"
                                name="TAX_TYPE"
                                ng-model="EDIT_REQ_Search.TAX_TYPE"
                                ng-options="T.ID as T.NAME for T in EDIT_TAX_TYPE"
                                ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.TAX_TYPE.$error.required}"></select>
                    </div>
                </div>

            </div>
            <div class="table-responsive" style="overflow-x:visible">
                <table class="table table-hover table-form table-bordered">
                    <thead class="bg-wenodo-border">
                        <tr>
                            <th width="15%">Item <span class="text-danger">*</span></th>
                            <th width="20%">Description <span class="text-danger">*</span></th>
                            <th>Quantity <span class="text-danger">*</span></th>
                            <th>Unit Price <span class="text-danger">*</span></th>
                            <th>UOM </th>
                            <th width="5%">Disc %</th>
                            <th>GL Account <span class="text-danger">*</span></th>
                            <th>Tax Rate <span class="text-danger">*</span></th>
                            <th class="text-right">Tax</th>
                            <th width="15%" class="text-right">Amount</th>
                            <th>Receiving Method <span class="text-danger"> *</span></th>
                            <th ng-repeat="TrackingCat in EDIT_XERO_TRACKING_CATEGORIES track by $index">{{TrackingCat.FIELD_NAME}}</th>
                            <th width="3%" class="text-center"></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="PRL in EDIT_ITEM_LIST" ng-init="InitiateEditItemList(PRL,1);" on-finish-render="ngRepeatFinishedRender">
                            <td>
                                <span ng-show="false">
                                    {{PRL.LINE_NO=($index+1)}}
                                </span>
                                <div class="AddCustomScroll_itemEditREQ">
                                    <input type="text"
                                           name="ITEM_NAME{{$index}}"
                                           ng-model="PRL.ITEM_NAME"
                                           ng-change="SetEdititemValues('EDIT_REQ');"
                                           uib-typeahead="item.ITEM_NAME  for item in EDIT_P2P_ITEMS_LIST | filter:$viewValue"
                                           typeahead-loading="loading"
                                           typeahead-no-results="noResults"
                                           class="hidden-input"
                                           autocomplete="off"
                                           required
                                           placeholder="Enter item name"
                                           ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.ITEM_NAME{{$index}}.$error.required}" />
                                </div>

                            </td>
                            <td>
                                <textarea class="hidden-input scroll"
                                          name="DESCRIPTION{{$index}}"
                                          required
                                          id="text"
                                          maxlength="2000"
                                          onInput="this.parentNode.dataset.replicatedValue = this.value"
                                          placeholder="Enter description"
                                          ng-model="PRL.DESCRIPTION"
                                          ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.DESCRIPTION{{$index}}.$error.required}"></textarea>
                            </td>
                            <td>
                                <input type="text" class="hidden-input"
                                       name="QUANTITY{{$index}}"
                                       only-digits
                                       placeholder="Enter QTY."
                                       maxlength="13"
                                       required
                                       ng-model="PRL.QUANTITY"
                                       ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.QUANTITY{{$index}}.$error.required}" />
                            </td>
                            <td>
                                <input type="text" class="hidden-input"
                                       only-digits
                                       required
                                       maxlength="13"
                                       placeholder="Enter unit price"
                                       name="UNIT_PRICE{{$index}}"
                                       ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.UNIT_PRICE{{$index}}.$error.required}"
                                       ng-model="PRL.UNIT_PRICE" />
                            </td>
                            <td>
                                <input type="text" class="hidden-input"
                                       name="UOM_NAME{{$index}}"
                                       maxlength="30"
                                       placeholder="Enter UOM"
                                       ng-model="PRL.UOM_NAME"
                                       ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.UOM_NAME{{$index}}.$error.required}" />
                            </td>
                            <td>
                                <input type="text" class="hidden-input"
                                       name="DISCOUNT_PERCENT{{$index}}"
                                       only-digits
                                       maxlength="4"
                                       placeholder="Enter discount"
                                       ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.DISCOUNT_PERCENT{{$index}}.$error.required}"
                                       ng-model="PRL.DISCOUNT_PERCENT" />
                            </td>

                            <td>

                                <div class="AddCustomScroll_Account">
                                    <input type="text" name="ACCOUNT_NAME_BOX{{$index}}"
                                           ng-model="PRL.ACCOUNT_NAME"
                                           ng-change="SetAccountValues(PRL,$index)"
                                           typeahead-on-select="ChangeEditBudget($item, 1, $label)"
                                           uib-typeahead="Acct.CODE + ' - ' + Acct.NAME  for Acct in EDIT_XERO_ACCOUNT_CODES | filter:$viewValue"
                                           typeahead-loading="loading" typeahead-no-results="noResults"
                                           class="hidden-input" autocomplete="off"
                                           required
                                           placeholder="Type to select account name..."
                                           ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.ACCOUNT_NAME_BOX{{$index}}.$error.required || EDIT_REQ_FORM.submitted && PRL.IS_ACCOUNT_VALID}" />
                                </div>
                                <small ng-show="PRL.IS_ACCOUNT_VALID" class="text-red text-bold">Invalid GL Account</small>
                            </td>
                            <td>
                                <select class="hidden-input"
                                        name="TAX_TYPE{{$index}}"
                                        ng-model="PRL.TAX_ID"
                                        ng-options="XT as XT.NAME +' ('+ XT.RATE +')'  for XT in EDIT_XERO_TAXES"
                                        required
                                        ng-change="TAXPERCENTAGE_CHANGE(PRL.TAX_ID,PRL);"
                                        ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.TAX_TYPE{{$index}}.$error.required}">
                                    <option value="">- Select Tax -</option>
                                </select>
                            </td>
                            <td class="text-right text-nowrap pr-2">
                                <span ng-show="false">
                                    {{PRL.TAX_AMOUNT=EDIT_REQ_Search.TAX_TYPE==3?0: (EDIT_REQ_Search.TAX_TYPE==2?((((PRL.UNIT_PRICE*PRL.QUANTITY) / (1 + (PRL.TAX_ID.RATE/100)))-(((PRL.UNIT_PRICE*PRL.QUANTITY) / (1 + (PRL.TAX_ID.RATE/100)))*(PRL.DISCOUNT_PERCENT/100))) * (PRL.TAX_ID.RATE/100)):(((PRL.UNIT_PRICE*PRL.QUANTITY)-((PRL.UNIT_PRICE*PRL.QUANTITY)*(PRL.DISCOUNT_PERCENT/100))) * (PRL.TAX_ID.RATE/100))) | number:2}}
                                </span>
                                {{NAN_Fn(PRL.TAX_AMOUNT)?0.00:PRL.TAX_AMOUNT | number :2}}

                            </td>
                            <td class="text-right text-nowrap pr-2">
                                <span ng-show="false">
                                    {{PRL.AMOUNT= ((PRL.QUANTITY * PRL.UNIT_PRICE) - (PRL.QUANTITY*1 * PRL.UNIT_PRICE*1 * (PRL.DISCOUNT_PERCENT)/100)) | number:2}}
                                    {{PRL.TOTAL_SPLIT_AMOUNT=  SETTING_USE_GROSS==1?(PRL.AMOUNT + (EDIT_REQ_Search.TAX_TYPE==2?0:PRL.TAX_AMOUNT)):EDIT_REQ_Search.TAX_TYPE==2? ((PRL.AMOUNT-PRL.TAX_AMOUNT) ) :PRL.AMOUNT}}
                                </span>

                                {{NAN_Fn(PRL.AMOUNT)?0.00:PRL.AMOUNT | number :2}}
                            </td>
                            <td>
                                <select class="hidden-input"
                                        name="RECEIVING_TYPE_ID{{$index}}"
                                        ng-model="PRL.RECEIVING_TYPE_ID"
                                        ng-options="RT.ID as RT.NAME  for RT in EDIT_RECEIVING_TYPE"
                                        required
                                        ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.RECEIVING_TYPE_ID{{$index}}.$error.required}">
                                    <option value="">-Select -</option>
                                </select>
                            </td>
                            <td ng-repeat="TrackingCat in PRL.EDIT_XERO_TRACKING_CATEGORIES track by $index" ng-init="InitiateEditXeroTrackingCategories(TrackingCat, $index,PRL,1);">
                                <select class="hidden-input"
                                        ng-model="TrackingCat.SELECTED_CATEGORY_OPTION"
                                        ng-options="XT as XT.OPTION_NAME for XT in EDIT_XERO_TRACKING_CATEGORIES_OPTIONS | filter:{APPROVAL_CHAIN_CUSTOM_FIELDS_MASTER_ID:TrackingCat.APPROVAL_CHAIN_CUSTOM_FIELDS_MASTER_ID}">
                                    <option value="">- Please Select -</option>
                                </select>
                            </td>
                            <td class="text-center">
                                <i ng-show="!$first" class="far fa-times-circle cursor-pointer text-danger"
                                   ng-click="REMOVE_LINE_ITEM_EDIT($index,PRL)"
                                   data-toggle="tooltip" data-html="true" data-original-title="Remove">
                                </i>
                            </td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="{{EDIT_XERO_TRACKING_CATEGORIES.length+12}}"
                                ng-click="ADD_MORE_ITEM_EDIT()" class="text-center cursor-pointer">
                                <a class="text-blue cursor-pointer text-sm"><i class="far fa-plus"></i>{{ADD_MORE_ITEM_NAME}}</a>
                            </td>
                        </tr>
                        <tr class="text-bold table-footer-fixed">
                            <td colspan="9" class="text-right font-13">Sub Total</td>
                            <td class="text-right text-nowrap pr-2 font-13">{{EDIT_REQ_Search.NET_AMOUNT=(EDIT_ITEM_LIST | total: 'AMOUNT') | number:2}}</td>
                            <td colspan="{{XERO_TRACKING_CATEGORIES.length+2}}"></td>
                        </tr>
                        <tr class="text-bold table-footer-fixed" ng-repeat="TAX in EDIT_ITEM_LIST | unique:'TAX_ID'" ng-if="TAX.TAX_ID!=null">
                            <td colspan="9" class="text-right font-13">{{TAX.TAX_ID.NAME}} ({{TAX.TAX_ID.RATE +'%'}})</td>
                            <td class="text-right text-nowrap pr-2 font-13">{{ EDIT_ITEM_LIST | filter:{TAX_ID:TAX.TAX_ID} | total:'TAX_AMOUNT' | number:2}}<!--Taxamount=((UnitPrice*Qty)/(1 + Tax%))*tax%--></td>
                            <td colspan="{{EDIT_XERO_TRACKING_CATEGORIES.length+2}}"></td>
                        </tr>
                        <tr class="text-bold table-footer-fixed">
                            <td colspan="9" class="text-right font-13">Total</td>
                            <td class="text-right text-nowrap pr-2 font-14">
                                <span ng-show="false">
                                    {{EDIT_REQ_Search.TAX_AMOUNT= (EDIT_ITEM_LIST | total:'TAX_AMOUNT') | number:2}}
                                </span>
                                <span ng-if="EDIT_REQ_Search.TAX_TYPE==1">
                                    <span ng-show="false">
                                        {{EDIT_REQ_Search.TOTAL_AMOUNT=((EDIT_ITEM_LIST | total: 'AMOUNT') + (EDIT_ITEM_LIST | total: 'TAX_AMOUNT')) | number:2}}
                                    </span>
                                    {{NAN_Fn(EDIT_REQ_Search.TOTAL_AMOUNT)?0.00:EDIT_REQ_Search.TOTAL_AMOUNT | number:2}}
                                </span>
                                <span ng-if="EDIT_REQ_Search.TAX_TYPE==2">
                                    <span ng-show="false">
                                        {{EDIT_REQ_Search.TOTAL_AMOUNT=(EDIT_ITEM_LIST | total: 'AMOUNT')  | number:2}}
                                    </span>
                                    {{NAN_Fn(EDIT_REQ_Search.TOTAL_AMOUNT)?0.00:EDIT_REQ_Search.TOTAL_AMOUNT | number:2}}
                                </span>
                                <span ng-if="EDIT_REQ_Search.TAX_TYPE==3">
                                    <span ng-show="false">
                                        {{EDIT_REQ_Search.TOTAL_AMOUNT=(EDIT_ITEM_LIST | total: 'AMOUNT') | number:2}}
                                    </span>
                                    {{NAN_Fn(EDIT_REQ_Search.TOTAL_AMOUNT)?0.00:EDIT_REQ_Search.TOTAL_AMOUNT | number:2}}
                                </span>
                                {{(EDIT_CURRENCY_LIST | filter :{CURRENCY_ID:EDIT_REQ_Search.PO_CURRENCY_ID})[0].CURRENCY_CODE }}
                            </td>
                            <td colspan="{{EDIT_XERO_TRACKING_CATEGORIES.length+2}}"></td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>

        <div class="col-md-12  my-4">
            <div class="card-header w-100">
                <h5 class="card-title mt-1 font-15"> Advance Amount</h5>
            </div>
            <div class="row mt-3">
                <div class="col-md-3">
                    <input type="text" class="form-control mt-1"
                           name="ADVANCE"
                           placeholder="Enter advance Amount"
                           only-digits
                           ng-model="EDIT_REQ_Search.ADVANCE"
                           ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.ADVANCE.$error.required}" />
                </div>
            </div>
        </div>
        <div class="col-md-12">
            <div class="card-header w-100 cursor-pointer">
                <h5 class="card-title mt-1">
                    Budget
                    <span ng-show="P2P_EDIT_BUDGET_MASTER_LIST.length>0">({{EDIT_REQ_Search.BUDGET_NAME}})</span>
                </h5>
                <button type="button"
                        ng-click="ChangeBudgetEditfy(EDIT_REQ_Search)"
                        data-toggle="tooltip"
                        data-html="true"
                        class="btn btn-transparent-wenodo ml-2 border float-right">
                    Refresh Budget
                </button>
                <button type="button"
                        ng-click="Fn_CANCEL_SPLIT_EDIT(EDIT_REQ_Search,1)"
                        ng-show="EDIT_REQ_Search.SPLIT_TYPE_ID>0"
                        data-toggle="tooltip"
                        data-html="true"
                        class="btn btn-transparent-wenodo ml-2 border float-right">
                    Cancel Split
                </button>
                <button type="button"
                        ng-show="EDIT_REQ_Search.SPLIT_TYPE_ID==null"
                        ng-click="Fn_SPLIT_REQ_EDIT(EDIT_REQ_Search,1)"
                        data-toggle="tooltip"
                        data-html="true"
                        class="btn btn-transparent-wenodo ml-2 border float-right">
                    Split Budget
                </button>
                <span class="float-right mx-2" ng-show="EDIT_REQ_Search.SPLIT_TYPE_ID>0"> Months</span>
                <select class="custom-select float-right ml-2" style="width:150px;"
                        name="SPLIT_NAME"
                        ng-show="EDIT_REQ_Search.SPLIT_TYPE_ID>0"
                        ng-change="Fn_SPLIT_REQ_EDIT(EDIT_REQ_Search,2)"
                        ng-model="EDIT_REQ_Search.SPLIT_TYPE_ID"
                        ng-options="T.ID as T.NAME for T in EDIT_SPLIT_TYPE">
                    <option value="">-Select Month-</option>
                </select>
                <span class="float-right" ng-show="EDIT_REQ_Search.SPLIT_TYPE_ID>0">Split in Next</span>
            </div>
            <div class="table-responsive custom-scrollbar" style="max-height:100%">
                <table class="table table-head-fixed table-hover table-form table-bordered " ng-show="MONTH_EDIT_LIST.length>0">
                    <thead>
                        <tr>
                            <th width="10%">GL Account</th>
                            <th ng-repeat="PRL in EDIT_ITEM_LIST  | unique:'ACCOUNT_ID' | orderBy:['ACCOUNT_ID']"
                                colspan="{{(EDIT_ITEM_LIST |  filter:{ACCOUNT_ID:PRL.ACCOUNT_ID}:true).length}}">
                                {{PRL.ACCOUNT_NAME}}
                            </th>
                        </tr>
                        <tr class="bg-wenodo-border">
                            <th width="10%">Item Name</th>
                            <th data-toggle="tooltip" data-html="true" data-original-title="{{PRL.DESCRIPTION | limitTo:250}}" ng-repeat="PRL in EDIT_ITEM_LIST | orderBy: ['ACCOUNT_ID'] ">
                                {{PRL.ITEM_NAME | limitTo:30}}
                            </th>
                        </tr>
                        <tr class="bg-wenodo-border">
                            <th width="10%">Line Amount</th>
                            <th ng-repeat="PRL in EDIT_ITEM_LIST | orderBy: ['ACCOUNT_ID'] ">
                                {{PRL.TOTAL_SPLIT_AMOUNT | number:2}}
                            </th>
                        </tr>
                    </thead>
                    <tbody ng-repeat="_m in MONTH_EDIT_LIST">
                        <tr>
                            <td width="10%">{{_m.START_DATE | date}} <span ng-show="false"> {{_m.FLAG=($last?1:0)}}</span></td>
                            <td ng-repeat="_prl in _m.ITEM_LIST | orderBy: ['ACCOUNT_ID']" ng-init="_m.FLAG==1?Inittotaleditreq(_prl,_m,$index):''">
                                <span ng-show="false">{{_prl.START_DATE=_m.START_DATE}}</span>
                                <input type="text"
                                       name="BudgetAmt{{$index}}"
                                       ng-model="_prl.BUDGET"
                                       maxlength="9"
                                       Only-digits
                                       ng-change="Inittotaleditreq(_prl,_m ,$index)"
                                       placeholder="Enter Amount"
                                       class="form-control" />
                            </td>
                        </tr>
                        <tr ng-show="$last">
                            <td class="text-bold">
                                Allocated Amount
                            </td>
                            <td class="text-bold" ng-repeat="line in _m.ITEM_LIST | orderBy: ['ACCOUNT_ID']">
                                {{line.TOTAL_BUDGET}}

                            </td>
                        </tr>
                        <tr ng-show="$last">
                            <td class="text-bold">Remaining Amount</td>
                            <td ng-repeat="_prl in _m.ITEM_LIST | orderBy: ['ACCOUNT_ID']"
                                ng-init="Fn_ADJUSTMENT_BUDGET_EDIT(_m,_prl,$index,$last)"
                                class="text-bold" ng-class="{'text-red':(_prl.REMAINING_AMOUNT | number:2)!=0,'':(_prl.REMAINING_AMOUNT | number:2)==0}">
                                {{(_prl.REMAINING_AMOUNT=(EDIT_ITEM_LIST | filter:{LINE_NO:_prl.LINE_NO}:true | total:'TOTAL_SPLIT_AMOUNT') -_prl.TOTAL_BUDGET) | number:2}}
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <span ng-show="false">{{REM_AMOUNT_LEFT_EDIT = (remaningitemeditdetail | sumOfModValue:'REMAINING_AMOUNT') }}</span>
            <div class="alert alert-warning-red" ng-show="REM_AMOUNT_LEFT_EDIT>0 || REM_AMOUNT_LEFT_EDIT<0">
                <strong>Error! </strong> Remaining amount should be zero.
            </div>
            <div class="col-md-12 mt-2" ng-show="P2P_EDIT_BUDGET_MASTER_LIST.length>0 ">
                <span class="po-amount">The following budgets would be affected by the approval of the request.</span>
            </div>
            <div class="col-md-12 text-center mt-2" ng-show="P2P_EDIT_BUDGET_MASTER_LIST.length==0">
                <div class="alert bg-custom-blue">{{BUDGET_TEXT_VALIDATION}}</div>
            </div>
            <div class="card-body p-0 mt-2" ng-show="P2P_EDIT_BUDGET_MASTER_LIST.length>0">
                <div class="table-responsive custom-scrollbar">
                    <table class="table table-head-fixed table-hover">
                        <thead class="bg-wenodo-border">
                            <tr>
                                <th>GL Account </th>
                                <th>Period</th>
                                <th class="text-right">Total</th>
                                <th class="text-right">Remaining</th>
                                <th class="text-right">Consumed</th>
                                <th class="text-right">Booked</th>
                                <th class="text-right">Credit Notes</th>
                                <th class="text-right">Current Amt.</th>
                            </tr>
                        </thead>
                        <tbody ng-repeat="BD in P2P_EDIT_BUDGET_MASTER_LIST">
                            <tr>
                                <td rowspan="3">
                                    <span ng-show="false">{{BD.HEADER_INDEX=$index}}</span>
                                    {{BD.GLACCOUNT_NAME}}
                                </td>
                                <td colspan="7" ng-if="BD.DB_ACCOUNT_ID==0" class="text-align-center text-bold">There is no budget allocated in this GL Account</td>
                            </tr>

                            <tr ng-if="BD.DB_ACCOUNT_ID!=0" ng-repeat="BL in BD.BUDGET_DETAILS_LIST"
                                ng-init="BL.CURRENT_PO_CUSTOM=0;BD.CURRENT_AMOUNT=0;EDIT_REQ_Search.SPLIT_TYPE_ID>0?Fn_RETURN_CURRENT_AMT_EDIT(BD,BL):'';"
                                ng-click="VIEW_BUDGET_fn(BD,EDIT_REQ_Search.PO_DATE,EDIT_REQ_Search.PROJECT_MASTER_ID,EDIT_REQ_Search,EDIT_REQ_Search,'REQ_ACTION',MONTH_EDIT_LIST)">
                                <td>
                                    <span ng-show="false">{{BL.LINE_INDEX=$index}}</span>
                                    {{BL.PERIOD}}
                                </td>
                                <td class="text-right">{{BL.TOTAL | number:2}}</td>
                                <td class="text-right">
                                    <span ng-show="false">
                                        {{BD.IS_OVER_BUDGET=(BL.REMAINING_AMOUNT<0?true:BL.REMAINING_AMOUNT>0?false:BD.IS_OVER_BUDGET?true:false)}}
                                    </span>
                                    <span ng-class="{'text-red text-bold':BL.REMAINING_AMOUNT<0}">
                                        {{(BL.REMAINING_AMOUNT=((BL.TOTAL*1)-((BL.BOOKED*1) +(BL.CURRENT_PO_CUSTOM*1)+(BL.CONSUMED*1)+(BL.MEMO*1)))) | number:2}}
                                    </span>

                                </td>
                                <td class="text-right">{{BL.CONSUMED | number :2}}</td>
                                <td class="text-right">{{BL.BOOKED  | number :2}}</td>
                                <td class="text-right">
                                    <span ng-show="BL.MEMO==0">{{BL.MEMO*-1 | number :2}}</span><span ng-show="BL.MEMO!=0">({{BL.MEMO*-1 | number :2}})</span>
                                </td>
                                <td class="text-right">

                                    <span ng-show="false">
                                        {{BL.ITEM_TAX_AMOUNT=(EDIT_ITEM_LIST | filter:{ACCOUNT_ID:BD.ACCOUNT_ID}:true | total:'TAX_AMOUNT')}}
                                        {{BL.ITEM_AMOUNT= (EDIT_ITEM_LIST | filter:{ACCOUNT_ID:BD.ACCOUNT_ID}:true | total:'AMOUNT') }}
                                        {{BL.TAX_AMT_TOTAL= ((NAN_Fn(BL.ITEM_TAX_AMOUNT)?0:BL.ITEM_TAX_AMOUNT) + BL.ITEM_AMOUNT*1)}}
                                    </span>
                                    <span> {{(EDIT_REQ_Search.SPLIT_TYPE_ID>0? BL.CURRENT_PO_CUSTOM=((ACCOUNT_ITEMDETAIL_EDIT | filter:{ACCOUNT_ID:BD.ACCOUNT_ID}) | total : 'BUDGET')/EDIT_REQ_Search.BASE_TO_PO_CONVERSION_RATE:(SETTING_USE_GROSS==1?(BL.CURRENT_PO_CUSTOM=EDIT_REQ_Search.TAX_TYPE==1 ?(BL.TAX_AMT_TOTAL/EDIT_REQ_Search.BASE_TO_PO_CONVERSION_RATE):(BL.ITEM_AMOUNT/EDIT_REQ_Search.BASE_TO_PO_CONVERSION_RATE)):BL.CURRENT_PO_CUSTOM=(BL.ITEM_AMOUNT-(EDIT_REQ_Search.TAX_TYPE==1?0:BL.ITEM_TAX_AMOUNT))/EDIT_REQ_Search.BASE_TO_PO_CONVERSION_RATE)) | number:2}}</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="alert alert-warning-red" ng-show="(P2P_EDIT_BUDGET_MASTER_LIST | filter:{IS_OVER_BUDGET:true}).length">
                <strong>Warning!</strong> This requisition is going over budget.
            </div>
        </div>
        


        <div class="col-md-12 my-4">
            <div class="card-header w-100">
                <h5 class="card-title mt-1 font-15">Delivery Details</h5>
                <button class="btn btn-transparent-wenodo ml-4 border float-right" ng-click="POP_EDIT_DELIVERY_DETAILS_Fn('EDIT_REQ')"
                        data-toggle="tooltip"
                        data-html="true">
                    Add New Delivery Address&nbsp;&nbsp;<i class="far fa-plus"></i>
                </button>
                <button type="button"
                        class="btn btn-transparent-wenodo border float-right"
                        data-original-title="Select Delivery Address"
                        data-toggle="dropdown">
                    Select Delivery Address
                    &nbsp;&nbsp;<i class="far fa-chevron-down"></i>
                </button>
                <ul class="dropdown-menu dropdown-menu-right dropdown-menu-arrow text-sm custom-scrollbar " style="width:300px;"
                    aria-haspopup="true" aria-expanded="false">
                    <li class="stick-top bg-white" style="top:0">
                        <input type="text"
                               class="form-control"
                               placeholder="Search Delivery Address"
                               ng-model="EDIT_REQ_Search.searchDA" />
                    </li>

                    <li class="text-center" ng-show="EDIT_P2P_DELIVERY_ADDRESS_LIST.length==0" ng-click="POP_EDIT_DELIVERY_DETAILS_Fn('EDIT_REQ')" data-toggle="tooltip"
                        data-html="true"
                        data-original-title="Add Delivery Details">
                        No record found
                        <i class="fa fa-plus"></i>
                    </li>
                    <li class="dropdown-item text-limit-1"
                        ng-repeat="DA in EDIT_P2P_DELIVERY_ADDRESS_LIST  | filter:{DELIVERY_ADDRESS:EDIT_REQ_Search.searchDA}"
                        ng-click="CLICK_DELIVERY_ADDRESS_EDIT(DA)">
                        {{DA.DELIVERY_ADDRESS}}
                    </li>
                </ul>
            </div>
            <div class="row">
                <div class="col-md-4">
                    <div class="form-group">
                        <label>Address <span class="text-danger">*</span></label>
                        <textarea class="form-control" rows="5"
                                  name="DELIVERY_ADDRESS"
                                  placeholder="Enter delivery address"
                                  ng-model="EDIT_REQ_Search.DELIVERY_ADDRESS"
                                  maxlength="500"
                                  required
                                  ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.DELIVERY_ADDRESS.$error.required}"></textarea>
                        <span class="d-block text-grey text-xs semibold mb-2">{{500 - EDIT_REQ_Search.DELIVERY_ADDRES.length}} Character Remaining </span>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="col-md-12">
                        <div class="form-group">
                            <label>Attention To</label>
                            <input type="text" class="form-control"
                                   name="ATTENTION"
                                   maxlength="150"
                                   placeholder="Enter attention To"
                                   ng-model="EDIT_REQ_Search.ATTENTION"
                                   ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.ATTENTION.$error.required}" />
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="form-group">
                            <label>Phone <span class="text-danger">*</span></label>
                            <input type="text" class="form-control"
                                   name="PHONE"
                                   placeholder="Enter phone"
                                   autocomplete="off"
                                   ng-model="EDIT_REQ_Search.PHONE"
                                   only-phone
                                   maxlength="15"
                                   required
                                   ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.PHONE.$error.required}" />
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group">
                        <label>Delivery Instructions</label>
                        <textarea class="form-control" rows="5"
                                  name="DELIVERY_INSTRUCTIONS"
                                  maxlength="500"
                                  placeholder="Enter delivery instructions"
                                  ng-model="EDIT_REQ_Search.DELIVERY_INSTRUCTIONS"
                                  ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.DELIVERY_INSTRUCTIONS.$error.required}"></textarea>
                        <span class="d-block text-grey text-xs semibold mb-2">{{500 - EDIT_REQ_Search.DELIVERY_INSTRUCTIONS.length}} Character Remaining </span>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-12">
            <h5 class="card-title w-100">Note for Approvers</h5>
            <textarea class="form-control" rows="4"
                      name="NOTE_FOR_APPROVERS"
                      placeholder="Enter note for approvers"
                      maxlength="2000"
                      ng-model="EDIT_REQ_Search.NOTE_FOR_APPROVERS"
                      ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.NOTE_FOR_APPROVERS.$error.required}"></textarea>
            <span class="d-block text-grey text-xs semibold mb-2">{{2000 - EDIT_REQ_Search.NOTE_FOR_APPROVERS.length}} Character Remaining </span>
        </div>
        <div class="col-md-6  mt-3">
            <span class="bigcheck">
                <label class="bigcheck float-left" for="EDIT_REQ_MATCHTYPE">
                    <input type="checkbox"
                           class="bigcheck"
                           id="EDIT_REQ_MATCHTYPE"
                           name="AUTO_EMAIL_TO_SUPPLIER"
                           ng-model="EDIT_REQ_Search.AUTO_EMAIL_TO_SUPPLIER"
                           ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.AUTO_EMAIL_TO_SUPPLIER.$error.required}" />
                    <span class="bigcheck-target"></span>
                    <span class="font-14" style="margin-top:2px;">Automatically email approved Purchase Order to Supplier</span>
                </label>
            </span>
        </div>
        <div class="col-md-6">
            <div class="form-group">
                <label>Contact Email</label>
                <input type="text"
                       class="form-control"
                       name="SUPPLIER_EMAIL_EDIT"
                       ng-required="EDIT_REQ_Search.AUTO_EMAIL_TO_SUPPLIER"
                       ng-pattern="/^(\s?[^\s,]+@[^\s,]+\.[^\s,]+\s?,)*(\s?[^\s,]+@[^\s,]+\.[^\s,]+)$/"
                       placeholder="Enter contact email"
                       ng-model="EDIT_REQ_Search.SUPPLIER_EMAIL"
                       maxlength="500"
                       ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_REQ_FORM.SUPPLIER_EMAIL_EDIT.$error.required}" />
                <span class="text-red" ng-show="EDIT_REQ_FORM.SUPPLIER_EMAIL_EDIT.$error.pattern">Not valid email!</span>
            </div>
        </div>
        <div class="col-md-12 my-4">
            <div class="card-header">
                <h5 class="card-title">Terms & Conditions</h5>
                <button class="btn btn-transparent-wenodo border ml-4 float-right" ng-click="POP_ADD_EDIT_TERMS_CONDITIONS_Fn(EDIT_REQ_Search)"
                        data-toggle="tooltip"
                        data-html="true">
                    Add Terms and Conditions &nbsp;&nbsp;<i class="far fa-plus"></i>
                </button>
                <button type="button"
                        class="btn btn-transparent-wenodo border float-right"
                        data-toggle="dropdown" ng-click="POP_EDIT_TERMS_CONDITIONS_Fn(EDIT_REQ_Search)">
                    Select Terms and Conditions
                </button>
            </div>

            <div class="table-responsive" style="overflow-x:visible">
                <table class="table table-head-fixed table-hover table-form table-bordered">
                    <thead class="bg-wenodo-border">
                        <tr>
                            <th>Terms & Conditions</th>
                            <th width="5%" class="text-center">Order</th>
                            <th width="3%" class="text-center">Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="PRL in EDIT_TERMS_AND_CONDITIONS_MASTER_LIST | orderBy:'SORT_ORDER'">
                            <td>
                                <textarea class="hidden-input scroll"
                                          name="TEXT{{$index}}"
                                          id="text"
                                          maxlength="2000"
                                          onInput="this.parentNode.dataset.replicatedValue = this.value"
                                          placeholder="Enter "
                                          ng-model="PRL.TEXT"></textarea>
                                <span class="d-block text-grey text-xs semibold mb-2">{{1000 - PRL.TEXT.length}} Character Remaining </span>
                            </td>
                            <td class="text-center">
                                <button type="button" class="btn btn-transparent-wenodo mr-2 float-left"
                                        ng-click="ADD_ABOVE_EDIT(PRL,$index)"
                                        ng-show="!$first"
                                        data-toggle="tooltip"
                                        data-html="true"
                                        data-original-title="Add Above">
                                    <i class="far fa-angle-double-up"></i>
                                </button>
                                <button type="button" class="btn btn-transparent-wenodo float-right"
                                        data-toggle="tooltip"
                                        ng-show="EDIT_TERMS_AND_CONDITIONS_MASTER_LIST.length>1 && !$last"
                                        ng-click="ADD_BELOW_EDIT(PRL,$index)"
                                        data-html="true"
                                        data-original-title="Add Below">
                                    <i class="far fa-angle-double-down"></i>
                                </button>

                            </td>
                            <td class="text-center">
                                <i ng-show="!$first" class="far fa-times-circle cursor-pointer text-danger"
                                   ng-click="REMOVE_FILTE_TERM_CON_EDIT($index,PRL)"
                                   data-toggle="tooltip" data-html="true" data-original-title="Remove">
                                </i>
                            </td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="3" ng-click="ADD_MORE_TERM_CON_EDIT()" class="text-center cursor-pointer">
                                <a class="text-blue cursor-pointer text-sm">
                                    <i class="far fa-plus"></i>
                                    {{ADD_MORE_TERMS_CONDITIONS_NAME}}
                                </a>
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
        <div class="col-md-6 mt-3">
            <div class="upload-files-container">
                <div class="drag-file-area mx-100 w-100">
                    <label class="label m-auto">
                        <span class="browse-files">
                            <input type="file" class="default-file-input w-100" id="PO1"
                                   ng-model="EDIT_REQ_Search.UploadedFiles"
                                   ng-files="getTheFilesToUpload($files,'PO1',5,EDIT_REQ_Search,32,'1','PO',10,'P2P_Upload_Path','P2P')" />
                            <span class="browse-files-text p-3"><i class="far fa-upload"></i> Add an Attachment</span>
                        </span>
                    </label>
                </div>
            </div>
        </div>
        <div class="col-md-6 mt-3">
            <label class="cursor-pointer text-blue" ng-show="EDIT_REQ_Search.REQUEST_LINE.UploadedFiles.length>0" ng-click="ADD_REQUESTOR_ATTACHMENT_FY(EDIT_REQ_Search)"> Add Requestor Attachment</label>
            <div class="file-block" ng-repeat="file in EDIT_REQ_Search.UploadedFiles">
                <div class="file-info">
                    <i class="far fa-file-alt file-icon"></i>
                    <a href="/P2PFiles/{{file.FILE_PATH}}{{file.SERVER_FILE_NAME}}" download="{{file.ORIGINAL_FILE_NAME}}"> <span class="text-limit-1">{{file.ORIGINAL_FILE_NAME}} </span></a>
                </div>
                <span class="remove-file-icon" ng-click="REMOVE_FILTE_EDIT($index,file)"><i class="fa fa-times"></i></span>
            </div>
        </div>
    </div>
</form>
<div class="modal fade show" id="EDIT_DELIVERY_DETAILS">
    <form name="EDIT_DELIVERY_DETAILS_FORM" novalidate>
        <div class="modal-dialog modal-sm">
            <div class="modal-content" style=" height:auto">
                <div class="modal-header">
                    <h4 class="modal-title">Delivery Details</h4>
                    <button type="button" class="close" ng-click="CLOSE_DELIVERY()" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body" style="max-height:300px">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Delivery Address  <span class="text-danger">*</span></label>
                                <textarea class="form-control" rows="3"
                                          name="DELIVERY_ADDRESS_POP"
                                          ng-model="DELIVERY_ADDRESS_SEARCH.DELIVERY_ADDRESS"
                                          placeholder="Enter item dilivery address"
                                          required
                                          maxlength="500"
                                          ng-class="{'error':EDIT_DELIVERY_DETAILS_FORM.submitted && EDIT_DELIVERY_DETAILS_FORM.DELIVERY_ADDRESS_POP.$error.required}" />
                                <span class="d-block text-grey text-xs semibold mb-2">{{500 - DELIVERY_ADDRESS_SEARCH.DELIVERY_ADDRESS.length}} Character Remaining </span>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Attention To </label>
                                <input type="text"
                                       name="ATTENTION"
                                       class="form-control"
                                       maxlength="200"
                                       ng-model="DELIVERY_ADDRESS_SEARCH.ATTENTION"
                                       placeholder="Enter attention to"
                                       ng-class="{'error':EDIT_DELIVERY_DETAILS_FORM.submitted && EDIT_DELIVERY_DETAILS_FORM.ATTENTION.$error.required}" />
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Phone </label>
                                <input type="text"
                                       name="PHONE_EDIT_TO"
                                       class="form-control"
                                       only-phone
                                       maxlength="100"
                                       autocomplete="off"
                                       ng-model="DELIVERY_ADDRESS_SEARCH.PHONE"
                                       placeholder="Enter phone"
                                       ng-class="{'error':EDIT_DELIVERY_DETAILS_FORM.submitted && EDIT_DELIVERY_DETAILS_FORM.PHONE_EDIT_TO.$error.required}" />
                            </div>
                        </div>

                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-wenodo" ng-click="EDIT_INS_UPD_P2P_DELIVERY_ADDRESS()">Submit</button>
                    <button type="button" class="btn btn-w-default" ng-click="CLOSE_DELIVERY()">Close</button>
                </div>
            </div>
        </div>
    </form>
</div>
<div class="modal fade show" id="EDIT_POP_SUPPLIER">
    <form name="SUPPLIER_FORM" novalidate>
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Add Contact</h4>
                    <button type="button" class="close" ng-click="CLOSE_ADD_CONTACT()" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Add New Contact  <span class="text-danger">*</span> </label>
                                <input type="text"
                                       name="SUPPLIER_NAME"
                                       class="form-control"
                                       maxlength="200"
                                       ng-model="SUPPLIER_SEARCH.SUPPLIER_NAME"
                                       required
                                       placeholder="Enter Contact"
                                       ng-class="{'error':SUPPLIER_FORM.submitted && SUPPLIER_FORM.SUPPLIER_NAME.$error.required}" />
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="upload-files-container">
                                <div class="drag-file-area">
                                    <input type="file" class="default-file-input w-100"
                                           id="upl_EDITSUPPLIER_SEARCH1"
                                           ng-model="SUPPLIER_SEARCH.UploadedFiles"
                                           ng-files="getTheFilesToUpload($files,'upl_EDITSUPPLIER_SEARCH1',5,SUPPLIER_SEARCH,36,1,'NEW_SUPPLIER' ,3,'P2P_Upload_Path','P2P')" />
                                    <label class="browse-files-text btn btn-wenodo m-auto" for="upl_EDITSUPPLIER_SEARCH1"><i class="far fa-upload"></i> Upload</label>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="file-block" ng-repeat="file in SUPPLIER_SEARCH.UploadedFiles">
                                <div class="file-info">
                                    <i class="far fa-file-alt file-icon"></i>
                                    <a href="/P2PFiles/{{file.FILE_PATH}}{{file.SERVER_FILE_NAME}}" download="/P2PFiles/{{file.FILE_PATH}}{{file.SERVER_FILE_NAME}}"> <span class="text-limit-1 font-12">{{file.ORIGINAL_FILE_NAME}} </span></a>
                                </div>
                                <span class="remove-file-icon" ng-click="REMOVE_SUPPLIER_FILTE($index)"><i class="fa fa-times"></i></span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-wenodo" ng-click="EDIT_P2P_NEW_SUPPLIER_REQUEST()">Submit</button>
                    <button type="button" class="btn btn-w-default" ng-click="CLOSE_ADD_CONTACT()">Close</button>
                </div>
            </div>
        </div>
    </form>
</div>
<div class="modal fade show" id="EDIT_AddTANDC">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Select Terms & Conditions</h4>
                <button type="button" class="close" ng-click="CLOSE_TERMS_CON()" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <div class="form-group">
                            <input type="text"
                                   class="form-control"
                                   placeholder="Search Terms & Conditions"
                                   ng-model="EDIT_REQ_Search.searchTM" />
                        </div>
                    </div>
                </div>
                <div class="table-responsive custom-scrollbar" style="max-height:45vh">
                    <table class="table table-head-fixed table-hover table-bordered">
                        <thead class="bg-wenodo-border">
                            <tr>
                                <th>Action</th>
                                <th>Terms & Conditions</th>
                            </tr>
                            <tr ng-repeat="TM in EDIT_P2P_TERMS_AND_CONDITIONS_LIST  | filter:{TEXT:EDIT_REQ_Search.searchTM}" ng-click="CLICK_TERMS_CONDITIONS_EDIT(TM)">
                                <td><i class="far fa-lg" ng-class="{'fa-check-square green':TM.IS_CHECK_TMC,'fa-square':!TM.IS_CHECK_TMC}"></i></td>
                                <td>{{TM.TEXT}}</td>
                            </tr>
                        <tfoot ng-show="EDIT_P2P_TERMS_AND_CONDITIONS_LIST.length">
                            <tr>
                                <td colspan="2" ng-click="POP_EDIT_TERMS_CONDITIONS_Fn()">
                                    No record found
                                    <i class="fa fa-plus"></i>
                                </td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-wenodo" ng-click="CLICK_TERMS_CONDITIONS_APPLY_EDIT()">Add</button>
                <button type="button" class="btn-w-default" ng-click="CLICK_TERMS_CONDITIONS_RESET_EDIT()">Reset</button>
                <button type="button" class="btn btn-w-default" ng-click="CLOSE_TERMS_CON()">Close</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade show" id="EDIT_TERMS_CONDITIONS">
    <form name="TERMS_AND_CONDITIONS_FORM" novalidate>
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Terms & Conditions</h4>
                    <button type="button" class="close" ng-click="CLOSE_EDIT_TERMS_CONDITIONS()" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body">
                            <div class="form-group">
                                <label>
                                    Add New Terms & Conditions
                                    <span class="text-danger">*</span>
                                </label>
                                <textarea class="form-control"
                                          name="TEXT"
                                          id="text"
                                          maxlength="1000"
                                          rows="5"
                                          required
                                          onInput="this.parentNode.dataset.replicatedValue = this.value"
                                          placeholder="Enter Terms & Conditions"
                                          ng-model="TERAM_CONDITION.TEXT"
                                          ng-class="{'error':TERMS_AND_CONDITIONS_FORM.submitted && TERMS_AND_CONDITIONS_FORM.TEXT.$error.required}">
                                   </textarea>
                                <span class="d-block text-grey text-xs semibold mb-2">{{1000 - TERAM_CONDITION.TEXT.length}} Character Remaining </span>
                            </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-wenodo" ng-click="EDIT_INS_UPD_TERMS_AND_CONDITIONS_MASTER(0,SELECT_REQ)">Submit</button>
                    <button type="button" class="btn btn-w-default" ng-click="CLOSE_EDIT_TERMS_CONDITIONS()">Close</button>
                </div>
            </div>
        </div>
    </form>
</div>
<div class="modal fade show" id="RESET_CHAIN_COMENT_POP">
    <form name="RESET_CHAIN_COMENT_FORM" novalidate>
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Comments</h4>
                    <button type="button" class="close" ng-click="CLOSE_RESET_CHAIN()" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>
                                    You have changed the GL Account  or the total amount of requisition. This will reset the approval chain.
                                    <br />
                                    <br />
                                    Are you sure want to proceed?
                                    <span class="text-danger">*</span>
                                </label>
                                <textarea class="form-control"
                                          name="RESET_APPROVAL_CHAIN_COMMENTS"
                                          id="text"
                                          maxlength="1000"
                                          rows="5"
                                          required
                                          onInput="this.parentNode.dataset.replicatedValue = this.value"
                                          placeholder="Type Comments"
                                          ng-model="RESET_APPROVAL_CHAIN_COMMENTS"
                                          ng-class="{'error':RESET_CHAIN_COMENT_FORM.submitted && RESET_CHAIN_COMENT_FORM.RESET_APPROVAL_CHAIN_COMMENTS.$error.required}">
                                   </textarea>
                                <span class="d-block text-grey text-xs semibold mb-2">{{1000 - RESET_APPROVAL_CHAIN_COMMENTS.length}} Character Remaining </span>
                            </div>
                        </div>


                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" click-once class="btn btn-wenodo" ng-click="EDIT_INS_UPD_REQUISITION_RESET_CHAIN()">Submit</button>
                    <button type="button" click-once class="btn btn-w-default" ng-click="CLOSE_RESET_CHAIN()">Close</button>
                </div>
            </div>
        </div>
    </form>
</div>
<div class="modal fade show" id="EDIT_CONVERSION_COMMENTS_POP">
    <form name="EDIT_CONVERSION_COMMENTS_FORM" novalidate>
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Comment</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body">

                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>The currency conversion rate has changed. Are you sure you want to proceed with submit for approval?<span class="text-danger">*</span></label>
                                <textarea class="form-control"
                                          name="CONVERSION_COMMENTS"
                                          id="text"
                                          maxlength="500"
                                          rows="5"
                                          required
                                          onInput="this.parentNode.dataset.replicatedValue = this.value"
                                          placeholder="Enter .."
                                          ng-model="EDIT_REQ_Search.CONVERSION_COMMENTS"
                                          ng-class="{'error':EDIT_REQ_FORM.submitted && EDIT_CONVERSION_COMMENTS_FORM.$error.required}">
                                   </textarea>
                                <span class="d-block text-grey text-xs semibold mb-2">{{500 - EDIT_REQ_Search.CONVERSION_COMMENTS.length}} Character Remaining </span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-wenodo" ng-click="EDIT_INS_UPD_REQUISITION(2,1)">Save</button>
                    <button type="button" class="btn btn-w-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </form>
</div>