<div class="row">
    <div class="col-xxl-2 col-xl-2 col-md-2">

    </div>
    <div class="col-xxl-10 col-xl-10 col-md-10">
        <div class="card mx-2">
            <div class="card-header">
                <h3>Users</h3>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-xxl-12 col-xl-12 col-md-12">
                        <h5 class="headings mb-0">User Management </h5>
                    </div>
                </div>

                <div class="row mt-4 g-1">
                    <div class="col-xxl-2 col-xl-2 col-md-2">
                        <form id="SearchForm" name="SearchForm" novalidate>
                            <input type="text"
                                   name="search"
                                   autocomplete="off"
                                   aria-autocomplete="none"
                                   ng-model="user_Search.SEARCH"
                                   ng-enter="GET_USER_ROLES_BY_CUSTOMER_ID()"
                                   placeholder="Search " />
                            <button type="submit" ng-show="false" class="btn btn-wenodo"
                                    click-once
                                    ng-click="GET_USER_ROLES_BY_CUSTOMER_ID(1,user_Search.SEARCH)"></button>
                        </form>
                    </div>
                    
                    <div class="col-xxl-auto col-xl-auto col-md-auto ms-auto">
                        <!--<button class="btn btn-light" type="button"><i class="fa-light fa-plus me-2"></i> Add User</button>-->
                        <a href="#!/Add_Cashup_User" class="btn btn-light" type="button"><i class="fa-light fa-plus me-2"></i> Add User</a>
                    </div>

                    <div class="col-xxl-auto col-xl-auto col-md-auto">
                        <button class="btn btn-primary" type="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="fa-light fa-arrow-down-to-bracket me-2"></i>Export</button>
                        <ul class="dropdown-menu dropdown-block dropdown-menu-end">
                            <li><a class="dropdown-item d-block" ng-click="EXPORT_USERS_LIST(2)">XLS</a></li>
                            <li><a class="dropdown-item" ng-click="EXPORT_USERS_LIST(2)">CSV</a></li>
                        </ul>
                    </div>
                </div>

                <div class="table-responsive scrollbar-wrapper UserManagementTable mt-2 user_access accCreManTable">
                    <table>
                        <thead class="table-sticky-top">
                            <tr>
                                <th class="min-w-100">User</th>
                                <th class="min-w-100">Role</th>
                                <th class=" min-w-100">Date </th>
                                <th class="min-w-100">Email</th>
                                <th class="min-w-100">Contact </th>
                                <th class="text-nowrap min-w-100">Last Login</th>
                                <th class="text-center">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="user in USERS_LIST">
                                <td class="text-nowrap">
                                    <div class="text-nowrap">
                                        <label class="form-check-label">
                                            <span class="text_avatar me-1">{{ user.USER_NAME | limitTo:2 }}</span>
                                            {{ user.USER_NAME }}
                                        </label>
                                    </div>
                                </td>
                                <td class="text-nowrap">
                                    <span ng-if="user.ROLES.length == 1">{{user.ROLES[0].STANDARD_ROLE_NAME}}</span>
                                    <div class="dropdown hovering" ng-if="user.ROLES.length > 1">
                                        <span class="c-pointer txt-primary" data-bs-toggle="dropdown" aria-expanded="false">View Roles</span>
                                        <ul class="dropdown-menu">
                                            <li class="dropdown-item" ng-repeat="role in user.ROLES">
                                                <a class="text-dark d-block">{{ role.BRANCH_NAME }} : {{ role.STANDARD_ROLE_NAME }}</a>
                                            </li>
                                        </ul>
                                    </div>
                                    <div ng-if="user.ROLES.length === 0">
                                        No Roles Assigned
                                    </div>
                                </td>
                                <td class="text-nowrap">{{ user.CREATED_DATE | date:'d MMMM y' }}</td>
                                <td class="text-nowrap">{{ user.EMAIL }}</td>
                                <td class="text-nowrap">{{ user.PHONE_NUMBER }}</td>
                                <td class="text-nowrap">{{ (user.LAST_LOGIN | date:'d MMMM y')||'-' }}</td>
                                <td class="text-center">
                                    <div class="dropstart">
                                        <button class="btn" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                            <i class="fa-light fa-ellipsis"></i>
                                        </button>
                                        <ul class="dropdown-menu">
                                            <!--<li class="dropdown-item">
                                                <a class="text-dark d-block"><i class="fa-light fa-paper-plane me-2"></i> Send Invite</a>
                                            </li>-->
                                            <li class="dropdown-item">
                                                <a class="text-dark d-block" ng-click="EDIT_USER_Fn(user)"><i class="fa-light fa-pen me-2"></i> Edit</a>
                                            </li>
                                            <li class="dropdown-item" data-bs-toggle="modal" data-bs-target="#Delete_user">
                                                <a class="text-dark d-block" ng-click="POP_DELETE_USER_Fn(user)"><i class="fa-light fa-trash-can me-2"></i> Delete</a>
                                            </li>
                                        </ul>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

            </div>
        </div>
    </div>
</div>


<!-- DELETE MODAL STARTS-->


<div class="modal fade" id="Delete_user" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenter1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header border-0">
                <button class="btn-close" type="button" data-bs-dismiss="modal" aria-label="Close" data-bs-original-title="" title=""></button>
            </div>
            <div class="modal-body">
                <div class="modal-toggle-wrapper">
                    <ul class="modal-img">
                        <li> <img src="E_Content/images/HR/exclaimation_circle.svg" class="pb-2" alt="error"></li>
                    </ul>
                    <h6 class="text-center pb-2 fw-500">Delete XYZ ?</h6>
                    <p class="text-center text-dark"> This will remove all {{SELECTED_USER.USER_NAME}} data. Are you sure you still want to delete {{SELECTED_USER.USER_NAME}} ?</p>
                </div>
            </div>
            <div class="modal-footer border-0">
                <div class="row w-100">
                    <div class="col-xxl-6 col-md-6 col-md-6"><button class="btn btn-outline w-100" type="button" data-bs-dismiss="modal">Close</button></div>
                    <div class="col-xxl-6 col-md-6 col-md-6" ng-click=" DELETE_USER_Fn(SELECTED_USER)"><button class="btn btn-danger w-100" type="button" data-bs-dismiss="modal">Delete</button></div>
                </div>
            </div>
        </div>
    </div>
</div>



<!-- DELETE MODAL ENDS -->



<script>
    // -----------------------------------------------------
    document.querySelectorAll('.hovering').forEach(dropdown => {
        dropdown.addEventListener('mouseenter', () => {
            dropdown.querySelector('.dropdown-menu').classList.add('show');
        });
        dropdown.addEventListener('mouseleave', () => {
            dropdown.querySelector('.dropdown-menu').classList.remove('show');
        });
    });

</script>