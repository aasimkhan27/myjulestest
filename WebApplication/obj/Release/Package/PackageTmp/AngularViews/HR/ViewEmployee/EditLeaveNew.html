<div class="row">
    <div class="col-md-12">
        <templateurl class="w-100" template-url="../AngularViews/HR/ViewEmployee/HeaderDtlsNew.html?v=1{{AppVersion}}">
    </div>
    <div class="col-auto mn-w-250">
        <templateurl class="w-100" template-url="../AngularViews/HR/ViewEmployee/Employee_Tabs.html?v={{AppVersion}}">
    </div>
    <div class="col">
        <form id="EmpDtlsForm_6" name="EmpDtlsForm_6" novalidate class="w-100">
            <div class="card-body">
                <h5 class="heading-text-2">Leave Entitlement</h5>
                <div class="float-right">
                    <div class="d-flex float-right">
                        <a ng-click="AddObjLeaveLine()" ng-show="ABSENCE_TYPE.length>0" class="btn btn-sm btn-wenodo mr-2"> Add </a>
                        <!--<select class="custom-select mr-2"
                                name="ABSENCE_TYPE{{$index}}"
                                ng-model="SELECT_START_YEAR"
                                ng-options="PT as PT.START_YEAR  for PT in (SELECTED_YEAR_DDL)"
                                ng-click="ON_ABSENCE_START_YEAR_EDIT_CHANGE()"
                                required
                                ng-class="{'error':EmpDtlsForm_6.submitted && EmpDtlsForm_6.ABSENCE_TYPE{{$index}}.$error.required}">
                            <option value="">- Select Year</option>
                        </select>-->

                        <ul class="nav nav-pills">
                            <li class="dropdown ">
                                <a class="form-control text-limitations custom-dropdown cursor-pointer mw-150" data-toggle="dropdown">
                                    <span id="dropdown_titleSec"> {{SELECT_START_YEAR.START_YEAR}} </span>
                                    <i class="fa fa-sort float-right mt-1"></i>
                                </a>
                                <ul ID="divNewNotificationsSec" class="dropdown-menu dropdown-menu-right dropdown-menu-arrow text-xs custom-scrollbar">
                                    <li class="" ng-repeat="AB in SELECTED_YEAR_DDL" ng-click="ON_ABSENCE_START_YEAR_EDIT_CHANGE(AB,$index);">
                                        {{AB.START_YEAR}}
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <div class="text-center error p-3 semibold" ng-show="ABSENCE_TYPE.length==0"> Not  Enough Entitlement </div>
                <div class="row" ng-repeat="LL in SELECT_START_YEAR.LeaveList" ng-init="NG_INIT_LEAVE(LL)" ng-if="LL.DELETE_FLAG==0" on-finish-render="ngRepeatFinished">
                    <div class="col-md-3">
                        <div class="form-group">
                            <label class="d-block">Absence type:*</label>
                            <select class="custom-select"
                                    name="ABSENCE_TYPE{{$index}}"
                                    ng-model="LL.HOLIDAY_ENTITLEMENT_ID"
                                    ng-options="PT.HOLIDAY_ENTITLEMENT_ID as PT.DISPLAY_TEXT  for PT in (ABSENCE_TYPE)"
                                    ng-change="ON_ABSENCETYPECHANGE(LL,$index)"
                                    required
                                    ng-class="{'error':EmpDtlsForm_6.submitted && EmpDtlsForm_6.ABSENCE_TYPE{{$index}}.$error.required}">
                                <option value="">- Select Absence Type</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group">
                            <label class="d-block">Entitlement:*</label>
                            <input type="text"
                                   class="form-control"
                                   placeholder="Enter ..."
                                   name="ALLOCATION{{$index}}"
                                   ng-change="ON_VALUE_CHANGE(LL)"
                                   maxlength="9"
                                   required
                                   only-digits
                                   ng-class="{'error':EmpDtlsForm_6.submitted && EmpDtlsForm_6.ALLOCATION{{$index}}.$error.required}"
                                   ng-model="LL.ALLOCATION_DAYS_CAL">
                        </div>
                    </div>
                    <div class="col-md-1">
                        <div class="form-group">
                            <label class="d-block">Units:</label>
                            <span class="d-block">
                                {{LL.UNIT_NAME}}
                            </span>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="form-group">
                            <label class="d-block">Year Start:</label>
                            <!--<span class="d-block">
                                {{LL.YEAR_START_DATE | date}}
                            </span>-->
                            <input type="text"
                                   class="form-control Leavedateinput"
                                   name="YEAR_START_DATE_RANGE{{$index}}"
                                   autocomplete="off"
                                   required
                                   readonly
                                   ng-change="ON_VALUE_CHANGE(LL,$index)"
                                   ng-class="{'error':EmpDtlsForm_6.submitted && EmpDtlsForm_6.YEAR_START_DATE_RANGE{{$index}}.$error.required}"
                                   ng-model="LL.YEAR_START_DATE"
                                   ng-value="LL.YEAR_START_DATE | date">
                        </div>
                    </div>
                    <div class="col-md-2" ng-init="DateLeaveInputLoad(LL,$index,1)">
                        <div class="form-group">
                            <label class="d-block">Year End:*</label>
                            <!--<span class="d-block">
                                {{LL.YEAR_END_DATE | date}}
                            </span>-->
                            <input type="text"
                                   class="form-control Leavedateinput"
                                   name="ALLOCYEAR_END_DATEATION{{$index}}"
                                   autocomplete="off"
                                   required
                                   readonly
                                   ng-change="ON_VALUE_CHANGE(LL,$index)"
                                   ng-class="{'error':EmpDtlsForm_6.submitted && EmpDtlsForm_6.ALLOCYEAR_END_DATEATION{{$index}}.$error.required}"
                                   ng-model="LL.YEAR_END_DATE"
                                   ng-value="LL.YEAR_END_DATE | date">
                        </div>
                    </div>
                    <div class="col" ng-init="DateLeaveInputLoad(LL,$index,2)">
                        <div class="form-group">
                            <label class="d-block">&nbsp;</label>
                            <a class="btn btn-sm btn-danger" ng-click="RemoveLeaveLine(LL,$index,$last)" data-toggle="tooltip" data-html="true" data-original-title="Delete"><i class="far fa-trash"></i></a>

                            <!--<a ng-click="AddObjLeaveLine(LL)" ng-show="SELECT_START_YEAR.LeaveList.length-1==$index" class="btn btn-wenodo" data-toggle="tooltip" data-html="true" data-original-title="Add"> <i class="far fa-plus"></i></a>-->
                            <button type="button" ng-click="RESET_LEAVE(LL)" ng-show="LL.RESET_FLAG==1" class="btn btn-w-default" data-toggle="tooltip" data-html="true" data-original-title="Undo"><i class="far fa-undo"></i></button>
                            <!--{{$index}}-{{(SELECT_START_YEAR.LeaveList | filter:{DELETE_FLAG:'0'}).length}}-->
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div data-ng-show="EmpDtlsForm_6.submitted && EmpDtlsForm_6.$invalid" class="form-group has-error errormessage badge badge-light-red w-100 p-3">
                    <span class="help-block errormessageline"><i class="fa fa-exclamation-triangle"></i> - Please provide the mandatory details to submit(marked in red).</span>
                </div>
                <div id="divInvlidUser" class="hideshowdiv" data-ng-show="EmpDtlsForm_6.$valid">
                    <span class="help-block">{{InvalidUser}}</span>
                </div>
            </div>

            <div class="card-body pt-0" ng-show="ABSENCE_TYPE.length>0">
                <div class="form-group">
                    <button ng-disabled="LeaveListDelete.length==0 && (SELECT_START_YEAR.LeaveList==null || SELECT_START_YEAR.LeaveList=='' || SELECT_START_YEAR.LeaveList.length==0)" ng-click="POP_EMPLOYEE_STEP_FLAG()" class="btn btn-sm btn-wenodo">Save</button>
                    <button type="button" ng-click="VIEW_TAB_CLICK(6)" class="btn btn-sm btn-w-default">Cancel</button>
                </div>
            </div>
        </form>
    </div>
</div>

<div class="modal fade" id="EFFECTIVE_DATA">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Updates </h4>
                <button type="button" class="close"  data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body custom-scrollbar height-400" ng-init="dateinputOpenDate('bottom')">
                <form id="EFFECTIVEForm" name="EFFECTIVEForm" novalidate>
                    <div class="col-md-12">
                        <div class="form-group">
                            <label>Effective Date:*</label>
                            <input type="text"
                                   class="form-control dateinputOpenDate"
                                   autocomplete="off"
                                   name="EFFECTIVE_DATE"
                                   readonly
                                   placeholder="Select ..."
                                   ng-model="EFFECTIVE_SEARCH.EFFECTIVE_DATE"
                                   ng-value="EFFECTIVE_SEARCH.EFFECTIVE_DATE | date"
                                   required
                                   ng-class="{'error':EFFECTIVEForm.submitted && EFFECTIVEForm.EFFECTIVE_DATE.$error.required}" />
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="form-group">
                            <label>Comments:</label>
                            <textarea rows="8"
                                      class="form-control "
                                      name="COMMENTS"
                                      ng-model="EFFECTIVE_SEARCH.COMMENTS"
                                      placeholder="Enter ..."
                                      ng-class="{'error':EFFECTIVEForm.submitted && EFFECTIVEForm.COMMENTS.$error.required}" />
                        </div>
                    </div>

                </form>
            </div>
            <div class="modal-footer justify-content-left">
                <button type="button" click-once  ng-click="POP_EMPLOYEE_STEP_FLAG('VIEW',6);" class="btn btn-wenodo">Save</button>
                <button type="button"  class="btn btn-w-default" data-dismiss="modal">Cancel</button>
            </div>
        </div>
    </div>
</div>
